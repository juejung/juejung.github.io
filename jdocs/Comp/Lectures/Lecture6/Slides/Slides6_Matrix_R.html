<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<title>Scientific programming</title>

<base target="_blank"/>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: #F9F6F4;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
   background-color: #C9A798;
}

h2 { 
   font-size:1.8em; 
   background-color: #BCC632; 
}

h3 { 
   font-size:1.4em; 
   background-color: #D4DBB2;
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
}

pre code {
   display: block; padding: 0.5em;
}

code.r {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}
</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


</head>

<body>
<h1>Scientific programming</h1>

<hr/>

<h1>1 Vector manipulation</h1>

<p>A vector of order \( n>0\) is a set of ordered numbers. <br/>
\[ a = \left[ \begin{array}{c} 4 \\ 3 \end{array} \right], \: 
e_{1} = \left[ \begin{array}{c} 1 \\ 0 \\ 0 \end{array} \right], \: ... \]</p>

<p>These are column vectors. Row vectors are transposed column vectors, that is<br/>
\[ a'=[4 \: 3], \: e'_{1}=[1 \: 0 \: 0], \: ...\]</p>

<h2>1.1 Transposing vectors</h2>

<p>In <strong>R</strong> vectors are formed as column vectors by default. We can simply transpose vectors using the transpose function <code>t()</code> as follows:</p>

<pre><code class="r">a = c(4, 3)  # column vector
aprime = t(a)  # row vector
a
</code></pre>

<pre><code>## [1] 4 3
</code></pre>

<pre><code class="r">aprime
</code></pre>

<pre><code>##      [,1] [,2]
## [1,]    4    3
</code></pre>

<h2>1.2 Length of vectors</h2>

<p>A vector (at least a two dimensional one) has a convenient geometric representation. It is an arrow, where the two coordinates indicate the direction and length of this arrow. Vector </p>

<p>\[ a = \left[ \begin{array}{c} 4 \\ 3 \end{array} \right]\] </p>

<p>points to the upper right (i.e. 4 over, 3 up). The length of a vector can be calculated using the Pythagoras theorem for the triangle. The length of vector </p>

<p>\[ a = \left[ \begin{array}{c} a_1 \\ a_2 \end{array} \right]\] </p>

<p>where \( a_1\) and \( a_2\) are simply numbers, can be calculated as </p>

<p>\[ \|a\| = \sqrt{a_1^2 + a_2^2}.\]<br/>
For our example, the vector norm for <br/>
\[ a = \left[ \begin{array}{c} 4 \\ 3 \end{array} \right] \text{ is } \rightarrow \|a\| = \sqrt{4^2 + 3^2} = 5.\]<br/>
In <strong>R</strong> we can simply define a vector and calculate its norm (or length) as</p>

<pre><code class="r">a = c(4, 3)
sqrt(sum(a^2))
</code></pre>

<pre><code>## [1] 5
</code></pre>

<h2>1.3 Adding two vectors</h2>

<p>Adding vectors is simple. We just add all numbers of two vectors &#39;element-by-element&#39;. So that</p>

<p>\[ a + b = \left[ \begin{array}{c} a_1  + b_1 \\ a_2+b_2 \end{array} \right].\] </p>

<p>In <strong>R</strong> this is done with</p>

<pre><code class="r">a = c(4, 3)
b = c(12, 5)
a + b  # adding up vectors element-by-element
</code></pre>

<pre><code>## [1] 16  8
</code></pre>

<h2>1.4 Multiplication of vectors</h2>

<p>A vector can be multiplied by a number (we call it a scalar denoted as \( \lambda\) to distinguish it from vectors and the numbers that it contains). The scalar is multiplied with all numbers of the vector. If we multiply the vector with \( \lambda > 1\) then the arrow that the vector symbolizes is becoming longer. If we multiply the vector with \( 0 < \lambda < 1\) the arrow gets shorter. If we multiply the vector with a negative number \( \lambda < 0\) then the arrow changes direction. More formally this is </p>

<p>\[ \lambda * a =  \left[ \begin{array}{c} \lambda *a_1 \\ \lambda *a_2 \end{array} \right].\]</p>

<p>In <strong>R</strong> it&#39;s simply</p>

<pre><code class="r">a = c(4, 3)
b = 5 * a
sqrt(sum(b^2))  # norm of longer vector
</code></pre>

<pre><code>## [1] 25
</code></pre>

<pre><code class="r">c = 0.5 * a
sqrt(sum(c^2))  # norm of shorter vector
</code></pre>

<pre><code>## [1] 2.5
</code></pre>

<pre><code class="r">d = -3 * a  # vector changes direction
sqrt(sum(d^2))
</code></pre>

<pre><code>## [1] 15
</code></pre>

<p>When multiplying two vectors we form a so called &#39;inner product&#39; as follows:</p>

<p>\[ a*b = \sum_{i=1}^{n}a_i*b_i.\] </p>

<p>The following example shows this with numbers: </p>

<p>\[ a = \left[ \begin{array}{c} 4 \\ 3 \end{array} \right] \text{ and }  b = \left[ \begin{array}{c} 12 \\ 5 \end{array} \right]\] </p>

<p>then </p>

<p>\[ ax*b = 4*12 + 3*5.\] </p>

<p>In <strong>R</strong> the inner product is simply:</p>

<pre><code class="r">a = c(4, 3)
b = c(12, 5)
sum(a * b)  # inner product
</code></pre>

<pre><code>## [1] 63
</code></pre>

<hr/>

<h1>2 Matrix manipulation</h1>

<p>Matrices are &ldquo;two dimensional&rdquo; vectors. In <strong>R</strong> we define a matrix as</p>

<pre><code class="r">A = cbind(c(2, 3), c(4, 5))
B = cbind(c(2, 6), c(1, 3))
</code></pre>

<h2>2.1 Transposing matrices</h2>

<p>Transposing matrices requires again the <code>t()</code> command. It writes each column as row of a new matrix. So that the transpose of matrix \( A\) in the above example becomes:</p>

<pre><code class="r">A = cbind(c(2, 3), c(4, 5))
Atrans = t(A)
A
</code></pre>

<pre><code>##      [,1] [,2]
## [1,]    2    4
## [2,]    3    5
</code></pre>

<pre><code class="r">Atrans
</code></pre>

<pre><code>##      [,1] [,2]
## [1,]    2    3
## [2,]    4    5
</code></pre>

<p>If we transpose the transpose of matrix A, we get the original matrix A back.</p>

<h2>2.2 Adding matrices</h2>

<p>When adding two matrices \( A\) and \( B\) we simply add all the elements of each matrix &#39;element-by-element&#39;. Note that the dimensions (i.e. the number of rows and columns) of the two matrices have to be identical. So if matrix \( A\) has dimension \( m \times n\), that is \( m\) rows and \( n\) columns, then matrix \( B\) needs to be of dimensions \( m \times n\) as well.</p>

<pre><code class="r">A = cbind(c(2, 3), c(4, 5))
B = cbind(c(2, 6), c(1, 3))
C = A + B
A
</code></pre>

<pre><code>##      [,1] [,2]
## [1,]    2    4
## [2,]    3    5
</code></pre>

<pre><code class="r">B
</code></pre>

<pre><code>##      [,1] [,2]
## [1,]    2    1
## [2,]    6    3
</code></pre>

<pre><code class="r">C
</code></pre>

<pre><code>##      [,1] [,2]
## [1,]    4    5
## [2,]    9    8
</code></pre>

<h2>2.3 Multiplying matrices</h2>

<p>When multiplying two matrices \( A\) and \( B\) we need to make sure that the number of columns of matrix \( A\) is equal the number of rows of matrix \( B\). So if \( A\) has dimension \( m \times n\) then \( B\) needs to have dimension \( n \times r\) since matrix multiplication implies that we form the &#39;inner product&#39; of each row of \( A\) with each column of \( B\). This results in a new matrix of dimension \( m \times r\).<br/>
Here is an example. Given matrices <br/>
\[  A = \left[ \begin{array}{ccc} 12 & 3 &6 \\ 9 &-1 & -4 \end{array} \right] \text{ and }
    B = \left[ \begin{array}{cc} 7 & 8  \\ -2 &0 \\ 1 & 11 \end{array} \right]\] </p>

<p>the product of \( A\) \( (2 \times 3)\) and \( B\) of dimension \( (3 \times 2)\) is a matrix \( C\) with dimension \( (2 \times 2)\):</p>

<p>\[  AB = \left[ \begin{array}{cc} 12*7+3*(-2)+6*1 & 12*8+3*0+6*11 \\ 
                                  9*7+(-1)*(-2)+(-4)*1 & 9*8+(-1)*0+(-4)*11 \end{array} \right]. \]</p>

<p>In <strong>R</strong> matrix multiplication is achieved using the command <code>%*%</code>.                                   </p>

<pre><code class="r">A = cbind(c(12, 3), c(3, -1), c(6, -4))
B = cbind(c(7, -2, 1), c(8, 0, 11))
C = A %*% B  # matrix multiplication

A
</code></pre>

<pre><code>##      [,1] [,2] [,3]
## [1,]   12    3    6
## [2,]    3   -1   -4
</code></pre>

<pre><code class="r">B
</code></pre>

<pre><code>##      [,1] [,2]
## [1,]    7    8
## [2,]   -2    0
## [3,]    1   11
</code></pre>

<pre><code class="r">C
</code></pre>

<pre><code>##      [,1] [,2]
## [1,]   84  162
## [2,]   19  -20
</code></pre>

<h2>2.4 Multiplying a matrix with a vector</h2>

<p>Vectors are simply \( n \times 1\) or \( 1 \times n\) dimensional matrices so that the same rules as above apply for multiplying a matrix with a vector.</p>

<pre><code class="r">A = cbind(c(12, 3), c(3, -1), c(6, -4))
b = c(7, -2, 1)
C = A %*% b  # matrix multiplied by vector: (m x n) x (n x 1) = (m x 1)
A
</code></pre>

<pre><code>##      [,1] [,2] [,3]
## [1,]   12    3    6
## [2,]    3   -1   -4
</code></pre>

<pre><code class="r">b
</code></pre>

<pre><code>## [1]  7 -2  1
</code></pre>

<pre><code class="r">C
</code></pre>

<pre><code>##      [,1]
## [1,]   84
## [2,]   19
</code></pre>

<h2>2.5 Indexing and accessing elements of a matrix</h2>

<pre><code class="r">A = rbind(c(11, 12, 13, 14), c(21, 22, 23, 24), c(31, 32, 33, 34))
A
</code></pre>

<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]   11   12   13   14
## [2,]   21   22   23   24
## [3,]   31   32   33   34
</code></pre>

<pre><code class="r">A[2, 3]  # Element row 2, column 3
</code></pre>

<pre><code>## [1] 23
</code></pre>

<pre><code class="r">A[1, ]  # First row
</code></pre>

<pre><code>## [1] 11 12 13 14
</code></pre>

<pre><code class="r">A[, 1]  # First column
</code></pre>

<pre><code>## [1] 11 21 31
</code></pre>

<pre><code class="r">A[-1, ]  # All, except first row
</code></pre>

<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]   21   22   23   24
## [2,]   31   32   33   34
</code></pre>

<pre><code class="r">A[-2, -3]  # All, except row 2 and column 3
</code></pre>

<pre><code>##      [,1] [,2] [,3]
## [1,]   11   12   14
## [2,]   31   32   34
</code></pre>

<pre><code class="r">A[, -2]  # Remove column 2
</code></pre>

<pre><code>##      [,1] [,2] [,3]
## [1,]   11   13   14
## [2,]   21   23   24
## [3,]   31   33   34
</code></pre>

<pre><code class="r">A[, 1] = 99  # Fill first column with 99
A
</code></pre>

<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]   99   12   13   14
## [2,]   99   22   23   24
## [3,]   99   32   33   34
</code></pre>

<pre><code class="r">A[A &gt; 90] = 90  # Replace all elements &gt; 99 with number 90
A
</code></pre>

<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]   90   12   13   14
## [2,]   90   22   23   24
## [3,]   90   32   33   34
</code></pre>

</body>

</html>
