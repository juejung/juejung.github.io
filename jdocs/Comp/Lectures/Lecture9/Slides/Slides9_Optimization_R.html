<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<title>Optimization</title>

<base target="_blank"/>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: #F9F6F4;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
   background-color: #C9A798;
}

h2 { 
   font-size:1.8em; 
   background-color: #BCC632; 
}

h3 { 
   font-size:1.4em; 
   background-color: #D4DBB2;
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
}

pre code {
   display: block; padding: 0.5em;
}

code.r {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}
</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


</head>

<body>
<h1>Optimization</h1>

<h1>1 Univariate function optimization</h1>

<h2>1.1 Example function to be maximized</h2>

<pre><code class="r">require(graphics)
rm(list = ls())  # Remove almost everything in the memory
</code></pre>

<p>Here we want to optimize a univariate function: f1</p>

<pre><code class="r">f1simple = function(x) {
    # gamma(2,3) density
    if (x &lt; 0) 
        return(c(0))
    if (x == 0) 
        return(c(NaN))
    y = exp(-2 * x)
    return(4 * x^2 * y)
}
</code></pre>

<p>Next we define the same function but return f(x), f&#39;(x), and f&#39;&#39;(x) </p>

<pre><code class="r">f1 = function(x) {
    # gamma(2,3) density
    if (x &lt; 0) 
        return(c(0, 0, 0))
    if (x == 0) 
        return(c(0, 0, NaN))
    y = exp(-2 * x)
    return(c(4 * x^2 * y, 8 * x * (1 - x) * y, 8 * (1 - 2 * x^2) * y))
}
</code></pre>

<p>Some algorithms that we&#39;ll encounter later will minimize a function. So if we want to maximize our function we have to define it as a negate function, that is: \( g(x) = -f(x)\) then \( min(g(x))\) is the same as \( max(f(x))\).</p>

<pre><code class="r">f1simpleNeg = function(x) {
    # gamma(2,3) density
    if (x &lt; 0) 
        return(c(0))
    if (x == 0) 
        return(c(NaN))
    y = exp(-2 * x)
    return(-(4 * x^2 * y))
}
</code></pre>

<p>Plotting the function is always a good idea!</p>

<pre><code class="r">xmin = 0
xmax = 6
x = seq(xmin, xmax, (xmax - xmin)/200)
fx = c()  # define column vector
for (i in 1:length(x)) {
    fx[i] = f1(x[i])[1]
}
plot(x, fx, type = &quot;l&quot;, xlab = &quot;x&quot;, ylab = &quot;f(x)&quot;, main = &quot;zero f(x) = 0&quot;, 
    col = &quot;blue&quot;, lwd = 2)
lines(c(xmin, xmax), c(0, 0), col = &quot;blue&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAh1BMVEX9/v0AAAAAADkAAGUAAP8AOTkAOY8AZo8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j9plAABlADllAGVlOQBlOY9lZjllZmVlZrVltf2POQCPOTmPOWWPZgCPtY+P29qP2/21ZgC1ZmW1/rW1/v3ajzna24/a/tra/v39tWX924/9/rX9/tr9/v2B5QO4AAAALXRSTlP//////////////////////////////////////////////////////////wCl7wv9AAAACXBIWXMAAAsSAAALEgHS3X78AAAM7klEQVR4nO3dDXcitxmG4eCQrenWNflq7WwbkyzN8vX/f1+ZGbCxGUAaaaRXeu77nJw9axss60IzA1ms73Yk2Xe5B0B5Al404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA75pPZvcveyW+/9eP/DY82Xb58nkPuGwxgz4psXkabfbzE9QF99/7fuySTXy9cOvGq3JfgEv9388Ncv27td2fXcf3XULefLp23L/2fXs+6/7vz7tb9V9btneurndrv3kZt73iCgwEfi91uLwADgwd39tl2/3kb+emyP9fu2vmo9u5p++NZ87hW8/sXg7HxRd/fC7Rq9Zy3vJ7XO7oO+b1bsH3MwPis2hvqPezH+YNWu6+cqPd9MeBRbdg6D4FODXs/vjEX9/jN+2K7tdve0jomlxfGS0X9d8rPuqjyse+JLqFq8r/PJw5l/0wXOoL6lO9+B6XMvnh/ruC9azv7WfP67407i4K6r9c/T2Kq67mvv07UB6cnF3co5vPvl6NXB2VzydK6nlUXjRur87ex9fpWlP3Iv2OV77hY+vV/Xv4gWcKludXratJn0v3VUU8K/dfuWupoB/6+Zr9TUFvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAixYCPyHLjQgfcFsaO+BFA1404EUDXjTgRQNeNOBFA1404EUDXrRi4KfTadT7U68Q+GlXxHtUrwj4Dh36mJUA/wqOfLwKgD/VRj5W9uHfWyMfqRLgP/wV+RgVB498nMzDnzMDH6MC4ZGPkXX4PmQO9hEy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" alt="plot of chunk R5"/> </p>

<h2>1.2 Optimization methods</h2>

<h3>1.2.1 Newton&#39;s method</h3>

<pre><code class="r">newton = function(f3, x0, tol = 1e-09, n.max = 100) {
    # Newton&#39;s method for optimisation, starting at x0 f3 is a function that
    # given x returns the vector (f(x), f&#39;(x), f&#39;&#39;(x)), for some f

    x = x0
    f3.x = f3(x)
    n = 0
    while ((abs(f3.x[2]) &gt; tol) &amp; (n &lt; n.max)) {
        x = x - f3.x[2]/f3.x[3]
        f3.x = f3(x)
        n = n + 1
    }
    if (n == n.max) {
        cat(&quot;newton failed to converge\n&quot;)
    } else {
        return(x)
    }
}
</code></pre>

<h3>1.2.2 Golden section method</h3>

<pre><code class="r">gsection = function(ftn, x.l, x.r, x.m, tol = 1e-09) {
    # applies the golden-section algorithm to maximise ftn we assume that ftn
    # is a function of a single variable and that x.l &lt; x.m &lt; x.r and
    # ftn(x.l), ftn(x.r) &lt;= ftn(x.m)
    # 
    # the algorithm iteratively refines x.l, x.r, and x.m and terminates when
    # x.r - x.l &lt;= tol, then returns x.m

    # golden ratio plus one
    gr1 = 1 + (1 + sqrt(5))/2

    # successively refine x.l, x.r, and x.m
    f.l = ftn(x.l)
    f.r = ftn(x.r)
    f.m = ftn(x.m)
    while ((x.r - x.l) &gt; tol) {
        if ((x.r - x.m) &gt; (x.m - x.l)) {
            y = x.m + (x.r - x.m)/gr1
            f.y = ftn(y)
            if (f.y &gt;= f.m) {
                x.l = x.m
                f.l = f.m
                x.m = y
                f.m = f.y
            } else {
                x.r = y
                f.r = f.y
            }
        } else {
            y = x.m - (x.m - x.l)/gr1
            f.y = ftn(y)
            if (f.y &gt;= f.m) {
                x.r = x.m
                f.r = f.m
                x.m = y
                f.m = f.y
            } else {
                x.l = y
                f.l = f.y
            }
        }
    }
    return(x.m)
}
</code></pre>

<h3>1.2.3 Built in &#39;optimize&#39; function</h3>

<p>There is a built in <code>optimize</code> function in R.</p>

<h2>1.3 Maximize function: f1</h2>

<h3>1.3.1 Maximizing using the Newton method</h3>

<pre><code class="r">newton(f1, 0.25)
</code></pre>

<pre><code>## [1] 1.979e-12
</code></pre>

<pre><code class="r">newton(f1, 0.5)
</code></pre>

<pre><code>## [1] 0
</code></pre>

<pre><code class="r">newton(f1, 0.75)
</code></pre>

<pre><code>## [1] 1
</code></pre>

<pre><code class="r">newton(f1, 1.75)
</code></pre>

<pre><code>## [1] 1
</code></pre>

<h3>1.3.2 Maximizing using the Secant method</h3>

<pre><code class="r">gsection(f1simple, 0.1, 0.25, 1.3)
</code></pre>

<pre><code>## [1] 1
</code></pre>

<pre><code class="r">gsection(f1simple, 0.25, 0.5, 1.7)
</code></pre>

<pre><code>## [1] 1
</code></pre>

<pre><code class="r">gsection(f1simple, 0.6, 0.75, 1.8)
</code></pre>

<pre><code>## [1] 1
</code></pre>

<pre><code class="r">gsection(f1simple, 0, 2.75, 5)
</code></pre>

<pre><code>## [1] 1
</code></pre>

<h3>1.3.3 Maximizing using the built in optimize function</h3>

<pre><code class="r">optimize(f1simple, c(0.1, 1.3), maximum = TRUE)
</code></pre>

<pre><code>## $maximum
## [1] 1
## 
## $objective
## [1] 0.5413
## 
</code></pre>

<pre><code class="r">optimize(f1simple, c(0.25, 1.7), maximum = TRUE)
</code></pre>

<pre><code>## $maximum
## [1] 1
## 
## $objective
## [1] 0.5413
## 
</code></pre>

<pre><code class="r">optimize(f1simple, c(0.6, 1.8), maximum = TRUE)
</code></pre>

<pre><code>## $maximum
## [1] 1
## 
## $objective
## [1] 0.5413
## 
</code></pre>

<pre><code class="r">optimize(f1simple, c(0, 5), maximum = TRUE)
</code></pre>

<pre><code>## $maximum
## [1] 1
## 
## $objective
## [1] 0.5413
## 
</code></pre>

<h1>2 Multivariate optimization</h1>

<h2>2.1 Define multivariate (i.e. bivariate) example functions</h2>

<p>Here we want to optimize the following functions: f3, f4</p>

<h3>2.1.1 Function f3</h3>

<pre><code class="r">f3simple = function(x) {
    a = x[1]^2/2 - x[2]^2/4
    b = 2 * x[1] - exp(x[2])
    f = sin(a) * cos(b)
    return(f)
}
</code></pre>

<p>Its negative version: </p>

<pre><code class="r">f3simpleNeg = function(x) {
    a = x[1]^2/2 - x[2]^2/4
    b = 2 * x[1] - exp(x[2])
    f = -(sin(a) * cos(b))
    return(f)
}
</code></pre>

<p>And the version that returns f(x), f&#39;(x) (i.e. the gradient), and f&#39;&#39;(x) (i.e. the Hessian):</p>

<pre><code class="r">f3 = function(x) {
    a = x[1]^2/2 - x[2]^2/4
    b = 2 * x[1] - exp(x[2])
    f = sin(a) * cos(b)
    f1 = cos(a) * cos(b) * x[1] - sin(a) * sin(b) * 2
    f2 = -cos(a) * cos(b) * x[2]/2 + sin(a) * sin(b) * exp(x[2])
    f11 = -sin(a) * cos(b) * (4 + x[1]^2) + cos(a) * cos(b) - cos(a) * sin(b) * 
        4 * x[1]
    f12 = sin(a) * cos(b) * (x[1] * x[2]/2 + 2 * exp(x[2])) + cos(a) * sin(b) * 
        (x[1] * exp(x[2]) + x[2])
    f22 = -sin(a) * cos(b) * (x[2]^2/4 + exp(2 * x[2])) - cos(a) * cos(b)/2 - 
        cos(a) * sin(b) * x[2] * exp(x[2]) + sin(a) * sin(b) * exp(x[2])
    return(list(f, c(f1, f2), matrix(c(f11, f12, f12, f22), 2, 2)))
}  # Function f3 returns: f(x), f&#39;(x), and f&#39;&#39;(x)
</code></pre>

<p>Plot function f3:</p>

<pre><code class="r">library(&quot;lattice&quot;)
x = c()
y = c()
z = c()
i = 1  ## Make data for wireframe command
for (x0 in seq(1, 10, 1)) {
    for (y0 in seq(1, 10, 1)) {
        x[i] = x0
        y[i] = y0
        z[i] = f3simple(c(x[i], y[i]))
        i = i + 1  # data counter
    }
}
wireData = data.frame(x = x, y = y, z = z)
wireframe(z ~ x * y, main = &quot;3D Wireframe Plot: f3&quot;, xlab = &quot;x&quot;, 
    ylab = &quot;y&quot;, data = wireData)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk R14"/> </p>

<h3>2.1.2 Function f4</h3>

<p>This is the same function, but in its output for f&#39;(x) and f&#39;&#39;(x) we use the built in <code>deriv()</code> function so that we don&#39;t have to derive the function by hand.</p>

<pre><code class="r">f4simple = function(x) {
    ## Rosenbrock Banana function
    a = x[1]^2/2 - x[2]^2/4
    b = 2 * x[1] - exp(x[2])
    f = sin(a) * cos(b)
    return(f)
}

f4simpleNeg = function(x) {
    ## Rosenbrock Banana function
    a = x[1]^2/2 - x[2]^2/4
    b = 2 * x[1] - exp(x[2])
    f = -sin(a) * cos(b)
    return(f)
}

Dfx = deriv(z ~ sin(x^2/2 - y^2/4) * cos(2 * x - exp(y)), c(&quot;x&quot;, 
    &quot;y&quot;), func = TRUE, hessian = TRUE)
f4 = function(x) {
    Dfx = Df(x[1], x[2])
    f = Dfx[1]
    gradf = attr(Dfx, &quot;gradient&quot;)[1, ]
    hessf = attr(Dfx, &quot;hessian&quot;)[1, , ]
    return(list(f, gradf, hessf))
}
</code></pre>

<p>Plot function f4:</p>

<pre><code class="r">x = c()
y = c()
z = c()
i = 1  ## Make data for wireframe command
for (x0 in seq(0, 3, 0.1)) {
    for (y0 in seq(0, 3, 0.1)) {
        x[i] = x0
        y[i] = y0
        z[i] = f4simple(c(x[i], y[i]))
        i = i + 1  # data counter
    }
}
wireData = data.frame(x = x, y = y, z = z)
wireframe(z ~ x * y, main = &quot;3D Wireframe Plot: f4&quot;, xlab = &quot;x&quot;, 
    ylab = &quot;y&quot;, data = wireData)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk R16"/> </p>

<h2>2.2 Multivariate optimization methods</h2>

<h3>2.2.1 Newton</h3>

<pre><code class="r">newtonMult = function(f3, x0, tol = 1e-09, n.max = 100) {
    # Newton&#39;s method for optimisation, starting at x0 f3 is a function that
    # given x returns the list {f(x), grad f(x), Hessian f(x)}, for some f

    x = x0
    f3.x = f3(x)
    n = 0
    while ((max(abs(f3.x[[2]])) &gt; tol) &amp; (n &lt; n.max)) {
        x = x - solve(f3.x[[3]], f3.x[[2]])
        f3.x = f3(x)
        n = n + 1
    }
    if (n == n.max) {
        cat(&quot;newton failed to converge\n&quot;)
    } else {
        return(x)
    }
}
</code></pre>

<h3>2.2.2 Built in optim() function</h3>

<h2>2.3 Maximize multivariate function</h2>

<p>We use various starting values to see whether we can find more than one optimum.</p>

<pre><code class="r">for (x0 in seq(1.4, 1.6, 0.1)) {
    for (y0 in seq(0.4, 0.6, 0.1)) {
        cat(&quot;Newton: f3&quot;, c(x0, y0), &quot;--&gt;&quot;, newtonMult(f3, c(x0, y0)), &quot;\n&quot;)  # This algorithm requires f(x), f&#39;(x), and f&#39;&#39;(x)
        cat(&quot;Optim:  f3&quot;, c(x0, y0), &quot;--&gt;&quot;, optim(c(x0, y0), f3simpleNeg)[[1]], 
            &quot;\n&quot;)
        cat(&quot; ----------------------------------------- \n&quot;)
    }
}
</code></pre>

<pre><code>## Newton: f3 1.4 0.4 --&gt; 0.04074 -2.507 
## Optim:  f3 1.4 0.4 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 1.4 0.5 --&gt; 0.118 3.345 
## Optim:  f3 1.4 0.5 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 1.4 0.6 --&gt; -1.553 6.02 
## Optim:  f3 1.4 0.6 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 1.5 0.4 --&gt; 2.837 5.354 
## Optim:  f3 1.5 0.4 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 1.5 0.5 --&gt; 0.04074 -2.507 
## Optim:  f3 1.5 0.5 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 1.5 0.6 --&gt; 9.899e-10 1.366e-09 
## Optim:  f3 1.5 0.6 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 1.6 0.4 --&gt; -0.5584 -0.7897 
## Optim:  f3 1.6 0.4 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 1.6 0.5 --&gt; -0.2902 -0.2305 
## Optim:  f3 1.6 0.5 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 1.6 0.6 --&gt; -1.553 -3.333 
## Optim:  f3 1.6 0.6 --&gt; 2.031 1.402 
##  ----------------------------------------- 
</code></pre>

<pre><code class="r">for (x0 in seq(0, 0.5, 0.1)) {
    for (y0 in seq(0, 0.5, 0.1)) {
        cat(&quot;Newton: f3&quot;, c(x0, y0), &quot;--&gt;&quot;, newtonMult(f3, c(x0, y0)), &quot;\n&quot;)  # This algorithm requires f(x), f&#39;(x), and f&#39;&#39;(x)
        cat(&quot;Optim:  f4&quot;, c(x0, y0), &quot;--&gt;&quot;, optim(c(x0, y0), f4simpleNeg)[[1]], 
            &quot;\n&quot;)
        cat(&quot; ----------------------------------------- \n&quot;)
    }
}
</code></pre>

<pre><code>## Newton: f3 0 0 --&gt; 0 0 
## Optim:  f4 0 0 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0 0.1 --&gt; 2.479e-11 2.658e-11 
## Optim:  f4 0 0.1 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0 0.2 --&gt; -0.5584 -0.7897 
## Optim:  f4 0 0.2 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0 0.3 --&gt; -0.1592 0.2251 
## Optim:  f4 0 0.3 --&gt; 0.3425 1.427 
##  ----------------------------------------- 
## Newton: f3 0 0.4 --&gt; -0.1592 0.2251 
## Optim:  f4 0 0.4 --&gt; 0.3425 1.427 
##  ----------------------------------------- 
## Newton: f3 0 0.5 --&gt; -0.1592 0.2251 
## Optim:  f4 0 0.5 --&gt; 0.3425 1.427 
##  ----------------------------------------- 
## Newton: f3 0.1 0 --&gt; 2.875e-10 2.262e-10 
## Optim:  f4 0.1 0 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0.1 0.1 --&gt; 2.385e-13 2.453e-13 
## Optim:  f4 0.1 0.1 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0.1 0.2 --&gt; 1.598e-13 1.837e-13 
## Optim:  f4 0.1 0.2 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0.1 0.3 --&gt; -0.5584 -0.7897 
## Optim:  f4 0.1 0.3 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0.1 0.4 --&gt; -0.1592 0.2251 
## Optim:  f4 0.1 0.4 --&gt; 0.3425 1.427 
##  ----------------------------------------- 
## Newton: f3 0.1 0.5 --&gt; 4.93 4.147 
## Optim:  f4 0.1 0.5 --&gt; 0.3425 1.427 
##  ----------------------------------------- 
## Newton: f3 0.2 0 --&gt; 2.073e-14 1.71e-14 
## Optim:  f4 0.2 0 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0.2 0.1 --&gt; 8.943e-16 8.452e-16 
## Optim:  f4 0.2 0.1 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0.2 0.2 --&gt; 2.07e-10 2.225e-10 
## Optim:  f4 0.2 0.2 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0.2 0.3 --&gt; -1.653e-17 -3.075e-17 
## Optim:  f4 0.2 0.3 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0.2 0.4 --&gt; -25.13 -48.35 
## Optim:  f4 0.2 0.4 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0.2 0.5 --&gt; 0.3428 0.6699 
## Optim:  f4 0.2 0.5 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0.3 0 --&gt; 7.607e-14 5.27e-14 
## Optim:  f4 0.3 0 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0.3 0.1 --&gt; 1.618e-13 1.43e-13 
## Optim:  f4 0.3 0.1 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0.3 0.2 --&gt; 2.026e-14 1.999e-14 
## Optim:  f4 0.3 0.2 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0.3 0.3 --&gt; 1.832e-09 2.112e-09 
## Optim:  f4 0.3 0.3 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0.3 0.4 --&gt; 1.059e-13 9.414e-14 
## Optim:  f4 0.3 0.4 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0.3 0.5 --&gt; 2.023 3.804 
## Optim:  f4 0.3 0.5 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0.4 0 --&gt; 1.639e-09 1.885e-09 
## Optim:  f4 0.4 0 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0.4 0.1 --&gt; 6.77e-10 -3.265e-09 
## Optim:  f4 0.4 0.1 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0.4 0.2 --&gt; 7.305e-14 6.631e-14 
## Optim:  f4 0.4 0.2 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0.4 0.3 --&gt; 3.261e-14 3.352e-14 
## Optim:  f4 0.4 0.3 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0.4 0.4 --&gt; 5.718e-10 7.896e-10 
## Optim:  f4 0.4 0.4 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0.4 0.5 --&gt; 2.553e-17 3.03e-17 
## Optim:  f4 0.4 0.5 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0.5 0 --&gt; -0.2902 -0.2305 
## Optim:  f4 0.5 0 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0.5 0.1 --&gt; 3.2e-10 3.906e-10 
## Optim:  f4 0.5 0.1 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0.5 0.2 --&gt; 3.109e-17 2.973e-17 
## Optim:  f4 0.5 0.2 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0.5 0.3 --&gt; 5.537e-16 4.978e-16 
## Optim:  f4 0.5 0.3 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0.5 0.4 --&gt; 2.905e-15 3.159e-15 
## Optim:  f4 0.5 0.4 --&gt; 2.031 1.402 
##  ----------------------------------------- 
## Newton: f3 0.5 0.5 --&gt; 3.686e-11 5.179e-11 
## Optim:  f4 0.5 0.5 --&gt; 2.031 1.402 
##  ----------------------------------------- 
</code></pre>

</body>

</html>
