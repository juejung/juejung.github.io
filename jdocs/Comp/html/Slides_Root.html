<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>9. Root finding &mdash; ComputationalEconomicsLectures 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="ComputationalEconomicsLectures 1.0 documentation" href="index.html" />
    <link rel="next" title="10. Optimization" href="Slides_Optimization.html" />
    <link rel="prev" title="8. Random numbers" href="Slides_Random.html" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head>
  <body>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="Slides_Optimization.html" title="10. Optimization"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Slides_Random.html" title="8. Random numbers"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">ComputationalEconomicsLectures 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="root-finding">
<h1>9. Root finding<a class="headerlink" href="#root-finding" title="Permalink to this headline">¶</a></h1>
<div class="section" id="first-steps">
<h2>9.1. First steps<a class="headerlink" href="#first-steps" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">math</span> <span class="kn">as</span> <span class="nn">m</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span> <span class="k">as</span> <span class="n">st</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fsolve</span>
<span class="c">#</span>
<span class="kn">import</span> <span class="nn">time</span>  <span class="c"># Imports system time module to time your script</span>
<span class="c">#</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s">&#39;all&#39;</span><span class="p">)</span>  <span class="c"># close all open figures</span>
</pre></div>
</div>
<div class="section" id="define-example-function">
<h3>9.1.1. Define example function<a class="headerlink" href="#define-example-function" title="Permalink to this headline">¶</a></h3>
<p>Define am example function for which we calculate the root, i.e. find <span class="math">\(x\)</span>
so that <span class="math">\(f(x) = 0\)</span>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>  <span class="c"># function: f(x)</span>
    <span class="k">return</span> <span class="n">s</span>
</pre></div>
</div>
<p>Define the same function  but this time we return the functional value and the
first derivate of the function (i.e. the gradient).</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">func1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>  <span class="c"># function: f(x)</span>
    <span class="n">sp</span><span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">x</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>      <span class="c"># derivative of function: f&#39;(x)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s</span><span class="p">,</span> <span class="n">sp</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="plot-the-function">
<h3>9.1.2. Plot the function<a class="headerlink" href="#plot-the-function" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="n">xmin</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">x</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="p">(</span><span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span><span class="p">)</span><span class="o">/</span><span class="mf">200.0</span><span class="p">)</span>
<span class="n">fx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="nb">float</span><span class="p">)</span> <span class="c"># define column vector</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="n">fx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="c">#print &quot;fx=&quot; +str(fx)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fx</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="c"># Create a title with a red, bold/italic font</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/Slides_Root_FigAutos_1.png"><img alt="_images/Slides_Root_FigAutos_1.png" src="_images/Slides_Root_FigAutos_1.png" style="width: 12cm;" /></a>
</div>
</div>
<div class="section" id="newton-raphson">
<h2>9.2. Newton-Raphson<a class="headerlink" href="#newton-raphson" title="Permalink to this headline">¶</a></h2>
<div class="section" id="the-method">
<h3>9.2.1. The method<a class="headerlink" href="#the-method" title="Permalink to this headline">¶</a></h3>
<p>We start with an initial guess <span class="math">\(x_0\)</span>. The tangent line through the
initial guess can be defined as:</p>
<p><span class="math">\(f'(x_0)=\frac{f(x_0)-y}{x_0-x}\)</span>
This line crosses the x-axis at point <span class="math">\(x_1\)</span> so that
<span class="math">\(f'(x_0)=\frac{f(x_0)-0}{x_0-x_1}\)</span>
which we can solve for <span class="math">\(x_1\)</span> as:
<span class="math">\(x_1 = x_0 - \frac{f(x_0)}{f'(x_0)}.\)</span>
We can repeat this successively using the iterative procedure:
<span class="math">\(\boxed{x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)}}\)</span></p>
</div>
<div class="section" id="define-the-newton-raphson-algorithm">
<h3>9.2.2. Define the Newton-Raphson algorithm<a class="headerlink" href="#define-the-newton-raphson-algorithm" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">newtonraphson</span><span class="p">(</span><span class="n">ftn</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="n">maxiter</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
    <span class="c"># Newton_Raphson algorithm for solving ftn(x)[1] == 0</span>
    <span class="c"># we assume that ftn is a function of a single variable that</span>
<span class="n">returns</span>
    <span class="c"># the function value and the first derivative as a vector of</span>
<span class="n">length</span> <span class="mi">2</span>
    <span class="c">#</span>
    <span class="c"># x0 is the initial guess at the root</span>
    <span class="c"># the algorithm terminates when the function value is within</span>
<span class="n">distance</span>
    <span class="c"># tol of 0, or the number of iterations exceeds max.iter</span>
    <span class="c"># initialise</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span>
    <span class="n">fx</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="nb">iter</span> <span class="o">=</span>  <span class="mi">0</span>
    <span class="c"># continue iterating until stopping conditions are met</span>
    <span class="k">while</span> <span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">fx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">iter</span> <span class="o">&lt;</span> <span class="n">maxiter</span><span class="p">)):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">fx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">fx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">fx</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="nb">iter</span> <span class="o">=</span>  <span class="nb">iter</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;At iteration &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">iter</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; value of x is: &quot;</span> <span class="o">+</span>
<span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="c"># output depends on success of algorithm</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">fx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;Algorithm failed to converge&quot;</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">NULL</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;fx = &quot;</span><span class="p">,</span> <span class="n">fx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;Algorithm converged&quot;</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="calculate-the-root-of-the-function-calling-newtonraphson">
<h3>9.2.3. Calculate the root of the function calling &#8216;newtonraphson&#8217;<a class="headerlink" href="#calculate-the-root-of-the-function-calling-newtonraphson" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="n">newtonraphson</span><span class="p">(</span><span class="n">func1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>At iteration 1 value of x is: 1.12201964531
At iteration 2 value of x is: 1.29499697044
At iteration 3 value of x is: 1.30970906266
At iteration 4 value of x is: 1.30979958242
At iteration 5 value of x is: 1.3097995858
fx =  -5.55111512313e-17
Algorithm converged
</pre></div>
</div>
</div>
</div>
<div class="section" id="secant-method">
<h2>9.3. Secant method<a class="headerlink" href="#secant-method" title="Permalink to this headline">¶</a></h2>
<div class="section" id="define-the-secant-method">
<h3>9.3.1. Define the secant method<a class="headerlink" href="#define-the-secant-method" title="Permalink to this headline">¶</a></h3>
<p>In this case we start with two starting values <span class="math">\(x_0\)</span> and <span class="math">\(x_1\)</span> and
put a line through the functional values <span class="math">\(f(x_0)\)</span> and <span class="math">\(f(x_1)\)</span>. The
advantage of this method is that we do not have to calculate the first
derivative of the function.The line through <span class="math">\(f(x_0)\)</span> and <span class="math">\(f(x_1)\)</span>
is expressed as: <span class="math">\(\frac{y-f(x_1)}{x-x_1} =
\frac{f(x_0)-f(x_1)}{x_0-x_1}.\)</span></p>
<p>The point <span class="math">\(x_2\)</span> where this line crosses the x-axis can be found using:
<span class="math">\(\frac{0-f(x_1)}{x_2-x_1} = \frac{f(x_0)-f(x_1)}{x_0-x_1},\)</span> which results
in <span class="math">\(x_2 = x_1 - f(x_1)\frac{x_0-x_1}{f(x_0)-f(x_1)}.\)</span></p>
<p>The iterative procedure can be written as: <span class="math">\(\boxed{x_{n+1} = x_n -
f(x_n)\frac{x_{n-1}-x_n}{f(x_{n-1})-f(x_n)}}\)</span></p>
<p>Note that if <span class="math">\(x_0\)</span> and <span class="math">\(x_1\)</span> are close together then:
<span class="math">\(f'(x_n) \approx f(x_1)\frac{f(x_n)-f(x_{n-1})}{x_n-x_{n-1}}.\)</span></p>
</div>
<div class="section" id="the-algorithm-of-the-secant-method">
<h3>9.3.2. The algorithm of the secant method<a class="headerlink" href="#the-algorithm-of-the-secant-method" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">secant</span><span class="p">(</span><span class="n">ftn</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="n">maxiter</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
    <span class="c"># Secant algorithm for solving ftn(x) == 0</span>
    <span class="c"># we assume that ftn is a function of a single variable that</span>
<span class="n">returns</span>
    <span class="c"># the function value</span>
    <span class="c">#</span>
    <span class="c"># x0 and x1 are the initial guesses around the root</span>
    <span class="c"># the algorithm terminates when the function value is within</span>
<span class="n">distance</span>
    <span class="c"># tol of 0, or the number of iterations exceeds max.iter</span>
    <span class="c">#</span>
    <span class="c"># initialize</span>
    <span class="n">fx0</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
    <span class="n">fx1</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
    <span class="nb">iter</span> <span class="o">=</span>  <span class="mi">0</span>
    <span class="c">#</span>
    <span class="c"># continue iterating until stopping conditions are met</span>
    <span class="k">while</span> <span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">fx1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">iter</span> <span class="o">&lt;</span> <span class="n">maxiter</span><span class="p">)):</span>
        <span class="n">x</span>  <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">fx1</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">fx1</span> <span class="o">-</span> <span class="n">fx0</span><span class="p">)</span>
        <span class="n">fx0</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
        <span class="n">fx1</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x0</span>  <span class="o">=</span> <span class="n">x1</span>
        <span class="n">x1</span>  <span class="o">=</span> <span class="n">x</span>
        <span class="nb">iter</span> <span class="o">=</span>  <span class="nb">iter</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;At iteration &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">iter</span><span class="p">)</span><span class="o">+</span><span class="s">&quot; value of x is: &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="c"># output depends on success of algorithm</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">fx1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;Algorithm failed to converge&quot;</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">NULL</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
       <span class="k">print</span><span class="p">(</span><span class="s">&quot;Algorithm converged&quot;</span><span class="p">)</span>
       <span class="k">return</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="calculate-the-root-of-the-function-calling-secant">
<h3>9.3.3. Calculate the root of the function calling &#8216;secant&#8217;<a class="headerlink" href="#calculate-the-root-of-the-function-calling-secant" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="n">secant</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>At iteration 1 value of x is: 1.39741048217
At iteration 2 value of x is: 1.28547612015
At iteration 3 value of x is: 1.31067675808
At iteration 4 value of x is: 1.30980839802
At iteration 5 value of x is: 1.30979958261
At iteration 6 value of x is: 1.3097995858
Algorithm converged
</pre></div>
</div>
</div>
</div>
<div class="section" id="bisection">
<h2>9.4. Bisection<a class="headerlink" href="#bisection" title="Permalink to this headline">¶</a></h2>
<div class="section" id="define-the-bisection-method">
<h3>9.4.1. Define the bisection method<a class="headerlink" href="#define-the-bisection-method" title="Permalink to this headline">¶</a></h3>
<p>The bisection method is the most robust method, but it is slow. We start with
two values <span class="math">\(x_l &lt; x_r\)</span> which bracket the root of the function. It
therefore must hold that <span class="math">\(f(x_l) f(x_r) &lt; 0\)</span>. The algorithm then
repeatedly brackets around the root in the following systematic way:</p>
<blockquote>
<div><ol class="arabic simple">
<li>if <span class="math">\(x_r - x_l \le \epsilon\)</span> then stop</li>
<li>calculate midpoint: <span class="math">\(x_m = (x_l+x_r)/2\)</span></li>
<li>if <span class="math">\(f(x_m)==0\)</span> stop</li>
<li>if <span class="math">\(f(x_l) f(x_r) &lt; 0\)</span> then set <span class="math">\(x_r = x_m\)</span> otherwise <span class="math">\(x_l=x_m\)</span></li>
<li>go back to step 1</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="the-algorithm-of-the-bisection-method">
<h3>9.4.2. The algorithm of the bisection method<a class="headerlink" href="#the-algorithm-of-the-bisection-method" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">bisection</span><span class="p">(</span><span class="n">ftn</span><span class="p">,</span> <span class="n">xl</span><span class="p">,</span> <span class="n">xr</span><span class="p">,</span> <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-9</span><span class="p">):</span>
    <span class="c"># applies the bisection algorithm to find x such that ftn(x) == 0</span>
    <span class="c"># we assume that ftn is a function of a single variable</span>
    <span class="c">#</span>
    <span class="c"># x.l and x.r must bracket the fixed point, that is</span>
    <span class="c"># x.l &lt; x.r and ftn(x.l) * ftn(x.r) &lt; 0</span>
    <span class="c">#</span>
    <span class="c"># the algorithm iteratively refines x.l and x.r and terminates</span>
<span class="n">when</span>
    <span class="c"># x.r - x.l &lt;= tol</span>

    <span class="c"># check inputs</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">xl</span> <span class="o">&gt;=</span> <span class="n">xr</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;error: xl &gt;= xr&quot;</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">NULL</span><span class="p">)</span>

    <span class="n">fl</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">xl</span><span class="p">)</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">xr</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">fl</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">fr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">fl</span> <span class="o">*</span> <span class="n">fr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;error: ftn(xl) * ftn(xr) &gt; 0&quot;</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">NULL</span><span class="p">)</span>

    <span class="c"># successively refine x.l and x.r</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="p">((</span><span class="n">xr</span> <span class="o">-</span> <span class="n">xl</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">):</span>
        <span class="n">xm</span> <span class="o">=</span> <span class="p">(</span><span class="n">xl</span> <span class="o">+</span> <span class="n">xr</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
        <span class="n">fm</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">xm</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">fm</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">return</span><span class="p">(</span><span class="n">fm</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">fl</span> <span class="o">*</span> <span class="n">fm</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">xr</span> <span class="o">=</span> <span class="n">xm</span>
            <span class="n">fr</span> <span class="o">=</span> <span class="n">fm</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xl</span> <span class="o">=</span> <span class="n">xm</span>
            <span class="n">fl</span> <span class="o">=</span> <span class="n">fm</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;at iteration &quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; the root lies between &quot;</span> <span class="o">+</span>
<span class="nb">str</span><span class="p">(</span><span class="n">xl</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; and &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">xr</span><span class="p">))</span>

    <span class="c"># return (approximate) root</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">xl</span> <span class="o">+</span> <span class="n">xr</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="calculate-the-root-of-the-function-calling-bisection">
<h3>9.4.3. Calculate the root of the function calling &#8216;bisection&#8217;<a class="headerlink" href="#calculate-the-root-of-the-function-calling-bisection" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="n">bisection</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>at iteration 1 the root lies between 1 and 1.5
at iteration 2 the root lies between 1.25 and 1.5
at iteration 3 the root lies between 1.25 and 1.375
at iteration 4 the root lies between 1.25 and 1.3125
at iteration 5 the root lies between 1.28125 and 1.3125
at iteration 6 the root lies between 1.296875 and 1.3125
at iteration 7 the root lies between 1.3046875 and 1.3125
at iteration 8 the root lies between 1.30859375 and 1.3125
at iteration 9 the root lies between 1.30859375 and 1.310546875
at iteration 10 the root lies between 1.3095703125 and 1.310546875
at iteration 11 the root lies between 1.3095703125 and 1.31005859375
at iteration 12 the root lies between 1.3095703125 and 1.309814453125
at iteration 13 the root lies between 1.3096923828125 and
1.309814453125
at iteration 14 the root lies between 1.30975341796875 and
1.309814453125
at iteration 15 the root lies between 1.309783935546875 and
1.309814453125
at iteration 16 the root lies between 1.3097991943359375 and
1.309814453125
at iteration 17 the root lies between 1.3097991943359375 and
1.3098068237304688
at iteration 18 the root lies between 1.3097991943359375 and
1.3098030090332031
at iteration 19 the root lies between 1.3097991943359375 and
1.3098011016845703
at iteration 20 the root lies between 1.3097991943359375 and
1.309800148010254
at iteration 21 the root lies between 1.3097991943359375 and
1.3097996711730957
at iteration 22 the root lies between 1.3097994327545166 and
1.3097996711730957
at iteration 23 the root lies between 1.3097995519638062 and
1.3097996711730957
at iteration 24 the root lies between 1.3097995519638062 and
1.309799611568451
at iteration 25 the root lies between 1.3097995817661285 and
1.309799611568451
at iteration 26 the root lies between 1.3097995817661285 and
1.3097995966672897
at iteration 27 the root lies between 1.3097995817661285 and
1.3097995892167091
at iteration 28 the root lies between 1.3097995854914188 and
1.3097995892167091
at iteration 29 the root lies between 1.3097995854914188 and
1.309799587354064
at iteration 30 the root lies between 1.3097995854914188 and
1.3097995864227414
</pre></div>
</div>
</div>
</div>
<div class="section" id="using-built-in-unit-root-function">
<h2>9.5. Using built in unit-root function<a class="headerlink" href="#using-built-in-unit-root-function" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span class="k">print</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot; -------------- Fsolve ------------&quot;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c"># starting from x = 2</span>
<span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre> -------------- Fsolve ------------
[ 1.30979959]
</pre></div>
</div>
</div>
<div class="section" id="homework">
<h2>9.6. Homework<a class="headerlink" href="#homework" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="Lecture_Root/Homework/Homework_Root.html"><em>## Exercise 1</em></a></p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">9. Root finding</a><ul>
<li><a class="reference internal" href="#first-steps">9.1. First steps</a><ul>
<li><a class="reference internal" href="#define-example-function">9.1.1. Define example function</a></li>
<li><a class="reference internal" href="#plot-the-function">9.1.2. Plot the function</a></li>
</ul>
</li>
<li><a class="reference internal" href="#newton-raphson">9.2. Newton-Raphson</a><ul>
<li><a class="reference internal" href="#the-method">9.2.1. The method</a></li>
<li><a class="reference internal" href="#define-the-newton-raphson-algorithm">9.2.2. Define the Newton-Raphson algorithm</a></li>
<li><a class="reference internal" href="#calculate-the-root-of-the-function-calling-newtonraphson">9.2.3. Calculate the root of the function calling &#8216;newtonraphson&#8217;</a></li>
</ul>
</li>
<li><a class="reference internal" href="#secant-method">9.3. Secant method</a><ul>
<li><a class="reference internal" href="#define-the-secant-method">9.3.1. Define the secant method</a></li>
<li><a class="reference internal" href="#the-algorithm-of-the-secant-method">9.3.2. The algorithm of the secant method</a></li>
<li><a class="reference internal" href="#calculate-the-root-of-the-function-calling-secant">9.3.3. Calculate the root of the function calling &#8216;secant&#8217;</a></li>
</ul>
</li>
<li><a class="reference internal" href="#bisection">9.4. Bisection</a><ul>
<li><a class="reference internal" href="#define-the-bisection-method">9.4.1. Define the bisection method</a></li>
<li><a class="reference internal" href="#the-algorithm-of-the-bisection-method">9.4.2. The algorithm of the bisection method</a></li>
<li><a class="reference internal" href="#calculate-the-root-of-the-function-calling-bisection">9.4.3. Calculate the root of the function calling &#8216;bisection&#8217;</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-built-in-unit-root-function">9.5. Using built in unit-root function</a></li>
<li><a class="reference internal" href="#homework">9.6. Homework</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="Slides_Random.html"
                        title="previous chapter">8. Random numbers</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="Slides_Optimization.html"
                        title="next chapter">10. Optimization</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="Slides_Optimization.html" title="10. Optimization"
             >next</a> |</li>
        <li class="right" >
          <a href="Slides_Random.html" title="8. Random numbers"
             >previous</a> |</li>
        <li><a href="index.html">ComputationalEconomicsLectures 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Juergen Jung.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>