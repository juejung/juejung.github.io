

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>12. Root finding &mdash; Computational Economics 1.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="Computational Economics 1.0 documentation" href="index.html"/>
        <link rel="next" title="13. Optimization" href="Slides_Optimization.html"/>
        <link rel="prev" title="11. Random numbers" href="Slides_Random.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> Computational Economics</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Slides_CourseAdministration.html">1. Course Administration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_CourseAdministration.html#installing-python">1.1. Installing Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_CourseAdministration.html#git-and-github">1.2. Git and Github</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_CourseAdministration.html#submitting-homework-midterm-and-the-final-via-github">1.3. Submitting homework, midterm and the final via GitHub</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Basics.html">2. First steps in Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Basics.html#simple-calculations">2.1. Simple calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Basics.html#the-print-function">2.2. The print function</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Basics.html#script-files">2.3. Script files</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Basics.html#ipython-notebook">2.4. iPython Notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Basics.html#lists-tuples-and-dictionaries">2.5. Lists, tuples and dictionaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Basics.html#in-class-exercises">2.6. In class exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Loop.html">3. Basic programming techniques</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Loop.html#branching">3.1. Branching</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Loop.html#for-loops">3.2. For loops</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Loop.html#while-loop">3.3. While loop</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Debugging.html">4. Debugging</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Debugging.html#using-print-statements-to-spot-mistakes">4.1. Using print statements to spot mistakes</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Debugging.html#using-the-debugger">4.2. Using the debugger</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Debugging.html#in-class-exercises">4.3. In class exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Arrays.html">5. Vectors and matrices</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Arrays.html#definitions-of-vectors-and-matrices">5.1. Definitions of vectors and matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Arrays.html#simple-calculations-with-vectors-and-matrices">5.2. Simple calculations with vectors and matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Arrays.html#vector-manipulation">5.3. Vector manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Arrays.html#matrix-manipulation">5.4. Matrix manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Arrays.html#in-class-exercises">5.5. In class exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Plot.html">6. Plotting using <tt class="docutils literal"><span class="pre">matplotlib</span></tt></a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Plot.html#plotting-vectors-and-arrays">6.1. Plotting vectors and arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Plot.html#plotting-functions">6.2. Plotting functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Plot.html#subplots">6.3. Subplots</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Plot.html#d-graphs">6.4. 3D-Graphs</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Plot.html#homework">6.5. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Functions.html">7. Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Functions.html#use-simple-user-defined-functions">7.1. Use simple user defined functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Functions.html#advanced-graphing-using-loops-and-functions">7.2. Advanced Graphing using loops and functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Functions.html#scope-of-variables-in-functions">7.3. Scope of variables in functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Functions.html#functions-with-default-arguments">7.4. Functions with default arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Functions.html#in-class-exercises">7.5. In class exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_OOP.html">8. Object Oriented Programming</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_OOP.html#introduction">8.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OOP.html#inheritance-and-subclasses">8.2. Inheritance and subclasses</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OOP.html#generating-multiple-objects">8.3. Generating multiple objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OOP.html#homework">8.4. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Data.html">9. Working with data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Data.html#read-in-small-data-set-from-a-comma-separated-csv-file">9.1. Read in small data set from a comma separated (.csv) file</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Data.html#some-pandas-tricks">9.2. Some Pandas tricks</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Data.html#making-simple-graphs-from-our-data">9.3. Making simple graphs from our data</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Data.html#summary-statistics">9.4. Summary statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Data.html#measures-of-linear-relationship">9.5. Measures of linear relationship</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_WebData.html">10. Working with data from the web</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_WebData.html#more-tutorials">10.1. More tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_WebData.html#homework">10.2. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Random.html">11. Random numbers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Random.html#uniformly-distributed-random-numbers">11.1. Uniformly distributed random numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Random.html#normally-distributed-random-numbers">11.2. Normally distributed random numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Random.html#t-distributed-random-variable">11.3. T-distributed random variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Random.html#homework">11.4. Homework</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">12. Root finding</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#first-steps">12.1. First steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="#newton-raphson">12.2. Newton-Raphson</a></li>
<li class="toctree-l2"><a class="reference internal" href="#secant-method">12.3. Secant method</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bisection">12.4. Bisection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-built-in-unit-root-function">12.5. Using built in unit-root function</a></li>
<li class="toctree-l2"><a class="reference internal" href="#homework">12.6. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Optimization.html">13. Optimization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Optimization.html#univariate-function-optimization">13.1. Univariate function optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Optimization.html#optimization-methods">13.2. Optimization methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Optimization.html#multivariate-optimization">13.3. Multivariate optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Optimization.html#finding-the-root-of-a-function-using-minimization">13.4. Finding the root of a function using minimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Optimization.html#homework">13.5. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Cake.html">14. The cake eating problem</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#solution">14.1. Solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#formally">14.2. Formally</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#id1">14.3. Formally</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#analytical-solution">14.4. Analytical solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#euler-equation">14.5. Euler equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#solving-the-problem">14.6. Solving the problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#solving-the-problem-analytics">14.7. Solving the problem: analytics</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#plotting-the-solution">14.8. Plotting the solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#numerical-solution">14.9. Numerical solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#function-definitions">14.10. Function definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#plotting-is-achieved-via">14.11. Plotting is achieved via:</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#numerical-solution-in-python">14.12. Numerical solution in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#optimizer-in-optimize-toolbox">14.13. Optimizer in <tt class="docutils literal"><span class="pre">optimize</span></tt> toolbox</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#homework">14.14. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_OLG_I.html">15. A simple OLG model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#preferences">15.1. Preferences</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#technology">15.2. Technology</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#government">15.3. Government</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#household-problem">15.4. Household problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#equilibrium-definition">15.5. Equilibrium definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#functional-forms-and-solutions">15.6. Functional forms and solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#substitute-the-budget-set-into-preferences">15.7. Substitute the budget set into preferences</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#solve-for-optimal-household-savings">15.8. Solve for optimal household savings: <span class="math">\(s^*\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#solution">15.9. Solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#equation-system">15.10. Equation system</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#method-1-substituting-everything">15.11. Method 1: Substituting everything</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#one-equation-in-k">15.12. One equation in K</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#aggregate-resource-constraint-arc">15.13. Aggregate resource constraint (ARC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#python-program-1">15.14. Python Program 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#method-2">15.15. Method 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#python-program-2">15.16. Python Program 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#homework">15.17. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_OLG_II.html">16. An OLG model with labor-leisure choice</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_II.html#preferences">16.1. Preferences</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_II.html#technology">16.2. Technology</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_II.html#government">16.3. Government</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_II.html#household-problem">16.4. Household problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_II.html#equilibrium-definition">16.5. Equilibrium definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_II.html#functional-forms-and-solutions">16.6. Functional forms and solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_II.html#substitute-in-preferences">16.7. Substitute in preferences</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_II.html#solve-for-optimal-and">16.8. Solve for optimal <span class="math">\(s^*\)</span> and <span class="math">\(l^*\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_II.html#homework">16.9. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Growth.html">17. Growth Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Growth.html#preferences">17.1. Preferences</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Growth.html#technology">17.2. Technology</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Growth.html#government">17.3. Government</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Growth.html#household-problem">17.4. Household problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Growth.html#equilibrium-definition">17.5. Equilibrium definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Growth.html#functional-forms-and-solutions">17.6. Functional forms and solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Growth.html#substitute-in-preferences">17.7. Substitute in preferences</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Growth.html#solve-for-optimal-and">17.8. Solve for optimal <span class="math">\(s^*\)</span> and <span class="math">\(l^*\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Growth.html#homework">17.9. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Assignments.html">18. Assignments</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Assignments.html#midterm">18.1. Midterm</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Assignments.html#homework">18.2. Homework</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Computational Economics</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>12. Root finding</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/Slides_Root.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="root-finding">
<h1>12. Root finding<a class="headerlink" href="#root-finding" title="Permalink to this headline">¶</a></h1>
<div class="section" id="first-steps">
<h2>12.1. First steps<a class="headerlink" href="#first-steps" title="Permalink to this headline">¶</a></h2>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">math</span> <span class="kn">as</span> <span class="nn">m</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span> <span class="k">as</span> <span class="n">st</span>
<span class="c">#</span>
<span class="kn">import</span> <span class="nn">time</span>  <span class="c"># Imports system time module to time your script</span>
<span class="c">#</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s">&#39;all&#39;</span><span class="p">)</span>  <span class="c"># close all open figures</span>
</pre></div>
</div>
<div class="section" id="define-example-function">
<h3>12.1.1. Define example function<a class="headerlink" href="#define-example-function" title="Permalink to this headline">¶</a></h3>
<p>Define am example function for which we calculate the root, i.e. find <span class="math">\(x\)</span>
so that <span class="math">\(f(x) = 0\)</span>.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>  <span class="c"># function: f(x)</span>
    <span class="k">return</span> <span class="n">s</span>
</pre></div>
</div>
<p>Define the same function  but this time we return the functional value and the
first derivate of the function (i.e. the gradient).</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">func1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>  <span class="c"># function: f(x)</span>
    <span class="n">sp</span><span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">x</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>      <span class="c"># derivative of function: f&#39;(x)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s</span><span class="p">,</span> <span class="n">sp</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="plot-the-function">
<h3>12.1.2. Plot the function<a class="headerlink" href="#plot-the-function" title="Permalink to this headline">¶</a></h3>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">xmin</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">x</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="p">(</span><span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span><span class="p">)</span><span class="o">/</span><span class="mf">200.0</span><span class="p">)</span>
<span class="n">fx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="nb">float</span><span class="p">)</span> <span class="c"># define column vector</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="n">fx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="c">#print &quot;fx=&quot; +str(fx)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fx</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="c"># Create a title with a red, bold/italic font</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/Slides_Root_FigAutos_1.png"><img alt="_images/Slides_Root_FigAutos_1.png" src="_images/Slides_Root_FigAutos_1.png" style="width: 12cm;" /></a>
</div>
</div>
<div class="section" id="newton-raphson">
<h2>12.2. Newton-Raphson<a class="headerlink" href="#newton-raphson" title="Permalink to this headline">¶</a></h2>
<div class="section" id="the-method">
<h3>12.2.1. The method<a class="headerlink" href="#the-method" title="Permalink to this headline">¶</a></h3>
<p>We start with an initial guess <span class="math">\(x_0\)</span>. The tangent line through the
initial guess can be defined as:</p>
<p><span class="math">\(f'(x_0)=\frac{f(x_0)-y}{x_0-x}\)</span>
This line crosses the x-axis at point <span class="math">\(x_1\)</span> so that
<span class="math">\(f'(x_0)=\frac{f(x_0)-0}{x_0-x_1}\)</span>
which we can solve for <span class="math">\(x_1\)</span> as:
<span class="math">\(x_1 = x_0 - \frac{f(x_0)}{f'(x_0)}.\)</span>
We can repeat this successively using the iterative procedure:
<span class="math">\(\boxed{x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)}}\)</span></p>
</div>
<div class="section" id="define-the-newton-raphson-algorithm">
<h3>12.2.2. Define the Newton-Raphson algorithm<a class="headerlink" href="#define-the-newton-raphson-algorithm" title="Permalink to this headline">¶</a></h3>
<div class="code python highlight-python"><div class="highlight"><pre>def newtonraphson(ftn, x0, tol = 1e-9, maxiter = 100):
    # Newton_Raphson algorithm for solving ftn(x)[1] == 0
    # we assume that ftn is a function of a single variable that
returns
    # the function value and the first derivative as a vector of
length 2
    #
    # x0 is the initial guess at the root
    # the algorithm terminates when the function value is within
distance
    # tol of 0, or the number of iterations exceeds max.iter
    # initialise

    x = x0
    fx = ftn(x)
    iter =  0
    # continue iterating until stopping conditions are met
    while ((abs(fx[0]) &gt; tol) and (iter &lt; maxiter)):
        x = x - fx[0]/fx[1]
        fx = ftn(x)
        iter =  iter + 1
        print(&quot;At iteration &quot; + str(iter) + &quot; value of x is: &quot; +
str(x))

    # output depends on success of algorithm
    if (abs(fx[0]) &gt; tol):
        print(&quot;Algorithm failed to converge&quot;)
        return(NULL)
    else:
        print(&quot;fx = &quot;, fx[0])
        print(&quot;Algorithm converged&quot;)
        return(x)
</pre></div>
</div>
</div>
<div class="section" id="calculate-the-root-of-the-function-calling-newtonraphson">
<h3>12.2.3. Calculate the root of the function calling &#8216;newtonraphson&#8217;<a class="headerlink" href="#calculate-the-root-of-the-function-calling-newtonraphson" title="Permalink to this headline">¶</a></h3>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">newtonraphson</span><span class="p">(</span><span class="n">func1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="code highlight-python"><div class="highlight"><pre>At iteration 1 value of x is: 1.12201964531
At iteration 2 value of x is: 1.29499697044
At iteration 3 value of x is: 1.30970906266
At iteration 4 value of x is: 1.30979958242
At iteration 5 value of x is: 1.3097995858
fx =  -5.55111512313e-17
Algorithm converged
</pre></div>
</div>
</div>
</div>
<div class="section" id="secant-method">
<h2>12.3. Secant method<a class="headerlink" href="#secant-method" title="Permalink to this headline">¶</a></h2>
<div class="section" id="define-the-secant-method">
<h3>12.3.1. Define the secant method<a class="headerlink" href="#define-the-secant-method" title="Permalink to this headline">¶</a></h3>
<p>In this case we start with two starting values <span class="math">\(x_0\)</span> and <span class="math">\(x_1\)</span> and
put a line through the functional values <span class="math">\(f(x_0)\)</span> and <span class="math">\(f(x_1)\)</span>. The
advantage of this method is that we do not have to calculate the first
derivative of the function.The line through <span class="math">\(f(x_0)\)</span> and <span class="math">\(f(x_1)\)</span>
is expressed as: <span class="math">\(\frac{y-f(x_1)}{x-x_1} =
\frac{f(x_0)-f(x_1)}{x_0-x_1}.\)</span></p>
<p>The point <span class="math">\(x_2\)</span> where this line crosses the x-axis can be found using:
<span class="math">\(\frac{0-f(x_1)}{x_2-x_1} = \frac{f(x_0)-f(x_1)}{x_0-x_1},\)</span> which results
in <span class="math">\(x_2 = x_1 - f(x_1)\frac{x_0-x_1}{f(x_0)-f(x_1)}.\)</span></p>
<p>The iterative procedure can be written as: <span class="math">\(\boxed{x_{n+1} = x_n -
f(x_n)\frac{x_{n-1}-x_n}{f(x_{n-1})-f(x_n)}}\)</span></p>
<p>Note that if <span class="math">\(x_0\)</span> and <span class="math">\(x_1\)</span> are close together then:
<span class="math">\(f'(x_n) \approx f(x_1)\frac{f(x_n)-f(x_{n-1})}{x_n-x_{n-1}}.\)</span></p>
</div>
<div class="section" id="the-algorithm-of-the-secant-method">
<h3>12.3.2. The algorithm of the secant method<a class="headerlink" href="#the-algorithm-of-the-secant-method" title="Permalink to this headline">¶</a></h3>
<div class="code python highlight-python"><div class="highlight"><pre>def secant(ftn, x0, x1, tol = 1e-9, maxiter = 100):
    # Secant algorithm for solving ftn(x) == 0
    # we assume that ftn is a function of a single variable that
returns
    # the function value
    #
    # x0 and x1 are the initial guesses around the root
    # the algorithm terminates when the function value is within
distance
    # tol of 0, or the number of iterations exceeds max.iter
    #
    # initialize
    fx0 = ftn(x0)
    fx1 = ftn(x1)
    iter =  0
    #
    # continue iterating until stopping conditions are met
    while ((abs(fx1) &gt; tol) and (iter &lt; maxiter)):
        x  = x1 - fx1 * (x1-x0)/(fx1 - fx0)
        fx0 = ftn(x1)
        fx1 = ftn(x)
        x0  = x1
        x1  = x
        iter =  iter + 1
        print(&quot;At iteration &quot;+str(iter)+&quot; value of x is: &quot;+str(x))
# output depends on success of algorithm
    if (abs(fx1) &gt; tol):
        print(&quot;Algorithm failed to converge&quot;)
        return(NULL)
    else:
       print(&quot;Algorithm converged&quot;)
       return(x)
</pre></div>
</div>
</div>
<div class="section" id="calculate-the-root-of-the-function-calling-secant">
<h3>12.3.3. Calculate the root of the function calling &#8216;secant&#8217;<a class="headerlink" href="#calculate-the-root-of-the-function-calling-secant" title="Permalink to this headline">¶</a></h3>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">secant</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="code highlight-python"><div class="highlight"><pre>At iteration 1 value of x is: 1.39741048217
At iteration 2 value of x is: 1.28547612015
At iteration 3 value of x is: 1.31067675808
At iteration 4 value of x is: 1.30980839802
At iteration 5 value of x is: 1.30979958261
At iteration 6 value of x is: 1.3097995858
Algorithm converged
</pre></div>
</div>
</div>
</div>
<div class="section" id="bisection">
<h2>12.4. Bisection<a class="headerlink" href="#bisection" title="Permalink to this headline">¶</a></h2>
<div class="section" id="define-the-bisection-method">
<h3>12.4.1. Define the bisection method<a class="headerlink" href="#define-the-bisection-method" title="Permalink to this headline">¶</a></h3>
<p>The bisection method is the most robust method, but it is slow. We start with
two values <span class="math">\(x_l &lt; x_r\)</span> which bracket the root of the function. It
therefore must hold that <span class="math">\(f(x_l) f(x_r) &lt; 0\)</span>. The algorithm then
repeatedly brackets around the root in the following systematic way:</p>
<blockquote>
<div><ol class="arabic simple">
<li>if <span class="math">\(x_r - x_l \le \epsilon\)</span> then stop</li>
<li>calculate midpoint: <span class="math">\(x_m = (x_l+x_r)/2\)</span></li>
<li>if <span class="math">\(f(x_m)==0\)</span> stop</li>
<li>if <span class="math">\(f(x_l) f(x_r) &lt; 0\)</span> then set <span class="math">\(x_r = x_m\)</span> otherwise <span class="math">\(x_l=x_m\)</span></li>
<li>go back to step 1</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="the-algorithm-of-the-bisection-method">
<h3>12.4.2. The algorithm of the bisection method<a class="headerlink" href="#the-algorithm-of-the-bisection-method" title="Permalink to this headline">¶</a></h3>
<div class="code python highlight-python"><div class="highlight"><pre>def bisection(ftn, xl, xr, tol = 1e-9):
    # applies the bisection algorithm to find x such that ftn(x) == 0
    # we assume that ftn is a function of a single variable
    #
    # x.l and x.r must bracket the fixed point, that is
    # x.l &lt; x.r and ftn(x.l) * ftn(x.r) &lt; 0
    #
    # the algorithm iteratively refines x.l and x.r and terminates
when
    # x.r - x.l &lt;= tol

    # check inputs
    if (xl &gt;= xr):
        print(&quot;error: xl &gt;= xr&quot;)
        return(NULL)

    fl = ftn(xl)
    fr = ftn(xr)

    if (fl == 0):
        return(x.l)
    elif (fr == 0):
        return(x.r)
    elif (fl * fr &gt; 0):
        print(&quot;error: ftn(xl) * ftn(xr) &gt; 0&quot;)
        return(NULL)

    # successively refine x.l and x.r
    n = 0
    while ((xr - xl) &gt; tol):
        xm = (xl + xr)/2.0
        fm = ftn(xm)
        if (fm == 0):
            return(fm)
        elif (fl * fm &lt; 0):
            xr = xm
            fr = fm
        else:
            xl = xm
            fl = fm
        n = n + 1
        print(&quot;at iteration &quot;+ str(n) + &quot; the root lies between &quot; +
str(xl) + &quot; and &quot; + str(xr))

    # return (approximate) root
    return ((xl + xr)/2.0)
</pre></div>
</div>
</div>
<div class="section" id="calculate-the-root-of-the-function-calling-bisection">
<h3>12.4.3. Calculate the root of the function calling &#8216;bisection&#8217;<a class="headerlink" href="#calculate-the-root-of-the-function-calling-bisection" title="Permalink to this headline">¶</a></h3>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">bisection</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="code highlight-python"><div class="highlight"><pre>at iteration 1 the root lies between 1 and 1.5
at iteration 2 the root lies between 1.25 and 1.5
at iteration 3 the root lies between 1.25 and 1.375
at iteration 4 the root lies between 1.25 and 1.3125
at iteration 5 the root lies between 1.28125 and 1.3125
at iteration 6 the root lies between 1.296875 and 1.3125
at iteration 7 the root lies between 1.3046875 and 1.3125
at iteration 8 the root lies between 1.30859375 and 1.3125
at iteration 9 the root lies between 1.30859375 and 1.310546875
at iteration 10 the root lies between 1.3095703125 and 1.310546875
at iteration 11 the root lies between 1.3095703125 and 1.31005859375
at iteration 12 the root lies between 1.3095703125 and 1.309814453125
at iteration 13 the root lies between 1.3096923828125 and
1.309814453125
at iteration 14 the root lies between 1.30975341796875 and
1.309814453125
at iteration 15 the root lies between 1.309783935546875 and
1.309814453125
at iteration 16 the root lies between 1.3097991943359375 and
1.309814453125
at iteration 17 the root lies between 1.3097991943359375 and
1.3098068237304688
at iteration 18 the root lies between 1.3097991943359375 and
1.3098030090332031
at iteration 19 the root lies between 1.3097991943359375 and
1.3098011016845703
at iteration 20 the root lies between 1.3097991943359375 and
1.309800148010254
at iteration 21 the root lies between 1.3097991943359375 and
1.3097996711730957
at iteration 22 the root lies between 1.3097994327545166 and
1.3097996711730957
at iteration 23 the root lies between 1.3097995519638062 and
1.3097996711730957
at iteration 24 the root lies between 1.3097995519638062 and
1.309799611568451
at iteration 25 the root lies between 1.3097995817661285 and
1.309799611568451
at iteration 26 the root lies between 1.3097995817661285 and
1.3097995966672897
at iteration 27 the root lies between 1.3097995817661285 and
1.3097995892167091
at iteration 28 the root lies between 1.3097995854914188 and
1.3097995892167091
at iteration 29 the root lies between 1.3097995854914188 and
1.309799587354064
at iteration 30 the root lies between 1.3097995854914188 and
1.3097995864227414
</pre></div>
</div>
</div>
</div>
<div class="section" id="using-built-in-unit-root-function">
<h2>12.5. Using built in unit-root function<a class="headerlink" href="#using-built-in-unit-root-function" title="Permalink to this headline">¶</a></h2>
<p>The built in functions are part of the
<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize">scipy.optimize</a> library.
The functions work very similar to the ones that we just wrote ourselves. It
usually requires that we first define our function. We then hand it to the
solver algorithm with a starting guess of the root position.
The first root finding algorithm is called
<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.root.html#scipy.optimize.root">root</a></p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">root</span>
<span class="n">guess</span> <span class="o">=</span> <span class="mi">2</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot; -------------- Root ------------&quot;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">root</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">guess</span><span class="p">)</span> <span class="c"># starting from x = 2</span>
<span class="n">myroot</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span>  <span class="c"># Grab number from result dictionary</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;The root of func is at {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myroot</span><span class="p">))</span>
</pre></div>
</div>
<div class="code highlight-python"><div class="highlight"><pre> -------------- Root ------------
The root of func is at [ 1.31]
</pre></div>
</div>
<p>The second root finding algorithm is called
<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.root.html#scipy.optimize.fsolve">fsolve</a></p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fsolve</span>

<span class="n">guess</span> <span class="o">=</span> <span class="mi">2</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot; -------------- Fsolve ------------&quot;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">guess</span><span class="p">)</span> <span class="c"># starting from x = 2</span>
<span class="n">myroot</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c"># Grab number from result dictionary</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;The root is at {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
</pre></div>
</div>
<div class="code highlight-python"><div class="highlight"><pre> -------------- Fsolve ------------
The root is at [ 1.31]
</pre></div>
</div>
<p>or</p>
</div>
<div class="section" id="homework">
<h2>12.6. Homework<a class="headerlink" href="#homework" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="Lecture_Root/Homework/Homework_Root.html"><em>## Exercise 1</em></a></p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Slides_Optimization.html" class="btn btn-neutral float-right" title="13. Optimization"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Slides_Random.html" class="btn btn-neutral" title="11. Random numbers"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Juergen Jung.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>