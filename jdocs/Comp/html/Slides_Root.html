

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>14. Root finding &mdash; Computational Economics 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Computational Economics 1.0 documentation" href="index.html"/>
        <link rel="next" title="15. Optimization" href="Slides_Optimization.html"/>
        <link rel="prev" title="13. Random numbers" href="Slides_Random.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Computational Economics
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Slides_CourseAdministration.html">1. Course Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Basics.html">2. First steps in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Loop.html">3. Basic programming techniques</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Debugging.html">4. Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Arrays.html">5. Vectors and Matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Plot.html">6. Plotting using <code class="docutils literal"><span class="pre">matplotlib</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Functions.html">7. Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_OOP.html">8. Object Oriented Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Data_1.html">9. Working with data I: Data cleaning</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Data_2.html">10. Working with data II: Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_WebData.html">11. Working with data from the web</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_WebData_2.html">12. Working with Data from the Web</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Random.html">13. Random numbers</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">14. Root finding</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#first-steps">14.1. First steps</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#define-example-function">14.1.1. Define example function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plot-the-function">14.1.2. Plot the function</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#newton-raphson">14.2. Newton-Raphson</a></li>
<li class="toctree-l2"><a class="reference internal" href="#secant-method">14.3. Secant method</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bisection">14.4. Bisection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-algorithm-of-the-bisection-method">14.4.1. The algorithm of the bisection method</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#using-built-in-unit-root-function">14.5. Using built in unit-root function</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Optimization.html">15. Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Cake.html">16. Constrainted Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_OLG_I.html">17. A Simple OLG model</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_OLG_II.html">18. An OLG model with labor-leisure choice</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Growth.html">19. Growth Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Assignments.html">20. Assignments</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Computational Economics</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>14. Root finding</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/Slides_Root.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="root-finding">
<h1>14. Root finding<a class="headerlink" href="#root-finding" title="Permalink to this headline">¶</a></h1>
<div class="section" id="first-steps">
<h2>14.1. First steps<a class="headerlink" href="#first-steps" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">time</span>  <span class="c1"># Imports system time module to time your script</span>
<span class="c1">#</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>  <span class="c1"># close all open figures</span>
</pre></div>
</div>
<div class="section" id="define-example-function">
<h3>14.1.1. Define example function<a class="headerlink" href="#define-example-function" title="Permalink to this headline">¶</a></h3>
<p>Define am example function for which we calculate the root, i.e. find <span class="math">\(x\)</span>
so that <span class="math">\(f(x) = 0\)</span>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="c1"># Function: f(x)</span>
    <span class="n">fx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fx</span>
</pre></div>
</div>
<p>Define the same function  but this time we return the functional value and the
first derivate of the function (i.e., the gradient).</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">func1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="c1"># Function: f(x)</span>
    <span class="n">fx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>

    <span class="c1"># Derivative of function: f&#39;(x)</span>
    <span class="n">d_fx</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">x</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">fx</span><span class="p">,</span> <span class="n">d_fx</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="plot-the-function">
<h3>14.1.2. Plot the function<a class="headerlink" href="#plot-the-function" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="n">xmin</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">xv</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="p">(</span><span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span><span class="p">)</span><span class="o">/</span><span class="mf">200.0</span><span class="p">)</span>
<span class="n">fxv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xv</span><span class="p">),</span><span class="nb">float</span><span class="p">)</span> <span class="c1"># define column vector</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xv</span><span class="p">)):</span>
    <span class="n">fxv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">xv</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">fxv</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xv</span><span class="p">)))</span>
<span class="c1"># Create a title with a red, bold/italic font</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/Slides_Root_FigAutos_1.png"><img alt="_images/Slides_Root_FigAutos_1.png" src="_images/Slides_Root_FigAutos_1.png" style="width: 12cm;" /></a>
</div>
</div>
<div class="section" id="newton-raphson">
<h2>14.2. Newton-Raphson<a class="headerlink" href="#newton-raphson" title="Permalink to this headline">¶</a></h2>
<p>We start with an initial guess <span class="math">\(x_0\)</span>. The tangent line through the
initial guess can be defined as:</p>
<div class="math">
\[f'(x_0)=\frac{f(x_0)-y}{x_0-x}.\]</div>
<p>This line crosses the x-axis at point <span class="math">\(x_1\)</span> so that:</p>
<blockquote>
<div><div class="math">
\[f'(x_0)=\frac{f(x_0)-0}{x_0-x_1},\]</div>
</div></blockquote>
<p>which we can solve for <span class="math">\(x_1\)</span> as:</p>
<blockquote>
<div><div class="math">
\[x_1 = x_0 - \frac{f(x_0)}{f'(x_0)}.\]</div>
</div></blockquote>
<dl class="docutils">
<dt>We can repeat this successively using the iterative procedure:</dt>
<dd><div class="first last math">
\[\boxed{x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)}}\]</div>
</dd>
</dl>
<p>In order for this function to work well we need to be able to calculate the
derivative of the function around the root point and preferably over the
entire domain of the function.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">newtonraphson</span><span class="p">(</span><span class="n">ftn</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="n">maxiter</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
    <span class="c1"># Newton_Raphson algorithm for solving ftn(x)[1] == 0</span>
    <span class="c1"># we assume that ftn is a function of a single</span>
    <span class="c1"># variable that returns the function value and</span>
    <span class="c1"># the first derivative as a vector of length 2</span>
    <span class="c1">#</span>
    <span class="c1"># x0 is the initial guess at the root</span>
    <span class="c1"># the algorithm terminates when the function</span>
    <span class="c1"># value is within distance tol of 0, or the</span>
    <span class="c1"># number of iterations exceeds maxiter</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span>
    <span class="n">fx</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">jiter</span> <span class="o">=</span>  <span class="mi">0</span>

    <span class="c1"># continue iterating until stopping conditions are met</span>
    <span class="k">while</span> <span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">fx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">jiter</span> <span class="o">&lt;</span> <span class="n">maxiter</span><span class="p">)):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">fx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">fx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">fx</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">jiter</span> <span class="o">=</span>  <span class="n">jiter</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;At iteration: {} the value of x is {}:&quot;</span> \
          <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">jiter</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>

    <span class="c1"># Output depends on success of algorithm</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">fx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Algorithm failed to converge&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;fx = &quot;</span><span class="p">,</span> <span class="n">fx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Algorithm converged&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
<p>We next calculate the root of the function <code class="docutils literal"><span class="pre">func1</span></code> calling the
<code class="docutils literal"><span class="pre">newtonraphson</span></code> algorithm.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">newtonraphson</span><span class="p">(</span><span class="n">func1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>At iteration: 1 the value of x is 1.122019645309717:
At iteration: 2 the value of x is 1.2949969704390394:
At iteration: 3 the value of x is 1.3097090626648604:
At iteration: 4 the value of x is 1.309799582422906:
At iteration: 5 the value of x is 1.3097995858041505:
fx =  -5.55111512313e-17
Algorithm converged
</pre></div>
</div>
</div>
<div class="section" id="secant-method">
<h2>14.3. Secant method<a class="headerlink" href="#secant-method" title="Permalink to this headline">¶</a></h2>
<p>As pointed out above, in order to use the <strong>Newton-Raphson</strong> method we need to
be able to calculate the derivative <span class="math">\(f'(x)\)</span> of the function. If this is
computationally expensive or maybe even impossible, we can use the <strong>secant</strong>
method which only requires that the function is continuous. That is, it does
not have to be differentiable over its domain.</p>
<p>In this case we start with two starting values or initial guesses,
<span class="math">\(x_0\)</span> and <span class="math">\(x_1\)</span> and
put a line through the functional values <span class="math">\(f(x_0)\)</span> and <span class="math">\(f(x_1)\)</span>. The
advantage of this method is that we do not have to calculate the first
derivative of the function. The line through <span class="math">\(f(x_0)\)</span> and <span class="math">\(f(x_1)\)</span>
is expressed as:</p>
<blockquote>
<div><div class="math">
\[\frac{y-f(x_1)}{x-x_1} = \frac{f(x_0)-f(x_1)}{x_0-x_1}.\]</div>
</div></blockquote>
<p>The point <span class="math">\(x_2\)</span> where this line crosses the x-axis can be found using:</p>
<blockquote>
<div><div class="math">
\[\frac{0-f(x_1)}{x_2-x_1} = \frac{f(x_0)-f(x_1)}{x_0-x_1},\]</div>
</div></blockquote>
<p>which results in</p>
<blockquote>
<div><div class="math">
\[x_2 = x_1 - f(x_1)\frac{x_0-x_1}{f(x_0)-f(x_1)}.\]</div>
</div></blockquote>
<p>The iterative procedure can be written as:</p>
<blockquote>
<div><div class="math">
\[\boxed{x_{n+1} = x_n - f(x_n)\frac{x_{n-1}-x_n}{f(x_{n-1})-f(x_n)}}\]</div>
</div></blockquote>
<p>Note that if <span class="math">\(x_0\)</span> and <span class="math">\(x_1\)</span> are close together then:</p>
<blockquote>
<div><div class="math">
\[f'(x_n) \approx f(x_1)\frac{f(x_n)-f(x_{n-1})}{x_n-x_{n-1}}.\]</div>
</div></blockquote>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">secant</span><span class="p">(</span><span class="n">ftn</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="n">maxiter</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
    <span class="c1"># Secant algorithm for solving ftn(x) == 0</span>
    <span class="c1"># we assume that ftn is a function of a</span>
    <span class="c1"># single variable that returns the function value</span>
    <span class="c1">#</span>
    <span class="c1"># x0 and x1 are the initial guesses around the root</span>
    <span class="c1"># the algorithm terminates when the function</span>
    <span class="c1"># value is within distance</span>
    <span class="c1"># tol of 0, or the number of iterations exceeds max.iter</span>

    <span class="n">fx0</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
    <span class="n">fx1</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
    <span class="n">jiter</span> <span class="o">=</span>  <span class="mi">0</span>

    <span class="c1"># continue iterating until stopping conditions are met</span>
    <span class="k">while</span> <span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">fx1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">jiter</span> <span class="o">&lt;</span> <span class="n">maxiter</span><span class="p">)):</span>
        <span class="n">x</span>  <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">fx1</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">fx1</span> <span class="o">-</span> <span class="n">fx0</span><span class="p">)</span>
        <span class="n">fx0</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
        <span class="n">fx1</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x0</span>  <span class="o">=</span> <span class="n">x1</span>
        <span class="n">x1</span>  <span class="o">=</span> <span class="n">x</span>
        <span class="n">jiter</span> <span class="o">=</span>  <span class="n">jiter</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;At iteration: {} the value of x is: {}&quot;</span> \
          <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">jiter</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>

    <span class="c1"># output depends on success of algorithm</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">fx1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Algorithm failed to converge&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="k">else</span><span class="p">:</span>
       <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Algorithm converged&quot;</span><span class="p">)</span>
       <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
<p>We next calculate the root point using the secant method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">secant</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>At iteration: 1 the value of x is: 1.3974104821696125
At iteration: 2 the value of x is: 1.2854761201506528
At iteration: 3 the value of x is: 1.310676758082541
At iteration: 4 the value of x is: 1.3098083980193003
At iteration: 5 the value of x is: 1.3097995826147546
At iteration: 6 the value of x is: 1.309799585804162
Algorithm converged
</pre></div>
</div>
</div>
<div class="section" id="bisection">
<h2>14.4. Bisection<a class="headerlink" href="#bisection" title="Permalink to this headline">¶</a></h2>
<p>The <strong>Newton-Raphson</strong> as well as the <strong>Secant</strong> method are not guaranteed to
work. The bisection method is the most robust method, but it is slow. We start with
two values <span class="math">\(x_l &lt; x_r\)</span> which bracket the root of the function. It
therefore must hold that <span class="math">\(f(x_l) f(x_r) &lt; 0\)</span>. The algorithm then
repeatedly brackets around the root in the following systematic way:</p>
<blockquote>
<div><ol class="arabic simple">
<li>if <span class="math">\(x_r - x_l \le \epsilon\)</span> then stop</li>
<li>calculate midpoint: <span class="math">\(x_m = (x_l+x_r)/2\)</span></li>
<li>if <span class="math">\(f(x_m)==0\)</span> stop</li>
<li>if <span class="math">\(f(x_l) f(x_m) &lt; 0\)</span> then set <span class="math">\(x_r = x_m\)</span> otherwise <span class="math">\(x_l=x_m\)</span></li>
<li>go back to step 1</li>
</ol>
</div></blockquote>
<div class="section" id="the-algorithm-of-the-bisection-method">
<h3>14.4.1. The algorithm of the bisection method<a class="headerlink" href="#the-algorithm-of-the-bisection-method" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">bisection</span><span class="p">(</span><span class="n">ftn</span><span class="p">,</span> <span class="n">xl</span><span class="p">,</span> <span class="n">xr</span><span class="p">,</span> <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-9</span><span class="p">):</span>
    <span class="c1"># applies the bisection algorithm to find x</span>
    <span class="c1"># such that ftn(x) == 0</span>
    <span class="c1"># we assume that ftn is a function of a single variable</span>
    <span class="c1">#</span>
    <span class="c1"># x.l and x.r must bracket the fixed point, that is</span>
    <span class="c1"># x.l &lt; x.r and ftn(x.l) * ftn(x.r) &lt; 0</span>
    <span class="c1">#</span>
    <span class="c1"># the algorithm iteratively refines</span>
    <span class="c1"># x.l and x.r and terminates when</span>
    <span class="c1"># x.r - x.l &lt;= tol</span>

    <span class="c1"># check inputs</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">xl</span> <span class="o">&gt;=</span> <span class="n">xr</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;error: xl &gt;= xr&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="n">fl</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">xl</span><span class="p">)</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">xr</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">fl</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">xl</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">fr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">xr</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">fl</span> <span class="o">*</span> <span class="n">fr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;error: ftn(xl) * ftn(xr) &gt; 0&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="c1"># successively refine x.l and x.r</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="p">((</span><span class="n">xr</span> <span class="o">-</span> <span class="n">xl</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">):</span>
        <span class="n">xm</span> <span class="o">=</span> <span class="p">(</span><span class="n">xl</span> <span class="o">+</span> <span class="n">xr</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
        <span class="n">fm</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">xm</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">fm</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">fm</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">fl</span> <span class="o">*</span> <span class="n">fm</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">xr</span> <span class="o">=</span> <span class="n">xm</span>
            <span class="n">fr</span> <span class="o">=</span> <span class="n">fm</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xl</span> <span class="o">=</span> <span class="n">xm</span>
            <span class="n">fl</span> <span class="o">=</span> <span class="n">fm</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;at iteration: {} the root lies between {} and {}&quot;</span> \
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">xl</span><span class="p">,</span> <span class="n">xr</span><span class="p">))</span>
    <span class="c1"># return (approximate) root</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">xl</span> <span class="o">+</span> <span class="n">xr</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
</pre></div>
</div>
<p>We next calculate the root of the function calling &#8216;bisection&#8217; method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">bisection</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>at iteration: 1 the root lies between 1 and 1.5
at iteration: 2 the root lies between 1.25 and 1.5
at iteration: 3 the root lies between 1.25 and 1.375
at iteration: 4 the root lies between 1.25 and 1.3125
at iteration: 5 the root lies between 1.28125 and 1.3125
at iteration: 6 the root lies between 1.296875 and 1.3125
at iteration: 7 the root lies between 1.3046875 and 1.3125
at iteration: 8 the root lies between 1.30859375 and 1.3125
at iteration: 9 the root lies between 1.30859375 and 1.310546875
at iteration: 10 the root lies between 1.3095703125 and 1.310546875
at iteration: 11 the root lies between 1.3095703125 and 1.31005859375
at iteration: 12 the root lies between 1.3095703125 and 1.309814453125
at iteration: 13 the root lies between 1.3096923828125 and
1.309814453125
at iteration: 14 the root lies between 1.30975341796875 and
1.309814453125
at iteration: 15 the root lies between 1.309783935546875 and
1.309814453125
at iteration: 16 the root lies between 1.3097991943359375 and
1.309814453125
at iteration: 17 the root lies between 1.3097991943359375 and
1.3098068237304688
at iteration: 18 the root lies between 1.3097991943359375 and
1.3098030090332031
at iteration: 19 the root lies between 1.3097991943359375 and
1.3098011016845703
at iteration: 20 the root lies between 1.3097991943359375 and
1.309800148010254
at iteration: 21 the root lies between 1.3097991943359375 and
1.3097996711730957
at iteration: 22 the root lies between 1.3097994327545166 and
1.3097996711730957
at iteration: 23 the root lies between 1.3097995519638062 and
1.3097996711730957
at iteration: 24 the root lies between 1.3097995519638062 and
1.309799611568451
at iteration: 25 the root lies between 1.3097995817661285 and
1.309799611568451
at iteration: 26 the root lies between 1.3097995817661285 and
1.3097995966672897
at iteration: 27 the root lies between 1.3097995817661285 and
1.3097995892167091
at iteration: 28 the root lies between 1.3097995854914188 and
1.3097995892167091
at iteration: 29 the root lies between 1.3097995854914188 and
1.309799587354064
at iteration: 30 the root lies between 1.3097995854914188 and
1.3097995864227414
</pre></div>
</div>
<p>The bisection method will not work if the function just touches the horizontal
axis. The <strong>Newton-Raphson</strong> method, however, will still work in that case. More
comprehensive root finding algorithms will first use some sort of bracketing
algorithm to get into a neighborhood of the root point and then switch over to
a Newton-Raphson type method to then quickly converge to this root point.</p>
</div>
</div>
<div class="section" id="using-built-in-unit-root-function">
<h2>14.5. Using built in unit-root function<a class="headerlink" href="#using-built-in-unit-root-function" title="Permalink to this headline">¶</a></h2>
<p>The built in functions are part of the
<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize">scipy.optimize</a> library.
The functions work very similar to the ones that we just wrote ourselves. It
usually requires that we first define our function. We then hand it to the
solver algorithm with a starting guess of the root position.
The first root finding algorithm is called
<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.root.html#scipy.optimize.root">root</a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">root</span>
<span class="n">guess</span> <span class="o">=</span> <span class="mi">2</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot; -------------- Root ------------&quot;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">root</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">guess</span><span class="p">)</span> <span class="c1"># starting from x = 2</span>
<span class="n">myroot</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span>  <span class="c1"># Grab number from result dictionary</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;The root of func is at {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myroot</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre> -------------- Root ------------
The root of func is at [ 1.30979959]
</pre></div>
</div>
<p>The second root finding algorithm is called
<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.root.html#scipy.optimize.fsolve">fsolve</a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fsolve</span>

<span class="n">guess</span> <span class="o">=</span> <span class="mi">2</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot; -------------- Fsolve ------------&quot;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">guess</span><span class="p">)</span> <span class="c1"># starting from x = 2</span>
<span class="n">myroot</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># Grab number from result dictionary</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;The root is at {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre> -------------- Fsolve ------------
The root is at [ 1.30979959]
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Slides_Optimization.html" class="btn btn-neutral float-right" title="15. Optimization" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Slides_Random.html" class="btn btn-neutral" title="13. Random numbers" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Juergen Jung.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>