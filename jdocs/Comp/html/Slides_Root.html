

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>18. Root Finding &mdash; Computational Economics 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="19. Optimization" href="Slides_Optimization_1.html" />
    <link rel="prev" title="17. Random Numbers II: An Infectious Disease Simulation" href="Slides_Random2.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Computational Economics
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Slides_CourseAdministration.html">1. Course Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Basics.html">2. First Steps in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_DataStructures.html">3. Python Data Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Loop.html">4. Basic Programming Techniques</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Debugging.html">5. Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Arrays.html">6. Vectors and Matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Plot.html">7. Plotting using <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Functions.html">8. Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_OOP.html">9. Object Oriented Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Data_1.html">10. Working with Data I: Data Cleaning</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Data_2.html">11. Working with Data II: Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Data_3.html">12. Working with Data III: Case Study</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_WebData.html">13. Working with Data from the Web I</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_WebData_2.html">14. Working with Data from the Web II</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_RegularExpressions.html">15. Regular Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Random.html">16. Random Numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Random2.html">17. Random Numbers II: An Infectious Disease Simulation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">18. Root Finding</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#first-steps">18.1. First Steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="#newton-raphson">18.2. Newton-Raphson</a></li>
<li class="toctree-l2"><a class="reference internal" href="#secant-method">18.3. Secant Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bisection">18.4. Bisection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-built-in-unit-root-function">18.5. Using Built in Unit-Root Function</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Optimization_1.html">19. Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Optimization_2_Cake.html">20. Constrained Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_MachineLearning_1.html">21. Machine Learning I: Introduction to Machine Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_MachineLearning_2.html">22. Machine Learning II: Categorization Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_OLG_I.html">23. A Simple OLG Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_OLG_II.html">24. An OLG Model with Labor-Leisure Choice</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Growth.html">25. Growth Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Assignments.html">26. Assignments</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Computational Economics</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li><span class="section-number">18. </span>Root Finding</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Slides_Root.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="root-finding">
<h1><span class="section-number">18. </span>Root Finding<a class="headerlink" href="#root-finding" title="Permalink to this headline">¶</a></h1>
<div class="sidebar" id="rootfinding">
<p class="sidebar-title">Section Learning Objectives</p>
<blockquote>
<div><ul class="simple">
<li><p>Newthon-Raphson</p></li>
<li><p>Secant Method</p></li>
<li><p>Bisection</p></li>
</ul>
</div></blockquote>
</div>
<p id="index-0">In this chapter we cover how to find the “root” of a function <span class="math notranslate nohighlight">\(f(x)\)</span>.
The root of this function is the value of <span class="math notranslate nohighlight">\(x\)</span> where the function
In other words, we are looking for the value of <span class="math notranslate nohighlight">\(x\)</span> where the function,
if we plotted it, crosses the horizontal x-axis. At this value of <span class="math notranslate nohighlight">\(x\)</span>
the function value is <span class="math notranslate nohighlight">\(f(x) = 0\)</span>.</p>
<div class="section" id="first-steps">
<h2><span class="section-number">18.1. </span>First Steps<a class="headerlink" href="#first-steps" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">time</span>  <span class="c1"># Imports system time module to time your script</span>
<span class="c1">#</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>  <span class="c1"># close all open figures</span>
</pre></div>
</div>
<p>Define am example function for which we calculate the root. Let us use this
function:</p>
<div class="math notranslate nohighlight">
\[f(x) = ln(x) - e^{-x}\]</div>
<p>We first program this function using the <code class="docutils literal notranslate"><span class="pre">def</span></code> keyword in Python. Do not
forget to also load the <code class="docutils literal notranslate"><span class="pre">numpy</span></code> library first.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="c1"># Function: f(x)</span>
    <span class="n">fx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fx</span>
</pre></div>
</div>
<p>We next plot the function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xmin</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">xv</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="p">(</span><span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span><span class="p">)</span><span class="o">/</span><span class="mf">200.0</span><span class="p">)</span>
<span class="n">fxv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xv</span><span class="p">),</span><span class="nb">float</span><span class="p">)</span> <span class="c1"># define column vector</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xv</span><span class="p">)):</span>
    <span class="n">fxv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">f_func</span><span class="p">(</span><span class="n">xv</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">fxv</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xv</span><span class="p">)))</span>
<span class="c1"># Create a title with a red, bold/italic font</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/Slides_Root_FigAutos_1.png"><img alt="_images/Slides_Root_FigAutos_1.png" src="_images/Slides_Root_FigAutos_1.png" style="width: 12cm;" /></a>
<p>We clearly see that the “root” of the function is somewhere near an x of 1.25
to 1.35.</p>
</div>
<div class="section" id="newton-raphson">
<h2><span class="section-number">18.2. </span>Newton-Raphson<a class="headerlink" href="#newton-raphson" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="#fig-newton"><span class="std std-numref">Fig. 18.1</span></a> presents an illustration of the Newton-Raphson algorithm.</p>
<div class="figure align-center" id="fig-newton">
<img alt="_images/InkscapeRootNewton.png" src="_images/InkscapeRootNewton.png" />
<p class="caption"><span class="caption-number">Fig. 18.1 </span><span class="caption-text">The Newton-Raphson Algorithm</span><a class="headerlink" href="#fig-newton" title="Permalink to this image">¶</a></p>
</div>
<p>We start with an initial guess <span class="math notranslate nohighlight">\(x_0\)</span>. The slope of the  tangent line through the
initial guess can be defined as rise <span class="math notranslate nohighlight">\(f(x_0) - 0\)</span> over run <span class="math notranslate nohighlight">\(x_0-x_1\)</span> or:</p>
<div class="math notranslate nohighlight">
\[slope=\frac{f(x_0)-0}{x_0-x_1},\]</div>
<p>where <span class="math notranslate nohighlight">\(x_1\)</span> is the point where the tangent line crosses the x-axis. This
point has coordinates <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(y_1 = 0\)</span>. Our goal is to find the
value of <span class="math notranslate nohighlight">\(x_1\)</span>.</p>
<p>Since this line is a tangent line, we can also write its slope as the
derivative of function <span class="math notranslate nohighlight">\(f\)</span> that is: <span class="math notranslate nohighlight">\(f'(x)\)</span>. We now set the
derivative equal to the expression for the slope:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[f'(x_0) = slope = \frac{f(x_0)-0}{x_0-x_1},\]</div>
</div></blockquote>
<p>which we  can now use to solve for the value of <span class="math notranslate nohighlight">\(x_1\)</span>:</p>
<div class="math notranslate nohighlight">
\[x_1 = x_0 - \frac{f(x_0)}{f'(x_0)}.\]</div>
<p>We next put a tangent line through the value of <span class="math notranslate nohighlight">\(f(x_1)\)</span> and search where
this tangent line crosses the x-axis at point <span class="math notranslate nohighlight">\(x_2\)</span> in
<a class="reference internal" href="#fig-newton"><span class="std std-numref">Fig. 18.1</span></a>. This results in</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[f'(x_1) = slope = \frac{f(x_1)-0}{x_1-x_2},\]</div>
</div></blockquote>
<p>which we  can now use to solve for the value of <span class="math notranslate nohighlight">\(x_2\)</span>:</p>
<div class="math notranslate nohighlight">
\[x_2 = x_1 - \frac{f(x_1)}{f'(x_1)}.\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We can now repeat this successively using the iterative procedure:</p>
<div class="math notranslate nohighlight">
\[\boxed{x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)}}\]</div>
</div>
<p>In order for this function to work well we need to be able to calculate the
derivative of the function around the root point and preferably over the
entire domain of the function.</p>
<p>In the following code we “hand in” a function <code class="docutils literal notranslate"><span class="pre">ftn</span></code> which is a user specified
function. This function needs to return 2! values:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>the functional value <span class="math notranslate nohighlight">\(f(x)\)</span>, and</p></li>
<li><p>the value of the first derivative <span class="math notranslate nohighlight">\(f'(x)\)</span>.</p></li>
</ol>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">newtonraphson</span><span class="p">(</span><span class="n">ftn</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="n">maxiter</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
    <span class="c1"># Newton_Raphson algorithm for solving ftn(x)[1] == 0</span>
    <span class="c1"># we assume that ftn is a function of a single</span>
    <span class="c1"># variable that returns the function value and</span>
    <span class="c1"># the first derivative as a vector of length 2</span>
    <span class="c1">#</span>
    <span class="c1"># x0 is the initial guess at the root</span>
    <span class="c1"># the algorithm terminates when the function</span>
    <span class="c1"># value is within distance tol of 0, or the</span>
    <span class="c1"># number of iterations exceeds maxiter</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span>

    <span class="c1"># Evaluate user supplied function at starting value</span>
    <span class="n">fxv</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">fx</span> <span class="o">=</span> <span class="n">fxv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>   <span class="c1"># function value f(x)</span>
    <span class="n">d_fx</span> <span class="o">=</span> <span class="n">fxv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># derivative value f&#39;(x)</span>

    <span class="n">jiter</span> <span class="o">=</span>  <span class="mi">0</span>

    <span class="c1"># Continue iterating until stopping conditions are met</span>
    <span class="k">while</span> <span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">fx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">jiter</span> <span class="o">&lt;</span> <span class="n">maxiter</span><span class="p">)):</span>

        <span class="c1"># Newton-Raphson iterative formula</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">fx</span><span class="o">/</span><span class="n">d_fx</span>

        <span class="c1"># Update function and derivative value</span>
        <span class="n">fxv</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">fx</span> <span class="o">=</span> <span class="n">fxv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>   <span class="c1"># new function value f(x)</span>
        <span class="n">d_fx</span> <span class="o">=</span> <span class="n">fxv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># new derivative value f&#39;(x)</span>

        <span class="n">jiter</span> <span class="o">=</span>  <span class="n">jiter</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;At iteration: </span><span class="si">{}</span><span class="s2"> the value of x is </span><span class="si">{}</span><span class="s2">:&quot;</span> \
          <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">jiter</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>

    <span class="c1"># Output depends on success of algorithm</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">fx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Algorithm failed to converge&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;fx = &quot;</span><span class="p">,</span> <span class="n">fx</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Algorithm converged&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
<p>In order to implement this method we will need the derivative value
of the function. Calculus to the rescue. Let us take the derivative of our
function. Here is the function:</p>
<div class="math notranslate nohighlight">
\[f(x) = ln(x) - e^{-x}\]</div>
<p>And here is its derivative. Check your calculus books if you forgot how
to do this!</p>
<div class="math notranslate nohighlight">
\[f'(x) = \frac{1}{x} - e^{-x} \times (-1),\]</div>
<p>which can be written as</p>
<div class="math notranslate nohighlight">
\[f'(x) = \frac{1}{x} + e^{-x}\]</div>
<p>So let us define our example function from the beginning of
the chapter again but this time we return both, the functional value and the
value of the first derivate (i.e., the gradient).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_func1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="c1"># Function: f(x)</span>
    <span class="n">fx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>

    <span class="c1"># Derivative of function: f&#39;(x)</span>
    <span class="n">d_fx</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">x</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">fx</span><span class="p">,</span> <span class="n">d_fx</span><span class="p">])</span>
</pre></div>
</div>
<p>We next calculate the root of the function <code class="docutils literal notranslate"><span class="pre">func1</span></code> calling the
<code class="docutils literal notranslate"><span class="pre">newtonraphson</span></code> algorithm.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">myRoot</span> <span class="o">=</span> <span class="n">newtonraphson</span><span class="p">(</span><span class="n">f_func1</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;My Root is at </span><span class="si">{:8.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myRoot</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------------------------------&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">At</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">1</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="n">x</span> <span class="ow">is</span> <span class="mf">1.122019645309717</span><span class="p">:</span>
<span class="n">At</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">2</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="n">x</span> <span class="ow">is</span> <span class="mf">1.2949969704390394</span><span class="p">:</span>
<span class="n">At</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">3</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="n">x</span> <span class="ow">is</span> <span class="mf">1.3097090626648604</span><span class="p">:</span>
<span class="n">At</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">4</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="n">x</span> <span class="ow">is</span> <span class="mf">1.309799582422906</span><span class="p">:</span>
<span class="n">At</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">5</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="n">x</span> <span class="ow">is</span> <span class="mf">1.3097995858041505</span><span class="p">:</span>
<span class="n">fx</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">5.551115123125783e-17</span>
<span class="n">Algorithm</span> <span class="n">converged</span>
<span class="o">--------------------------------</span>
<span class="n">My</span> <span class="n">Root</span> <span class="ow">is</span> <span class="n">at</span>   <span class="mf">1.3098</span>
<span class="o">--------------------------------</span>
</pre></div>
</div>
<p>We can now plot the function again. Using <code class="docutils literal notranslate"><span class="pre">axvline</span></code> we can mark the root of
the function in the graph.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">fxv</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xv</span><span class="p">)),</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">myRoot</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="c1"># Create a title with a red, bold/italic font</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/Slides_Root_FigAutos_1.png"><img alt="_images/Slides_Root_FigAutos_1.png" src="_images/Slides_Root_FigAutos_1.png" style="width: 12cm;" /></a>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The Newton-Raphson algorithm has two shortcomings:</p>
<ol class="arabic simple">
<li><p>It requires that the function is differentiable. For non-differential
functions (i.e., functions with “kinks” or steps) this algorithm will
not work.</p></li>
<li><p>It is sensitive to starting values. If a bad starting value is chosen and
if the function exhibits “flat” spots, the algorithm will not converge.</p></li>
</ol>
</div>
<p><a class="reference internal" href="#fig-newton1"><span class="std std-numref">Fig. 18.2</span></a> presents an illustration of the Newton-Raphson algorithm
when the starting value is chosen far from the root point in the “flat” area of
the function. In this case the tangent line crosses the z-axis at a very
distant point from the root we are looking for and might not converge or only
converge very slowly.</p>
<div class="figure align-center" id="fig-newton1">
<img alt="_images/InkscapeRootNewton1.png" src="_images/InkscapeRootNewton1.png" />
<p class="caption"><span class="caption-number">Fig. 18.2 </span><span class="caption-text">The Newton-Raphson Algorithm with Bad Starting Value</span><a class="headerlink" href="#fig-newton1" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="secant-method">
<h2><span class="section-number">18.3. </span>Secant Method<a class="headerlink" href="#secant-method" title="Permalink to this headline">¶</a></h2>
<p>As pointed out above, in order to use the <strong>Newton-Raphson</strong> method we need to
be able to calculate the derivative <span class="math notranslate nohighlight">\(f'(x)\)</span> of the function. If this is
computationally expensive or maybe even impossible, we can use the <strong>secant</strong>
method which only requires that the function is continuous. That is, it does
not have to be differentiable over its domain.</p>
<p>In this case we start with two starting values or initial guesses,
<span class="math notranslate nohighlight">\(x_0\)</span> and <span class="math notranslate nohighlight">\(x_1\)</span> and
put a line through the functional values <span class="math notranslate nohighlight">\(f(x_0)\)</span> and <span class="math notranslate nohighlight">\(f(x_1)\)</span>. The
advantage of this method is that we do not have to calculate the first
derivative of the function.</p>
<p><a class="reference internal" href="#fig-secant"><span class="std std-numref">Fig. 18.3</span></a> presents an illustration of the Secant method. The green
line is formed using the functional values of the two starting guesses
,:math:<cite>x_0</cite> and <span class="math notranslate nohighlight">\(x_1\)</span>. The closer the two starting values are to each
other the more the green secant (line) will resemble the tangent line in
<a class="reference internal" href="#fig-newton"><span class="std std-numref">Fig. 18.1</span></a> that was used in the Newton-Raphson algorithm above.</p>
<div class="figure align-center" id="fig-secant">
<img alt="_images/InkscapeRootSecant.png" src="_images/InkscapeRootSecant.png" />
<p class="caption"><span class="caption-number">Fig. 18.3 </span><span class="caption-text">The Secant Algorithm</span><a class="headerlink" href="#fig-secant" title="Permalink to this image">¶</a></p>
</div>
<p>The algorithm then proceeds in finding point <span class="math notranslate nohighlight">\(x_2\)</span> where the green secant
crosses the x-axis. The slope of the secant line can be calculated in two ways
using the rise-over-run method. We can first express the slope as:</p>
<div class="math notranslate nohighlight">
\[\text{slope} = \frac{f(x_0)-f(x_1)}{x_0-x_1}\]</div>
<p>And similarly we can use a second triangle (rise over run)  and express the slope as:</p>
<div class="math notranslate nohighlight">
\[\text{slope} = \frac{f(x_1)- 0}{x_1-x_2}\]</div>
<p>We can now set the two expressions equal to each other</p>
<div class="math notranslate nohighlight">
\[\frac{f(x_0)-f(x_1)}{x_0-x_1} = \text{slope} = \frac{f(x_1)- 0}{x_1-x_2}\]</div>
<p>and since we have <span class="math notranslate nohighlight">\(x_0,x_1,f(x_0),\)</span> and <span class="math notranslate nohighlight">\(f(x_1)\)</span> we can solve for
<span class="math notranslate nohighlight">\(x_2\)</span>.</p>
<div class="math notranslate nohighlight">
\[x_2 = x_1 - f(x_1)\frac{x_0-x_1}{f(x_0)-f(x_1)}.\]</div>
<p>The iterative procedure can be written as:</p>
<div class="math notranslate nohighlight">
\[\boxed{x_{n+1} = x_n - f(x_n)\frac{x_{n-1}-x_n}{f(x_{n-1})-f(x_n)}}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Keep in mind that if <span class="math notranslate nohighlight">\(x_0\)</span> and <span class="math notranslate nohighlight">\(x_1\)</span> are close together then:</p>
<div class="math notranslate nohighlight">
\[f'(x_n) \approx \frac{f(x_n)-f(x_{n-1})}{x_n-x_{n-1}}.\]</div>
</div>
<p>So that the Secant method is really an approximation of the Newton-Raphson
method, where we substitute <span class="math notranslate nohighlight">\(\frac{f(x_n)-f(x_{n-1})}{x_n-x_{n-1}}\)</span> for
<span class="math notranslate nohighlight">\(f'(x)\)</span>.</p>
<p>In this sense we can also write the iterative procedure of the Secant method
as:</p>
<div class="math notranslate nohighlight">
\[\boxed{x_{n+1} = x_n - \frac{f(x_n)}{\frac{f(x_{n-1})-f(x_n)}{x_{n-1}-x_n}}}\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">secant</span><span class="p">(</span><span class="n">ftn</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="n">maxiter</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
    <span class="c1"># Secant algorithm for solving ftn(x) == 0</span>
    <span class="c1"># we assume that ftn is a function of a</span>
    <span class="c1"># single variable that returns the function value</span>
    <span class="c1">#</span>
    <span class="c1"># x0 and x1 are the initial guesses around the root</span>
    <span class="c1"># the algorithm terminates when the function</span>
    <span class="c1"># value is within distance</span>
    <span class="c1"># tol of 0, or the number of iterations exceeds max.iter</span>

    <span class="n">fx0</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
    <span class="n">fx1</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
    <span class="n">jiter</span> <span class="o">=</span>  <span class="mi">0</span>

    <span class="c1"># continue iterating until stopping conditions are met</span>
    <span class="k">while</span> <span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">fx1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">jiter</span> <span class="o">&lt;</span> <span class="n">maxiter</span><span class="p">)):</span>
        <span class="n">x</span>  <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">fx1</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">fx1</span> <span class="o">-</span> <span class="n">fx0</span><span class="p">)</span>
        <span class="n">fx0</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
        <span class="n">fx1</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x0</span>  <span class="o">=</span> <span class="n">x1</span>
        <span class="n">x1</span>  <span class="o">=</span> <span class="n">x</span>
        <span class="n">jiter</span> <span class="o">=</span>  <span class="n">jiter</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;At iteration: </span><span class="si">{}</span><span class="s2"> the value of x is: </span><span class="si">{}</span><span class="s2">&quot;</span> \
          <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">jiter</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>

    <span class="c1"># output depends on success of algorithm</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">fx1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Algorithm failed to converge&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
       <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Algorithm converged&quot;</span><span class="p">)</span>
       <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
<p>We next calculate the root point using the secant method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">myRoot</span> <span class="o">=</span> <span class="n">secant</span><span class="p">(</span><span class="n">f_func</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;My Root is at </span><span class="si">{:8.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myRoot</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------------------------------&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">At</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">1</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="n">x</span> <span class="ow">is</span><span class="p">:</span> <span class="mf">1.3974104821696125</span>
<span class="n">At</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">2</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="n">x</span> <span class="ow">is</span><span class="p">:</span> <span class="mf">1.2854761201506528</span>
<span class="n">At</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">3</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="n">x</span> <span class="ow">is</span><span class="p">:</span> <span class="mf">1.310676758082541</span>
<span class="n">At</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">4</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="n">x</span> <span class="ow">is</span><span class="p">:</span> <span class="mf">1.3098083980193003</span>
<span class="n">At</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">5</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="n">x</span> <span class="ow">is</span><span class="p">:</span> <span class="mf">1.3097995826147546</span>
<span class="n">At</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">6</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="n">x</span> <span class="ow">is</span><span class="p">:</span> <span class="mf">1.309799585804162</span>
<span class="n">Algorithm</span> <span class="n">converged</span>
<span class="o">--------------------------------</span>
<span class="n">My</span> <span class="n">Root</span> <span class="ow">is</span> <span class="n">at</span>   <span class="mf">1.3098</span>
<span class="o">--------------------------------</span>
</pre></div>
</div>
</div>
<div class="section" id="bisection">
<h2><span class="section-number">18.4. </span>Bisection<a class="headerlink" href="#bisection" title="Permalink to this headline">¶</a></h2>
<p>The <strong>Newton-Raphson</strong> as well as the <strong>Secant</strong> method are not guaranteed to
work. The bisection method is the most robust method, but it is slow. We start with
two values <span class="math notranslate nohighlight">\(x_l &lt; x_r\)</span> which bracket the root of the function. It
therefore must hold that <span class="math notranslate nohighlight">\(f(x_l) \times f(x_r) &lt; 0\)</span>. The algorithm then
repeatedly brackets around the root in the following systematic way:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>if <span class="math notranslate nohighlight">\(x_r - x_l \le \epsilon\)</span> then stop</p></li>
<li><p>calculate midpoint: <span class="math notranslate nohighlight">\(x_m = (x_l+x_r)/2\)</span></p></li>
<li><p>if <span class="math notranslate nohighlight">\(f(x_m)==0\)</span> stop</p></li>
<li><p>if <span class="math notranslate nohighlight">\(f(x_l) \times  f(x_m) &lt; 0\)</span> then set <span class="math notranslate nohighlight">\(x_r = x_m\)</span> otherwise <span class="math notranslate nohighlight">\(x_l=x_m\)</span></p></li>
<li><p>go back to step 1</p></li>
</ol>
</div>
<p><a class="reference internal" href="#fig-bisection"><span class="std std-numref">Fig. 18.4</span></a> demonstrates the Bisection algorithm. In the figure we
demonstrate the first case in step 4 above, where <span class="math notranslate nohighlight">\(f(x_l) \times  f(x_m)
&lt; 0\)</span> so that we move the right bracket inwards.</p>
<div class="figure align-center" id="fig-bisection">
<img alt="_images/InkscapeRootBisection.png" src="_images/InkscapeRootBisection.png" />
<p class="caption"><span class="caption-number">Fig. 18.4 </span><span class="caption-text">The Bisection Algorithm</span><a class="headerlink" href="#fig-bisection" title="Permalink to this image">¶</a></p>
</div>
<p>Here is the algorithm of the Bisection method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bisection</span><span class="p">(</span><span class="n">ftn</span><span class="p">,</span> <span class="n">xl</span><span class="p">,</span> <span class="n">xr</span><span class="p">,</span> <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-9</span><span class="p">):</span>
    <span class="c1"># applies the bisection algorithm to find x</span>
    <span class="c1"># such that ftn(x) == 0</span>
    <span class="c1"># we assume that ftn is a function of a single variable</span>
    <span class="c1">#</span>
    <span class="c1"># x.l and x.r must bracket the fixed point, that is</span>
    <span class="c1"># x.l &lt; x.r and ftn(x.l) * ftn(x.r) &lt; 0</span>
    <span class="c1">#</span>
    <span class="c1"># the algorithm iteratively refines</span>
    <span class="c1"># x.l and x.r and terminates when</span>
    <span class="c1"># x.r - x.l &lt;= tol</span>

    <span class="c1"># check inputs</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">xl</span> <span class="o">&gt;=</span> <span class="n">xr</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error: xl &gt;= xr&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">fl</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">xl</span><span class="p">)</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">xr</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">fl</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">xl</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">fr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">xr</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">fl</span> <span class="o">*</span> <span class="n">fr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error: ftn(xl) * ftn(xr) &gt; 0&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="c1"># successively refine x.l and x.r</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="p">((</span><span class="n">xr</span> <span class="o">-</span> <span class="n">xl</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">):</span>
        <span class="n">xm</span> <span class="o">=</span> <span class="p">(</span><span class="n">xl</span> <span class="o">+</span> <span class="n">xr</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
        <span class="n">fm</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">xm</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">fm</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">fm</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">fl</span> <span class="o">*</span> <span class="n">fm</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">xr</span> <span class="o">=</span> <span class="n">xm</span>
            <span class="n">fr</span> <span class="o">=</span> <span class="n">fm</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xl</span> <span class="o">=</span> <span class="n">xm</span>
            <span class="n">fl</span> <span class="o">=</span> <span class="n">fm</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;at iteration: </span><span class="si">{}</span><span class="s2"> the root lies between </span><span class="si">{}</span><span class="s2"> and </span><span class="si">{}</span><span class="s2">&quot;</span> \
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">xl</span><span class="p">,</span> <span class="n">xr</span><span class="p">))</span>
    <span class="c1"># return (approximate) root</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">xl</span> <span class="o">+</span> <span class="n">xr</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
</pre></div>
</div>
<p>We next calculate the root of the function calling ‘bisection’ method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">myRoot</span> <span class="o">=</span> <span class="n">bisection</span><span class="p">(</span><span class="n">f_func</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;My Root is at </span><span class="si">{:8.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myRoot</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------------------------------&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">1</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mi">1</span> <span class="ow">and</span> <span class="mf">1.5</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">2</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.25</span> <span class="ow">and</span> <span class="mf">1.5</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">3</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.25</span> <span class="ow">and</span> <span class="mf">1.375</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">4</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.25</span> <span class="ow">and</span> <span class="mf">1.3125</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">5</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.28125</span> <span class="ow">and</span> <span class="mf">1.3125</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">6</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.296875</span> <span class="ow">and</span> <span class="mf">1.3125</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">7</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.3046875</span> <span class="ow">and</span> <span class="mf">1.3125</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">8</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.30859375</span> <span class="ow">and</span> <span class="mf">1.3125</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">9</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.30859375</span> <span class="ow">and</span> <span class="mf">1.310546875</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">10</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.3095703125</span> <span class="ow">and</span> <span class="mf">1.310546875</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">11</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.3095703125</span> <span class="ow">and</span> <span class="mf">1.31005859375</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">12</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.3095703125</span> <span class="ow">and</span> <span class="mf">1.309814453125</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">13</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.3096923828125</span> <span class="ow">and</span>
<span class="mf">1.309814453125</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">14</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.30975341796875</span> <span class="ow">and</span>
<span class="mf">1.309814453125</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">15</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.309783935546875</span> <span class="ow">and</span>
<span class="mf">1.309814453125</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">16</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.3097991943359375</span> <span class="ow">and</span>
<span class="mf">1.309814453125</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">17</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.3097991943359375</span> <span class="ow">and</span>
<span class="mf">1.3098068237304688</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">18</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.3097991943359375</span> <span class="ow">and</span>
<span class="mf">1.3098030090332031</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">19</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.3097991943359375</span> <span class="ow">and</span>
<span class="mf">1.3098011016845703</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">20</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.3097991943359375</span> <span class="ow">and</span>
<span class="mf">1.309800148010254</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">21</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.3097991943359375</span> <span class="ow">and</span>
<span class="mf">1.3097996711730957</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">22</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.3097994327545166</span> <span class="ow">and</span>
<span class="mf">1.3097996711730957</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">23</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.3097995519638062</span> <span class="ow">and</span>
<span class="mf">1.3097996711730957</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">24</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.3097995519638062</span> <span class="ow">and</span>
<span class="mf">1.309799611568451</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">25</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.3097995817661285</span> <span class="ow">and</span>
<span class="mf">1.309799611568451</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">26</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.3097995817661285</span> <span class="ow">and</span>
<span class="mf">1.3097995966672897</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">27</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.3097995817661285</span> <span class="ow">and</span>
<span class="mf">1.3097995892167091</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">28</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.3097995854914188</span> <span class="ow">and</span>
<span class="mf">1.3097995892167091</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">29</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.3097995854914188</span> <span class="ow">and</span>
<span class="mf">1.309799587354064</span>
<span class="n">at</span> <span class="n">iteration</span><span class="p">:</span> <span class="mi">30</span> <span class="n">the</span> <span class="n">root</span> <span class="n">lies</span> <span class="n">between</span> <span class="mf">1.3097995854914188</span> <span class="ow">and</span>
<span class="mf">1.3097995864227414</span>
<span class="o">--------------------------------</span>
<span class="n">My</span> <span class="n">Root</span> <span class="ow">is</span> <span class="n">at</span>   <span class="mf">1.3098</span>
<span class="o">--------------------------------</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The bisection method will not work if the function just touches the horizontal
axis. The <strong>Newton-Raphson</strong> method, however, will still work in that case.</p>
</div>
<p>More comprehensive root finding algorithms will first use some sort of
bracketing algorithm to get into a neighborhood of the root point and then
switch over to a Newton-Raphson type method to then quickly converge to this
root point.</p>
</div>
<div class="section" id="using-built-in-unit-root-function">
<h2><span class="section-number">18.5. </span>Using Built in Unit-Root Function<a class="headerlink" href="#using-built-in-unit-root-function" title="Permalink to this headline">¶</a></h2>
<p>The built in functions are part of the
<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize">scipy.optimize</a> library.
The functions work very similar to the ones that we just wrote ourselves.</p>
<p>It usually requires that we first define our function. We then hand it to the
solver algorithm with a starting guess of the root position.</p>
<p>The first root finding algorithm is called
<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.root.html#scipy.optimize.root">root</a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">root</span>
<span class="n">guess</span> <span class="o">=</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; -------------- Root ------------&quot;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">root</span><span class="p">(</span><span class="n">f_func</span><span class="p">,</span> <span class="n">guess</span><span class="p">)</span> <span class="c1"># starting from x = 2</span>
<span class="n">myroot</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span>  <span class="c1"># Grab number from result dictionary</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The root of func is at </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myroot</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="o">--------------</span> <span class="n">Root</span> <span class="o">------------</span>
<span class="n">The</span> <span class="n">root</span> <span class="n">of</span> <span class="n">func</span> <span class="ow">is</span> <span class="n">at</span> <span class="p">[</span><span class="mf">1.30979959</span><span class="p">]</span>
</pre></div>
</div>
<p>The second root finding algorithm is called
<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.root.html#scipy.optimize.fsolve">fsolve</a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fsolve</span>

<span class="n">guess</span> <span class="o">=</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; -------------- Fsolve ------------&quot;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">f_func</span><span class="p">,</span> <span class="n">guess</span><span class="p">)</span> <span class="c1"># starting from x = 2</span>
<span class="n">myroot</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># Grab number from result dictionary</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The root is at </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="o">--------------</span> <span class="n">Fsolve</span> <span class="o">------------</span>
<span class="n">The</span> <span class="n">root</span> <span class="ow">is</span> <span class="n">at</span> <span class="p">[</span><span class="mf">1.30979959</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Slides_Optimization_1.html" class="btn btn-neutral float-right" title="19. Optimization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Slides_Random2.html" class="btn btn-neutral float-left" title="17. Random Numbers II: An Infectious Disease Simulation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Juergen Jung

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>