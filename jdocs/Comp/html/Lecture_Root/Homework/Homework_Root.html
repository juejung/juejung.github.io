<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>## Exercise 1 &mdash; ComputationalEconomicsLectures 1.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="ComputationalEconomicsLectures 1.0 documentation" href="../../index.html" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="../../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head>
  <body>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="../../index.html">ComputationalEconomicsLectures 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <p># Homework 8: Root finding</p>
<p>Submit this homework in class on Tuesday.
I need two files:</p>
<blockquote>
<div><ul class="simple">
<li>R-scripts are submitted in one file called: <tt class="docutils literal"><span class="pre">Homework8.R</span></tt></li>
<li>Python-scripts are submitted in one file called: <tt class="docutils literal"><span class="pre">Homework8.py</span></tt></li>
</ul>
</div></blockquote>
<p>I need to be able to quickly run these scripts on my computer.</p>
<p>I will based your homework grade on my grading of 2 randomly selected homework exercises. So please make sure that you complete every homework 100% as you might otherwise end up with zero points.</p>
<p>Implement all exercises in <strong>R</strong> and <strong>Python</strong>!</p>
<div class="section" id="exercise-1">
<h1>## Exercise 1<a class="headerlink" href="#exercise-1" title="Permalink to this headline">¶</a></h1>
<dl class="docutils">
<dt>Read chapter 10 in your <strong>R</strong> book. Then implement exercise 5, in section 10.6. This exercise asks you to use the <strong>R</strong> code below to calculate the roots of the following functions using $x_0$ as starting value for the root search algorithm:</dt>
<dd><ol class="first last arabic simple">
<li>$cos(x) - x$ using $x_0 = 1, 3, 6$</li>
<li>$log(x) - exp(-x)$ using $x_0 = 2$</li>
<li>$x^3 - x - 3$ using $x_0 = 0$</li>
<li>$x^3 - 7x^2 + 14x - 8$ using $x_0 = 1.1, 1.2, . . . , 1.9$</li>
<li>$log(x) times exp(-x)$ using $x_0 = 2$</li>
</ol>
</dd>
</dl>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a>`
newtonraphson_show &lt;- function(ftn, x0, xmin = x0-1, xmax = x0+1) {</p>
<blockquote>
<div><p># applies Newton-Raphson to find x such that ftn(x)[1] == 0
# x0 is the starting point
# subsequent iterations are plotted in the range [xmin, xmax]</p>
<p># plot the function
x &lt;- seq(xmin, xmax, (xmax - xmin)/200)
fx &lt;- c()
for (i in 1:length(x)) {</p>
<blockquote>
<div>fx[i] &lt;- ftn(x[i])[1]</div></blockquote>
<p>}
plot(x, fx, type = &#8220;l&#8221;, xlab = &#8220;x&#8221;, ylab = &#8220;f(x)&#8221;,
main = &#8220;zero f(x) = 0&#8221;, col = &#8220;blue&#8221;, lwd = 2)
lines(c(xmin, xmax), c(0, 0), col = &#8220;blue&#8221;)
# do first iteration
xold &lt;- x0
f.xold &lt;- ftn(xold)
xnew &lt;- xold - f.xold[1]/f.xold[2]
lines(c(xold, xold, xnew), c(0, f.xold[1], 0), col = &#8220;red&#8221;)
# continue iterating while user types &#8220;y&#8221;
cat(&#8220;last x value&#8221;, xnew, &#8221; &#8221;)
continue &lt;- readline(&#8220;continue (y or n)? &#8221;) == &#8220;y&#8221;
while (continue) {</p>
<blockquote>
<div>xold &lt;- xnew;
f.xold &lt;- ftn(xold)
xnew &lt;- xold - f.xold[1]/f.xold[2]
lines(c(xold, xold, xnew), c(0, f.xold[1], 0), col = &#8220;red&#8221;)
cat(&#8220;last x value&#8221;, xnew, &#8221; &#8221;)
continue &lt;- readline(&#8220;continue (y or n)? &#8221;) == &#8220;y&#8221;</div></blockquote>
<p>}
return(xnew)</p>
</div></blockquote>
<div class="section" id="id3">
<h2>}<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
</div>
</div>
<div class="section" id="exercise-2">
<h1>## Exercise 2<a class="headerlink" href="#exercise-2" title="Permalink to this headline">¶</a></h1>
<dl class="docutils">
<dt>How do we know $pi = 3.1415926$ (to 7 decimal places)? One way of finding $pi$ is to solve sin(x) = 0. By definition the solutions to sin(x) = 0 are $k times pi$ for $k = 0, pm 1, pm 2, dots$, so the root closest to 3 should be $pi$.</dt>
<dd><blockquote class="first">
<div><ol class="arabic simple">
<li>Use a root-finding algorithm, such as the Newton-Raphson algorithm, to find the root of sin(x) near 3. How close can you get to $pi$? (You may use the function sin(x) provided by R.)</li>
<li>The function sin(x) is transcendental, which means that it cannot be written as a rational function of x. Instead we have to write it as an infinite sum:</li>
</ol>
</div></blockquote>
<p>$$  sin(x) = sum_{k=0}^{infty} {(-1) k frac{x^{2k+1}}{(2k + 1)!}} $$</p>
<p>(This is the infinite order Taylor expansion of sin(x) about 0.) In practice, to calculate sin(x) numerically we have to truncate this sum, so any numerical calculation of sin(x) is an approximation. In particular the function <tt class="docutils literal"><span class="pre">sin(x)</span></tt> provided by R is only an approximation of sin(x) (though a very good one). Put</p>
<blockquote class="last">
<div><p>$$ f_n(x)= sum_{k=0}^{n}{(-1) k frac{x^{2k+1}}{(2k + 1)!}} $$</p>
<p>Write a function in R to calculate $f_n(x)$. Plot $f_n(x)$ over the range [0, 7] for a number of values of n, and verify that it looks like sin(x) for large n.
3. Choose a large value of n, then find an approximation to $pi$  by solving $f_n(x) = 0$ near 3. Can you get an approximation that is correct up to 6 decimal places? Can you think of a better way of calculating $pi$?</p>
</div></blockquote>
</dd>
</dl>
</div>
<div class="section" id="exercise-3">
<h1>## Exercise 3<a class="headerlink" href="#exercise-3" title="Permalink to this headline">¶</a></h1>
<p>The bisection method can be generalised to deal with the case $f(xl)f(xr) &gt; 0$, by broadening the bracket. That is, we reduce xl and/or increase xr , and try again. A reasonable choice for broadening the bracket is to double the width of the interval [xl,xr], that is (in pseudo-code):
<tt class="docutils literal"><span class="pre">`</span>
<span class="pre">m</span> <span class="pre">=</span> <span class="pre">(xl</span> <span class="pre">+</span> <span class="pre">xr</span> <span class="pre">)/2</span>
<span class="pre">w</span> <span class="pre">=</span> <span class="pre">xr</span> <span class="pre">-</span> <span class="pre">xl</span>
<span class="pre">xl</span> <span class="pre">=</span> <span class="pre">m</span> <span class="pre">-</span> <span class="pre">w</span>
<span class="pre">xr</span> <span class="pre">=</span> <span class="pre">m</span> <span class="pre">+</span> <span class="pre">w</span>
<span class="pre">`</span></tt>
Incorporate bracket broadening into the function bisection given in the lecture. Note that broadening is not guaranteed to find xl and xr such that $f(xl)f(xr)&lt;= 0$, so you should include a limit on the number of times it can be tried.  Use your modified function to find a root of</p>
<p>$$f(x) = (x - 1)^3 - 2x^2 + 10 - sin(x),$$</p>
<p>starting with xl = 1 and xr = 2.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">## Exercise 1</a><ul>
<li><a class="reference internal" href="#id3">}</a></li>
</ul>
</li>
<li><a class="reference internal" href="#exercise-2">## Exercise 2</a></li>
<li><a class="reference internal" href="#exercise-3">## Exercise 3</a></li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li><a href="../../index.html">ComputationalEconomicsLectures 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Juergen Jung.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>