

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>11. Working with Data II: Statistics &mdash; Computational Economics 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="12. Working with Data from the Web I" href="Slides_WebData.html" />
    <link rel="prev" title="10. Working with Data I: Data Cleaning" href="Slides_Data_1.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Computational Economics
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Slides_CourseAdministration.html">1. Course Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Basics.html">2. First Steps in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_DataStructures.html">3. Python Data Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Loop.html">4. Basic Programming Techniques</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Debugging.html">5. Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Arrays.html">6. Vectors and Matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Plot.html">7. Plotting using <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Functions.html">8. Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_OOP.html">9. Object Oriented Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Data_1.html">10. Working with Data I: Data Cleaning</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">11. Working with Data II: Statistics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#importing-data">11.1. Importing Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#making-simple-graphs-from-our-data">11.2. Making Simple Graphs from our Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#bar-charts">11.2.1. Bar Charts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pie-charts">11.2.2. Pie Charts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#histograms">11.2.3. Histograms</a></li>
<li class="toctree-l3"><a class="reference internal" href="#boxplots">11.2.4. Boxplots</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#summary-statistics">11.3. Summary Statistics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#measures-of-central-tendency">11.3.1. Measures of Central Tendency</a></li>
<li class="toctree-l3"><a class="reference internal" href="#measures-of-dispersion">11.3.2. Measures of Dispersion</a></li>
<li class="toctree-l3"><a class="reference internal" href="#measures-of-relative-standing">11.3.3. Measures of Relative Standing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data-aggregation-or-summary-statistics-by-subgroup">11.3.4. Data Aggregation or Summary Statistics by Subgroup</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#measures-of-linear-relationship">11.4. Measures of Linear Relationship</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#covariance">11.4.1. Covariance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#correlation-coefficient">11.4.2. Correlation Coefficient</a></li>
<li class="toctree-l3"><a class="reference internal" href="#regression-line">11.4.3. Regression Line</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#measures-of-non-linear-relationship">11.5. Measures of Non-Linear Relationship</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#logit">11.5.1. Logit</a></li>
<li class="toctree-l3"><a class="reference internal" href="#probit">11.5.2. Probit</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tutorials">11.6. Tutorials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_WebData.html">12. Working with Data from the Web I</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_WebData_2.html">13. Working with Data from the Web II</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_RegularExpressions.html">14. Regular Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Random.html">15. Random Numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Root.html">16. Root Finding</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Optimization.html">17. Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Cake.html">18. Constrained Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_MachineLearning_1.html">19. Machine Learning I: Introduction to Machine Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_OLG_I.html">20. A Simple OLG Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_OLG_II.html">21. An OLG Model with Labor-Leisure Choice</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Growth.html">22. Growth Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Assignments.html">23. Assignments</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Computational Economics</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li><span class="section-number">11. </span>Working with Data II: Statistics</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Slides_Data_2.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="working-with-data-ii-statistics">
<h1><span class="section-number">11. </span>Working with Data II: Statistics<a class="headerlink" href="#working-with-data-ii-statistics" title="Permalink to this headline">¶</a></h1>
<div class="sidebar" id="dataii">
<p class="sidebar-title">Section Learning Objectives</p>
<blockquote>
<div><ul class="simple">
<li><p>Graphs from Data</p></li>
<li><p>Summary Statistics</p></li>
<li><p>Measures of Linear Relationship</p></li>
</ul>
</div></blockquote>
</div>
<p id="index-0">In this chapter we introduce summary statistics and statistical graphing
methods using the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> and the <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> library.</p>
<div class="section" id="importing-data">
<h2><span class="section-number">11.1. </span>Importing Data<a class="headerlink" href="#importing-data" title="Permalink to this headline">¶</a></h2>
<p>We will be working with three data sets.
<a class="reference download internal" download="" href="_downloads/66ad2a5fc21a463e267163745790f8d3/Lecture_Data_Excel_a.csv"><code class="xref download docutils literal notranslate"><span class="pre">Lecture_Data_Excel_a.csv</span></code></a>.
<a class="reference download internal" download="" href="_downloads/0f0e88a6abe1e41cee4da4aa4d6fa612/Lecture_Data_Excel_b.csv"><code class="xref download docutils literal notranslate"><span class="pre">Lecture_Data_Excel_b.csv</span></code></a>.
<a class="reference download internal" download="" href="_downloads/875f6f90d89cd646995b259ab44a86ae/Lecture_Data_Excel_c.xlsx"><code class="xref download docutils literal notranslate"><span class="pre">Lecture_Data_Excel_c.xlsx</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="c1">#from ggplot import *</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span> <span class="k">as</span> <span class="n">st</span>
<span class="kn">import</span> <span class="nn">math</span> <span class="k">as</span> <span class="nn">m</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">time</span>  <span class="c1"># Imports system time module to time your script</span>

<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>  <span class="c1"># close all open figures</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span>
<span class="n">packages</span>\<span class="n">statsmodels</span>\<span class="n">compat</span>\<span class="n">pandas</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">56</span><span class="p">:</span> <span class="ne">FutureWarning</span><span class="p">:</span> <span class="n">The</span>
<span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">datetools</span> <span class="n">module</span> <span class="ow">is</span> <span class="n">deprecated</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="ow">in</span> <span class="n">a</span>
<span class="n">future</span> <span class="n">version</span><span class="o">.</span> <span class="n">Please</span> <span class="n">use</span> <span class="n">the</span> <span class="n">pandas</span><span class="o">.</span><span class="n">tseries</span> <span class="n">module</span> <span class="n">instead</span><span class="o">.</span>
  <span class="kn">from</span> <span class="nn">pandas.core</span> <span class="kn">import</span> <span class="n">datetools</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in small data from .csv file</span>
<span class="c1"># Filepath</span>
<span class="n">filepath</span> <span class="o">=</span> <span class="s1">&#39;Lecture_Data/&#39;</span>
<span class="c1"># In windows you can also specify the absolute path to your data file</span>
<span class="c1"># filepath = &#39;C:/Dropbox/Towson/Teaching/3_ComputationalEconomics/Lectures/Lecture_Data/&#39;</span>

<span class="c1"># ------------- Load data --------------------</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filepath</span> <span class="o">+</span> <span class="s1">&#39;Lecture_Data_Excel_a.csv&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Frequency&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">})</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Unnamed: 2&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Unnamed: 3&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Make new column with relative frequency</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;relFrequency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="c1"># Let&#39;s have a look at it, it&#39;s a nested list</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                 <span class="n">Area</span>  <span class="n">Frequency</span>  <span class="n">relFrequency</span>
<span class="mi">0</span>          <span class="n">Accounting</span>       <span class="mf">73.0</span>      <span class="mf">0.288538</span>
<span class="mi">1</span>             <span class="n">Finance</span>       <span class="mf">52.0</span>      <span class="mf">0.205534</span>
<span class="mi">2</span>  <span class="n">General</span> <span class="n">management</span>       <span class="mf">36.0</span>      <span class="mf">0.142292</span>
<span class="mi">3</span>     <span class="n">Marketing</span> <span class="n">sales</span>       <span class="mf">64.0</span>      <span class="mf">0.252964</span>
<span class="mi">4</span>               <span class="n">other</span>       <span class="mf">28.0</span>      <span class="mf">0.110672</span>
</pre></div>
</div>
<p>Now we grab the relative frequencies out of the DataFrame into a numpy array.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xv</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;relFrequency&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Array xv is:&#39;</span><span class="p">,</span> <span class="n">xv</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Array</span> <span class="n">xv</span> <span class="ow">is</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.28853755</span> <span class="mf">0.2055336</span>  <span class="mf">0.14229249</span> <span class="mf">0.25296443</span> <span class="mf">0.11067194</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="making-simple-graphs-from-our-data">
<h2><span class="section-number">11.2. </span>Making Simple Graphs from our Data<a class="headerlink" href="#making-simple-graphs-from-our-data" title="Permalink to this headline">¶</a></h2>
<div class="section" id="bar-charts">
<h3><span class="section-number">11.2.1. </span>Bar Charts<a class="headerlink" href="#bar-charts" title="Permalink to this headline">¶</a></h3>
<p>We first make a bar chart of the absolute frequencies.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="c1">#</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xv</span><span class="p">)),</span> <span class="n">xv</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="c1"># Annotate with text</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xv</span><span class="p">)))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">xv</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">val</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Relative Frequency Barchart&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1"># We can also save this graph as a pdf</span>
<span class="c1">#savefig(&#39;./Graphs/fig1.pdf&#39;)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/Slides_Data_2_Barchart_1.png"><img alt="_images/Slides_Data_2_Barchart_1.png" src="_images/Slides_Data_2_Barchart_1.png" style="width: 12cm;" /></a>
<p>This simple command plots the barchart into a window and saves it as
<strong>fig1.pdf</strong> into a subfolder called <code class="docutils literal notranslate"><span class="pre">Graphs</span></code>. Don’t forget to first make
this subfolder, otherwise <code class="docutils literal notranslate"><span class="pre">Python</span></code> will throw an error when it can’t find the
folder.</p>
</div>
<div class="section" id="pie-charts">
<h3><span class="section-number">11.2.2. </span>Pie Charts<a class="headerlink" href="#pie-charts" title="Permalink to this headline">¶</a></h3>
<p>We next make a pie chart using the relative frequencies stored in vector <code class="docutils literal notranslate"><span class="pre">xv</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Annotate with text</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Relative Frequency Pie Chart&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/Slides_Data_2_Piechart_1.png"><img alt="_images/Slides_Data_2_Piechart_1.png" src="_images/Slides_Data_2_Piechart_1.png" style="width: 12cm;" /></a>
</div>
<div class="section" id="histograms">
<h3><span class="section-number">11.2.3. </span>Histograms<a class="headerlink" href="#histograms" title="Permalink to this headline">¶</a></h3>
<p>Next we use a new data file called
<a class="reference download internal" download="" href="_downloads/0f0e88a6abe1e41cee4da4aa4d6fa612/Lecture_Data_Excel_b.csv"><code class="xref download docutils literal notranslate"><span class="pre">Lecture_Data_Excel_b.csv</span></code></a>.
This data file contains data on height age and other variables. We first make a histogram of
the continuous variable Height.
The actual command for the histogram is <code class="docutils literal notranslate"><span class="pre">hist</span></code>. It returns three variables
<code class="docutils literal notranslate"><span class="pre">prob</span></code>, <code class="docutils literal notranslate"><span class="pre">bins</span></code>, and <code class="docutils literal notranslate"><span class="pre">patches</span></code>. We use them in the following to add
information to the histogram.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filepath</span> <span class="o">+</span> <span class="s1">&#39;Lecture_Data_Excel_b.csv&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Response&#39;</span> <span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">Height</span>  <span class="n">AverageMathSAT</span>  <span class="n">Age</span>  <span class="n">Female</span>  <span class="n">Education</span>  <span class="n">Race</span>
<span class="mi">0</span>     <span class="mf">1.1</span>             <span class="mi">370</span>   <span class="mi">20</span>       <span class="mi">0</span>          <span class="mi">2</span>  <span class="n">Hisp</span>
<span class="mi">1</span>     <span class="mf">1.2</span>             <span class="mi">393</span>   <span class="mi">20</span>       <span class="mi">0</span>          <span class="mi">4</span>   <span class="n">Wht</span>
<span class="mi">2</span>     <span class="mf">1.3</span>             <span class="mi">413</span>   <span class="mi">20</span>       <span class="mi">0</span>          <span class="mi">4</span>   <span class="n">Blk</span>
<span class="mi">3</span>     <span class="mf">1.4</span>             <span class="mi">430</span>   <span class="mi">20</span>       <span class="mi">0</span>          <span class="mi">4</span>   <span class="n">Wht</span>
<span class="mi">4</span>     <span class="mf">1.5</span>             <span class="mi">440</span>   <span class="mi">20</span>       <span class="mi">0</span>          <span class="mi">2</span>   <span class="n">Mex</span>
</pre></div>
</div>
<p>We next plot a series of histograms.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">heightv</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Initialize</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">heightv</span><span class="p">)</span> <span class="c1"># number of obs.</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">8</span>           <span class="c1"># number of bins in histogram</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">hspace</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">)</span>

<span class="n">prob</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">heightv</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">B</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;mid&#39;</span> <span class="p">)</span>
<span class="c1"># Annotate with text</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">prob</span><span class="p">):</span>
    <span class="n">percent</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">/</span><span class="n">N</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
    <span class="c1"># only annotate non-zero values</span>
    <span class="k">if</span> <span class="n">percent</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">p</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">percent</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Height groups&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Number of obs&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Histogram of Height&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">heightv</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">heightv</span><span class="p">))</span>

<span class="c1"># Using Panda&#39;s built in histogram method</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span> <span class="o">=</span> <span class="n">B</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Histogram of Height&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Height groups&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Number of obs&#39;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;AverageMathSAT&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span> <span class="o">=</span> <span class="n">B</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Histogram of Math SAT Scores&#39;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/Slides_Data_2_Histogram_1.png"><img alt="_images/Slides_Data_2_Histogram_1.png" src="_images/Slides_Data_2_Histogram_1.png" style="width: 12cm;" /></a>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Another way to graph a histogram is by using the powerful <code class="docutils literal notranslate"><span class="pre">ggplot</span></code> package
which is a translation of <strong>R’s</strong> <a class="reference external" href="http://ggplot2.org/">ggplot2</a> package into <strong>Python</strong>. It
follows a completely different graphing philosophy based on the <strong>grammar of
grapics</strong> by:</p>
<p>Hadley Wickham. A layered grammar of graphics.
Journal of Computational and Graphical Statistics, vol. 19, no. 1, pp. 3–28, 2010.</p>
</div>
<p>After installing the <code class="docutils literal notranslate"><span class="pre">ggplot</span></code> library, you would plot the data as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Height&#39;</span><span class="p">),</span> <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">)</span> <span class="o">+</span> <span class="n">geom_histogram</span><span class="p">()</span> <span class="o">+</span>
<span class="n">ggtitle</span><span class="p">(</span><span class="s2">&quot;Histogram of Height using ggplot&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">labs</span><span class="p">(</span><span class="s2">&quot;Height&quot;</span><span class="p">,</span> <span class="s2">&quot;Freq&quot;</span><span class="p">))</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ggplot</span></code> Python version seems to not be compatible with the
latest version of Python 3.6. You would need to install an older version of
Python if you wanted to use this library as of writing this.</p>
</div>
<p>We can also use the <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> library to make fancy looking histograms
quickly as in <code class="xref std std-numref docutils literal notranslate"><span class="pre">Histogram2</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;AverageMathSAT&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span><span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;G&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-default" id="id1">
<a class="reference internal image-reference" href="_images/Slides_Data_2_Histogram2_1.png"><img alt="_images/Slides_Data_2_Histogram2_1.png" src="_images/Slides_Data_2_Histogram2_1.png" style="width: 12cm;" /></a>
<p class="caption"><span class="caption-number">Fig. 11.1 </span><span class="caption-text">Histogram with Distribution Added</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="boxplots">
<h3><span class="section-number">11.2.4. </span>Boxplots<a class="headerlink" href="#boxplots" title="Permalink to this headline">¶</a></h3>
<p>A boxplot of height is made as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">heightv</span><span class="p">)</span>
<span class="c1"># Annotate with text</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Boxplot of Height&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/Slides_Data_2_Boxplot_1.png"><img alt="_images/Slides_Data_2_Boxplot_1.png" src="_images/Slides_Data_2_Boxplot_1.png" style="width: 12cm;" /></a>
</div>
</div>
<div class="section" id="summary-statistics">
<h2><span class="section-number">11.3. </span>Summary Statistics<a class="headerlink" href="#summary-statistics" title="Permalink to this headline">¶</a></h2>
<p>We next go through some basic summary statistics measures.</p>
<div class="section" id="measures-of-central-tendency">
<h3><span class="section-number">11.3.1. </span>Measures of Central Tendency<a class="headerlink" href="#measures-of-central-tendency" title="Permalink to this headline">¶</a></h3>
<p>A quick way to produce summary statistics of our data set is to use <code class="docutils literal notranslate"><span class="pre">panda's</span></code>
command <code class="docutils literal notranslate"><span class="pre">describe</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>          <span class="n">Height</span>  <span class="n">AverageMathSAT</span>        <span class="n">Age</span>     <span class="n">Female</span>  <span class="n">Education</span>
<span class="n">count</span>  <span class="mf">60.000000</span>       <span class="mf">60.000000</span>  <span class="mf">60.000000</span>  <span class="mf">60.000000</span>  <span class="mf">60.000000</span>
<span class="n">mean</span>    <span class="mf">6.816667</span>      <span class="mf">493.666667</span>  <span class="mf">20.933333</span>   <span class="mf">0.333333</span>   <span class="mf">3.016667</span>
<span class="n">std</span>     <span class="mf">3.571743</span>       <span class="mf">34.018274</span>   <span class="mf">1.176992</span>   <span class="mf">0.475383</span>   <span class="mf">1.096863</span>
<span class="nb">min</span>     <span class="mf">1.100000</span>      <span class="mf">370.000000</span>  <span class="mf">20.000000</span>   <span class="mf">0.000000</span>   <span class="mf">1.000000</span>
<span class="mi">25</span><span class="o">%</span>     <span class="mf">3.950000</span>      <span class="mf">478.500000</span>  <span class="mf">20.000000</span>   <span class="mf">0.000000</span>   <span class="mf">2.000000</span>
<span class="mi">50</span><span class="o">%</span>     <span class="mf">6.850000</span>      <span class="mf">507.000000</span>  <span class="mf">20.000000</span>   <span class="mf">0.000000</span>   <span class="mf">3.000000</span>
<span class="mi">75</span><span class="o">%</span>     <span class="mf">9.650000</span>      <span class="mf">509.250000</span>  <span class="mf">22.000000</span>   <span class="mf">1.000000</span>   <span class="mf">4.000000</span>
<span class="nb">max</span>    <span class="mf">12.700000</span>      <span class="mf">542.000000</span>  <span class="mf">23.000000</span>   <span class="mf">1.000000</span>   <span class="mf">5.000000</span>
</pre></div>
</div>
<p>Or we can produce the same statistics by hand. We first calculate the mean,
median and mode. Note that <code class="docutils literal notranslate"><span class="pre">mode</span></code> is part of the <code class="docutils literal notranslate"><span class="pre">stats</span></code> package which was
imported as <code class="docutils literal notranslate"><span class="pre">st</span></code> using: <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">scipy</span> <span class="pre">import</span> <span class="pre">stats</span> <span class="pre">as</span> <span class="pre">st</span></code>. Now we have to add
<code class="docutils literal notranslate"><span class="pre">st</span></code> to the mode command: <code class="docutils literal notranslate"><span class="pre">st.mode(heightv)</span></code> in order to call it. The other
commands are part of the <code class="docutils literal notranslate"><span class="pre">numpy</span></code> package so they have the prefix <code class="docutils literal notranslate"><span class="pre">np.</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Number of observations (sample size)</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">heightv</span><span class="p">)</span>

<span class="c1"># Mean - Median - Mode</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean(height)=  </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">heightv</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Median(height)=  </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">heightv</span><span class="p">)))</span>

<span class="c1"># Mode (value with highest frequency)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mode(height)=  </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">heightv</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Mean</span><span class="p">(</span><span class="n">height</span><span class="p">)</span><span class="o">=</span>  <span class="mf">6.817</span>
<span class="n">Median</span><span class="p">(</span><span class="n">height</span><span class="p">)</span><span class="o">=</span>  <span class="mf">6.850</span>
<span class="n">Mode</span><span class="p">(</span><span class="n">height</span><span class="p">)</span><span class="o">=</span>  <span class="n">ModeResult</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">array</span><span class="p">([</span><span class="mf">1.1</span><span class="p">]),</span> <span class="n">count</span><span class="o">=</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
<p>We can also just summarize a variable using the <code class="docutils literal notranslate"><span class="pre">st.describe</span></code> command from
the <code class="docutils literal notranslate"><span class="pre">stats</span></code> package.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Summary stats</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Summary Stats&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-------------&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">heightv</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Summary</span> <span class="n">Stats</span>
<span class="o">-------------</span>
<span class="n">DescribeResult</span><span class="p">(</span><span class="n">nobs</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">minmax</span><span class="o">=</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">12.7</span><span class="p">),</span> <span class="n">mean</span><span class="o">=</span><span class="mf">6.8166666666666655</span><span class="p">,</span>
<span class="n">variance</span><span class="o">=</span><span class="mf">12.757344632768362</span><span class="p">,</span> <span class="n">skewness</span><span class="o">=</span><span class="mf">0.019099619781273072</span><span class="p">,</span>
<span class="n">kurtosis</span><span class="o">=-</span><span class="mf">1.1611486008105545</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="measures-of-dispersion">
<h3><span class="section-number">11.3.2. </span>Measures of Dispersion<a class="headerlink" href="#measures-of-dispersion" title="Permalink to this headline">¶</a></h3>
<p>We now calculate the range, variance and standard deviations. Remember that for
variance and standard deviation there is a distinction between population and
sample.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># returns smallest a largest element</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Range = </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">heightv</span><span class="p">)</span><span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="n">heightv</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Population variance = </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span>\

<span class="c1"># population variance</span>
  <span class="nb">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">heightv</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">heightv</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">N</span><span class="p">))</span>

<span class="c1"># sample variance</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sample variance     = </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span>\
  <span class="nb">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">heightv</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">heightv</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pop.   standard dev = </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span>\
  <span class="nb">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">heightv</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">heightv</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">N</span><span class="p">)))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sample standard dev = </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span> \
  <span class="nb">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">heightv</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">heightv</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">))))</span>

<span class="c1">#Or simply</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pop.   standard dev = </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">heightv</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Range</span> <span class="o">=</span> <span class="mf">11.600</span>
<span class="n">Population</span> <span class="n">variance</span> <span class="o">=</span> <span class="mf">12.545</span>
<span class="n">Sample</span> <span class="n">variance</span>     <span class="o">=</span> <span class="mf">12.757</span>
<span class="n">Pop</span><span class="o">.</span>   <span class="n">standard</span> <span class="n">dev</span> <span class="o">=</span> <span class="mf">3.542</span>
<span class="n">Sample</span> <span class="n">standard</span> <span class="n">dev</span> <span class="o">=</span> <span class="mf">3.572</span>
<span class="n">Pop</span><span class="o">.</span>   <span class="n">standard</span> <span class="n">dev</span> <span class="o">=</span> <span class="mf">3.542</span>
</pre></div>
</div>
</div>
<div class="section" id="measures-of-relative-standing">
<h3><span class="section-number">11.3.3. </span>Measures of Relative Standing<a class="headerlink" href="#measures-of-relative-standing" title="Permalink to this headline">¶</a></h3>
<p>Percentiles are calculated as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1 quartile (25th percentile) = </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span>\
  <span class="nb">format</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">scoreatpercentile</span><span class="p">(</span><span class="n">heightv</span><span class="p">,</span> <span class="mi">25</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2 quartile (50th percentile) = </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span>\
  <span class="nb">format</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">scoreatpercentile</span><span class="p">(</span><span class="n">heightv</span><span class="p">,</span> <span class="mi">50</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;3 quartile (75th percentile) = </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span>\
  <span class="nb">format</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">scoreatpercentile</span><span class="p">(</span><span class="n">heightv</span><span class="p">,</span> <span class="mi">75</span><span class="p">)))</span>

<span class="c1"># Inter quartile rante: Q3-Q1 or P_75-P_25</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;IQR = P75 - P25              = </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span>\
  <span class="nb">format</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">scoreatpercentile</span><span class="p">(</span><span class="n">heightv</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>\
  <span class="o">-</span><span class="n">st</span><span class="o">.</span><span class="n">scoreatpercentile</span><span class="p">(</span><span class="n">heightv</span><span class="p">,</span> <span class="mi">25</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="n">quartile</span> <span class="p">(</span><span class="mi">25</span><span class="n">th</span> <span class="n">percentile</span><span class="p">)</span> <span class="o">=</span> <span class="mf">3.950</span>
<span class="mi">2</span> <span class="n">quartile</span> <span class="p">(</span><span class="mi">50</span><span class="n">th</span> <span class="n">percentile</span><span class="p">)</span> <span class="o">=</span> <span class="mf">6.850</span>
<span class="mi">3</span> <span class="n">quartile</span> <span class="p">(</span><span class="mi">75</span><span class="n">th</span> <span class="n">percentile</span><span class="p">)</span> <span class="o">=</span> <span class="mf">9.650</span>
<span class="n">IQR</span> <span class="o">=</span> <span class="n">P75</span> <span class="o">-</span> <span class="n">P25</span>              <span class="o">=</span> <span class="mf">5.700</span>
</pre></div>
</div>
</div>
<div class="section" id="data-aggregation-or-summary-statistics-by-subgroup">
<h3><span class="section-number">11.3.4. </span>Data Aggregation or Summary Statistics by Subgroup<a class="headerlink" href="#data-aggregation-or-summary-statistics-by-subgroup" title="Permalink to this headline">¶</a></h3>
<p>We next want to summarize the data by subgroup. Let’s assume that we would like
to compare the average <code class="docutils literal notranslate"><span class="pre">Height</span></code> by <code class="docutils literal notranslate"><span class="pre">Race</span></code>. We can use the <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> to
accomplish this.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">groupRace</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Race&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Summary by Race&#39;</span><span class="p">,</span> <span class="n">groupRace</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Summary</span> <span class="n">by</span> <span class="n">Race</span>         <span class="n">Height</span>  <span class="n">AverageMathSAT</span>        <span class="n">Age</span>    <span class="n">Female</span>
<span class="n">Education</span>
<span class="n">Race</span>
<span class="n">Blk</span>   <span class="mf">6.278261</span>      <span class="mf">491.652174</span>  <span class="mf">20.826087</span>  <span class="mf">0.304348</span>   <span class="mf">3.565217</span>
<span class="n">Hisp</span>  <span class="mf">6.525000</span>      <span class="mf">472.750000</span>  <span class="mf">21.500000</span>  <span class="mf">0.250000</span>   <span class="mf">1.750000</span>
<span class="n">Mex</span>   <span class="mf">6.171429</span>      <span class="mf">491.571429</span>  <span class="mf">20.928571</span>  <span class="mf">0.285714</span>   <span class="mf">2.428571</span>
<span class="n">Oth</span>   <span class="mf">8.750000</span>      <span class="mf">516.000000</span>  <span class="mf">21.000000</span>  <span class="mf">0.500000</span>   <span class="mf">2.500000</span>
<span class="n">Wht</span>   <span class="mf">7.917647</span>      <span class="mf">500.411765</span>  <span class="mf">20.941176</span>  <span class="mf">0.411765</span>   <span class="mf">3.117647</span>
</pre></div>
</div>
<p>We could also use a different category like gender.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">groupGender</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Female&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Summary by Gender&#39;</span><span class="p">,</span> <span class="n">groupGender</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Summary</span> <span class="n">by</span> <span class="n">Gender</span>         <span class="n">Height</span>  <span class="n">AverageMathSAT</span>   <span class="n">Age</span>  <span class="n">Education</span>
<span class="n">Female</span>
<span class="mi">0</span>        <span class="mf">4.765</span>           <span class="mf">479.7</span>  <span class="mf">21.4</span>       <span class="mf">2.95</span>
<span class="mi">1</span>       <span class="mf">10.920</span>           <span class="mf">521.6</span>  <span class="mf">20.0</span>       <span class="mf">3.15</span>
</pre></div>
</div>
<p>Or we can also combine the two or more categories and summarize the data as
follows.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">groupRaceGender</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Race&#39;</span><span class="p">,</span> <span class="s1">&#39;Female&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Summary by Race and Gender&#39;</span><span class="p">,</span> <span class="n">groupRaceGender</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Summary</span> <span class="n">by</span> <span class="n">Race</span> <span class="ow">and</span> <span class="n">Gender</span>                 <span class="n">Height</span>  <span class="n">AverageMathSAT</span>
<span class="n">Age</span>  <span class="n">Education</span>
<span class="n">Race</span> <span class="n">Female</span>
<span class="n">Blk</span>  <span class="mi">0</span>        <span class="mf">4.350000</span>      <span class="mf">479.562500</span>  <span class="mf">21.1875</span>   <span class="mf">3.562500</span>
     <span class="mi">1</span>       <span class="mf">10.685714</span>      <span class="mf">519.285714</span>  <span class="mf">20.0000</span>   <span class="mf">3.571429</span>
<span class="n">Hisp</span> <span class="mi">0</span>        <span class="mf">5.600000</span>      <span class="mf">461.333333</span>  <span class="mf">22.0000</span>   <span class="mf">1.666667</span>
     <span class="mi">1</span>        <span class="mf">9.300000</span>      <span class="mf">507.000000</span>  <span class="mf">20.0000</span>   <span class="mf">2.000000</span>
<span class="n">Mex</span>  <span class="mi">0</span>        <span class="mf">4.480000</span>      <span class="mf">481.900000</span>  <span class="mf">21.3000</span>   <span class="mf">2.100000</span>
     <span class="mi">1</span>       <span class="mf">10.400000</span>      <span class="mf">515.750000</span>  <span class="mf">20.0000</span>   <span class="mf">3.250000</span>
<span class="n">Oth</span>  <span class="mi">0</span>        <span class="mf">6.300000</span>      <span class="mf">506.000000</span>  <span class="mf">22.0000</span>   <span class="mf">1.000000</span>
     <span class="mi">1</span>       <span class="mf">11.200000</span>      <span class="mf">526.000000</span>  <span class="mf">20.0000</span>   <span class="mf">4.000000</span>
<span class="n">Wht</span>  <span class="mi">0</span>        <span class="mf">5.310000</span>      <span class="mf">480.600000</span>  <span class="mf">21.6000</span>   <span class="mf">3.400000</span>
     <span class="mi">1</span>       <span class="mf">11.642857</span>      <span class="mf">528.714286</span>  <span class="mf">20.0000</span>   <span class="mf">2.714286</span>
</pre></div>
</div>
<p>Be careful and don’t forget to add the various categories in a list using the
brackets <code class="docutils literal notranslate"><span class="pre">[...]]</span></code>.</p>
</div>
</div>
<div class="section" id="measures-of-linear-relationship">
<h2><span class="section-number">11.4. </span>Measures of Linear Relationship<a class="headerlink" href="#measures-of-linear-relationship" title="Permalink to this headline">¶</a></h2>
<div class="section" id="covariance">
<h3><span class="section-number">11.4.1. </span>Covariance<a class="headerlink" href="#covariance" title="Permalink to this headline">¶</a></h3>
<p>We first grab two variables <code class="docutils literal notranslate"><span class="pre">heightv</span></code> and <code class="docutils literal notranslate"><span class="pre">agev</span></code> from the dataframe and
define them as <code class="docutils literal notranslate"><span class="pre">numpy</span></code> arrays.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xv</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">yv</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">xv</span><span class="p">)</span>
</pre></div>
</div>
<p>We then go ahead and calculate the covariance.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Population covariance</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Population covariance = </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span>\
  <span class="nb">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">xv</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">xv</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">yv</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">yv</span><span class="p">)))</span><span class="o">/</span><span class="n">n</span><span class="p">))</span>

<span class="c1"># Sample covariance</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sample covariance     = </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span>\
  <span class="nb">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">xv</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">xv</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">yv</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">yv</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>

<span class="c1"># or simply</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sample covariance     = </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Height</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Population</span> <span class="n">covariance</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.159</span>
<span class="n">Sample</span> <span class="n">covariance</span>     <span class="o">=</span> <span class="o">-</span><span class="mf">0.162</span>
<span class="n">Sample</span> <span class="n">covariance</span>     <span class="o">=</span> <span class="o">-</span><span class="mf">0.162</span>
</pre></div>
</div>
</div>
<div class="section" id="correlation-coefficient">
<h3><span class="section-number">11.4.2. </span>Correlation Coefficient<a class="headerlink" href="#correlation-coefficient" title="Permalink to this headline">¶</a></h3>
<p>We can calculate the correlation coefficient by hand or using the <code class="docutils literal notranslate"><span class="pre">pandas</span></code>
toolbox command.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Correlation coefficient =  </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span>\
  <span class="nb">format</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">xv</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">xv</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">yv</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">yv</span><span class="p">)))</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>\
  <span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">xv</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">yv</span><span class="p">))))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Correlation coefficient = </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Height</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Correlation</span> <span class="n">coefficient</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">0.038</span>
<span class="n">Correlation</span> <span class="n">coefficient</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.038</span>
</pre></div>
</div>
</div>
<div class="section" id="regression-line">
<h3><span class="section-number">11.4.3. </span>Regression Line<a class="headerlink" href="#regression-line" title="Permalink to this headline">¶</a></h3>
<p><strong>Example 1: Simple example</strong></p>
<p>We first generate some data. A variable <code class="docutils literal notranslate"><span class="pre">x</span></code> and a variable <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define data. 2 vectors xv and yv</span>
<span class="n">xv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">yv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">])</span>
</pre></div>
</div>
<p>We then “cast” these into a <code class="docutils literal notranslate"><span class="pre">pandas</span></code> DataFrame.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define data frame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xv</span><span class="p">,</span> <span class="n">yv</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>We fist make a <strong>scatterplot</strong> with least squares trend line: <cite>y = beta_0 +
beta_1 * x + epsilon</cite>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">yv</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>

<span class="c1"># Scatterplot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Linear regression with polyfit()&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">yv</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">xv</span><span class="p">),</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Linear regression&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Data&#39;</span><span class="p">,</span> <span class="s1">&#39;OLS&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.77380952</span> <span class="mf">1.89285714</span><span class="p">]</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/Slides_Data_2_Scatter1_1.png"><img alt="_images/Slides_Data_2_Scatter1_1.png" src="_images/Slides_Data_2_Scatter1_1.png" style="width: 12cm;" /></a>
<p><strong>Example 1 Again with Statsmodels library</strong></p>
<p>We then run the same regression using a more general method called <code class="docutils literal notranslate"><span class="pre">ols</span></code>
which is part of <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>. When calling the <code class="docutils literal notranslate"><span class="pre">ols</span></code> function
you need to add the module name (<code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> was imported as <code class="docutils literal notranslate"><span class="pre">sm</span></code>)
in front of it: <code class="docutils literal notranslate"><span class="pre">sm.OLS()</span></code>. You then define the independent variable <code class="docutils literal notranslate"><span class="pre">y</span></code>
and the dependent variables <code class="docutils literal notranslate"><span class="pre">x's</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you google for OLS and Python you may come across code that
uses <code class="docutils literal notranslate"><span class="pre">Pandas</span></code> directly to run an OLS regression as in <code class="docutils literal notranslate"><span class="pre">pd.OLS(y=Ydata,</span>
<span class="pre">x=Xdata)</span></code>. This will not work anymore as this API has been deprecated in
newer versions of <code class="docutils literal notranslate"><span class="pre">Pandas</span></code>. You need to use the
<a class="reference external" href="http://www.statsmodels.org">Statsmodel Library</a></p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">patsy</span> <span class="kn">import</span> <span class="n">dmatrices</span>

<span class="c1"># Run OLS regression</span>
<span class="c1"># This line adds a constant number column to the X-matrix and extracts</span>
<span class="c1"># the relevant columns from the dataframe</span>
<span class="n">y</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">dmatrices</span><span class="p">(</span><span class="s1">&#39;y ~ x&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;dataframe&#39;</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Show coefficient estimates</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                            <span class="n">OLS</span> <span class="n">Regression</span> <span class="n">Results</span>
<span class="o">==============================================================================</span>
<span class="n">Dep</span><span class="o">.</span> <span class="n">Variable</span><span class="p">:</span>                      <span class="n">y</span>   <span class="n">R</span><span class="o">-</span><span class="n">squared</span><span class="p">:</span>
<span class="mf">0.609</span>
<span class="n">Model</span><span class="p">:</span>                            <span class="n">OLS</span>   <span class="n">Adj</span><span class="o">.</span> <span class="n">R</span><span class="o">-</span><span class="n">squared</span><span class="p">:</span>
<span class="mf">0.544</span>
<span class="n">Method</span><span class="p">:</span>                 <span class="n">Least</span> <span class="n">Squares</span>   <span class="n">F</span><span class="o">-</span><span class="n">statistic</span><span class="p">:</span>
<span class="mf">9.358</span>
<span class="n">Date</span><span class="p">:</span>                <span class="n">Thu</span><span class="p">,</span> <span class="mi">08</span> <span class="n">Feb</span> <span class="mi">2018</span>   <span class="n">Prob</span> <span class="p">(</span><span class="n">F</span><span class="o">-</span><span class="n">statistic</span><span class="p">):</span>
<span class="mf">0.0222</span>
<span class="n">Time</span><span class="p">:</span>                        <span class="mi">16</span><span class="p">:</span><span class="mi">56</span><span class="p">:</span><span class="mi">37</span>   <span class="n">Log</span><span class="o">-</span><span class="n">Likelihood</span><span class="p">:</span>
<span class="o">-</span><span class="mf">20.791</span>
<span class="n">No</span><span class="o">.</span> <span class="n">Observations</span><span class="p">:</span>                   <span class="mi">8</span>   <span class="n">AIC</span><span class="p">:</span>
<span class="mf">45.58</span>
<span class="n">Df</span> <span class="n">Residuals</span><span class="p">:</span>                       <span class="mi">6</span>   <span class="n">BIC</span><span class="p">:</span>
<span class="mf">45.74</span>
<span class="n">Df</span> <span class="n">Model</span><span class="p">:</span>                           <span class="mi">1</span>
<span class="n">Covariance</span> <span class="n">Type</span><span class="p">:</span>            <span class="n">nonrobust</span>
<span class="o">==============================================================================</span>
                 <span class="n">coef</span>    <span class="n">std</span> <span class="n">err</span>          <span class="n">t</span>      <span class="n">P</span><span class="o">&gt;|</span><span class="n">t</span><span class="o">|</span>      <span class="p">[</span><span class="mf">0.025</span>
<span class="mf">0.975</span><span class="p">]</span>
<span class="o">------------------------------------------------------------------------------</span>
<span class="n">Intercept</span>      <span class="mf">1.8929</span>      <span class="mf">2.928</span>      <span class="mf">0.646</span>      <span class="mf">0.542</span>      <span class="o">-</span><span class="mf">5.272</span>
<span class="mf">9.058</span>
<span class="n">x</span>              <span class="mf">1.7738</span>      <span class="mf">0.580</span>      <span class="mf">3.059</span>      <span class="mf">0.022</span>       <span class="mf">0.355</span>
<span class="mf">3.193</span>
<span class="o">==============================================================================</span>
<span class="n">Omnibus</span><span class="p">:</span>                        <span class="mf">0.555</span>   <span class="n">Durbin</span><span class="o">-</span><span class="n">Watson</span><span class="p">:</span>
<span class="mf">3.176</span>
<span class="n">Prob</span><span class="p">(</span><span class="n">Omnibus</span><span class="p">):</span>                  <span class="mf">0.758</span>   <span class="n">Jarque</span><span class="o">-</span><span class="n">Bera</span> <span class="p">(</span><span class="n">JB</span><span class="p">):</span>
<span class="mf">0.309</span>
<span class="n">Skew</span><span class="p">:</span>                           <span class="mf">0.394</span>   <span class="n">Prob</span><span class="p">(</span><span class="n">JB</span><span class="p">):</span>
<span class="mf">0.857</span>
<span class="n">Kurtosis</span><span class="p">:</span>                       <span class="mf">2.449</span>   <span class="n">Cond</span><span class="o">.</span> <span class="n">No</span><span class="o">.</span>
<span class="mf">11.5</span>
<span class="o">==============================================================================</span>

<span class="n">Warnings</span><span class="p">:</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">Standard</span> <span class="n">Errors</span> <span class="n">assume</span> <span class="n">that</span> <span class="n">the</span> <span class="n">covariance</span> <span class="n">matrix</span> <span class="n">of</span> <span class="n">the</span> <span class="n">errors</span> <span class="ow">is</span>
<span class="n">correctly</span> <span class="n">specified</span><span class="o">.</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span>
<span class="n">packages</span>\<span class="n">scipy</span>\<span class="n">stats</span>\<span class="n">stats</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1390</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">kurtosistest</span> <span class="n">only</span>
<span class="n">valid</span> <span class="k">for</span> <span class="n">n</span><span class="o">&gt;=</span><span class="mi">20</span> <span class="o">...</span> <span class="n">continuing</span> <span class="n">anyway</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">8</span>
  <span class="s2">&quot;anyway, n=</span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</pre></div>
</div>
<p>Or if you simply want to have a look at the estimated coefficients you can
access them via:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Parameters:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Parameters</span><span class="p">:</span>
<span class="n">Intercept</span>    <span class="mf">1.892857</span>
<span class="n">x</span>            <span class="mf">1.773810</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>Finally, we use the model to make a prediction of <code class="docutils literal notranslate"><span class="pre">y</span></code> when <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">8.5</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make prediction for x = 8.5</span>
<span class="n">betas</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">values</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Prediction of y for x = 8.5 is: </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span>\
  <span class="nb">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">betas</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mf">8.5</span><span class="p">]))))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Prediction</span> <span class="n">of</span> <span class="n">y</span> <span class="k">for</span> <span class="n">x</span> <span class="o">=</span> <span class="mf">8.5</span> <span class="ow">is</span><span class="p">:</span> <span class="mf">16.970</span>
</pre></div>
</div>
<p>We can also use the results from the <code class="docutils literal notranslate"><span class="pre">OLS</span></code> command to make a scatterplot with
the trendline through it.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Linear Regression with Fitted Values&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">yv</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">),</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Linear regression&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Data&#39;</span><span class="p">,</span> <span class="s1">&#39;OLS&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/Slides_Data_2_Scatter2_1.png"><img alt="_images/Slides_Data_2_Scatter2_1.png" src="_images/Slides_Data_2_Scatter2_1.png" style="width: 12cm;" /></a>
<p>Finally, we use the model to make a prediction of <code class="docutils literal notranslate"><span class="pre">y</span></code> when <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">8.5</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make prediction for x = 8.5</span>
<span class="n">betas</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">values</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Prediction of y for x = 8.5 is: </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span>\
  <span class="nb">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">betas</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mf">8.5</span><span class="p">]))))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Prediction</span> <span class="n">of</span> <span class="n">y</span> <span class="k">for</span> <span class="n">x</span> <span class="o">=</span> <span class="mf">8.5</span> <span class="ow">is</span><span class="p">:</span> <span class="mf">16.970</span>
</pre></div>
</div>
<p>We can also use the results from the <code class="docutils literal notranslate"><span class="pre">OLS</span></code> command to make a scatterplot with
the trendline through it.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Linear Regression with Fitted Values&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">yv</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">),</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Linear regression&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Data&#39;</span><span class="p">,</span> <span class="s1">&#39;OLS&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/Slides_Data_2_Scatter2_1.png"><img alt="_images/Slides_Data_2_Scatter2_1.png" src="_images/Slides_Data_2_Scatter2_1.png" style="width: 12cm;" /></a>
<p><strong>Example 2: OLS with categorical (dummy variables)</strong></p>
<p>The next example is a bit more involved as we increase the number of
explanatory variables. In addition, some explanatory variables are categorical
variables. In order to use them in our OLS regression we first have to make so
called <strong>dummy</strong> variables (i.e. indicator variables that are either 0 or 1).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filepath</span> <span class="o">+</span> <span class="s1">&#39;Lecture_Data_Excel_b.csv&#39;</span><span class="p">)</span>

<span class="n">dummies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Race&#39;</span><span class="p">],</span> <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dummies</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">Height</span>  <span class="n">Response</span>  <span class="n">AverageMathSAT</span>  <span class="n">Age</span>  <span class="n">Female</span>  <span class="n">Education</span>  <span class="n">Race</span>
<span class="n">d_Blk</span>  \
<span class="mi">0</span>     <span class="mf">1.1</span>         <span class="mi">3</span>             <span class="mi">370</span>   <span class="mi">20</span>       <span class="mi">0</span>          <span class="mi">2</span>  <span class="n">Hisp</span>
<span class="mi">0</span>
<span class="mi">1</span>     <span class="mf">1.2</span>         <span class="mi">4</span>             <span class="mi">393</span>   <span class="mi">20</span>       <span class="mi">0</span>          <span class="mi">4</span>   <span class="n">Wht</span>
<span class="mi">0</span>
<span class="mi">2</span>     <span class="mf">1.3</span>         <span class="mi">4</span>             <span class="mi">413</span>   <span class="mi">20</span>       <span class="mi">0</span>          <span class="mi">4</span>   <span class="n">Blk</span>
<span class="mi">1</span>
<span class="mi">3</span>     <span class="mf">1.4</span>         <span class="mi">5</span>             <span class="mi">430</span>   <span class="mi">20</span>       <span class="mi">0</span>          <span class="mi">4</span>   <span class="n">Wht</span>
<span class="mi">0</span>
<span class="mi">4</span>     <span class="mf">1.5</span>         <span class="mi">3</span>             <span class="mi">440</span>   <span class="mi">20</span>       <span class="mi">0</span>          <span class="mi">2</span>   <span class="n">Mex</span>
<span class="mi">0</span>

   <span class="n">d_Hisp</span>  <span class="n">d_Mex</span>  <span class="n">d_Oth</span>  <span class="n">d_Wht</span>
<span class="mi">0</span>       <span class="mi">1</span>      <span class="mi">0</span>      <span class="mi">0</span>      <span class="mi">0</span>
<span class="mi">1</span>       <span class="mi">0</span>      <span class="mi">0</span>      <span class="mi">0</span>      <span class="mi">1</span>
<span class="mi">2</span>       <span class="mi">0</span>      <span class="mi">0</span>      <span class="mi">0</span>      <span class="mi">0</span>
<span class="mi">3</span>       <span class="mi">0</span>      <span class="mi">0</span>      <span class="mi">0</span>      <span class="mi">1</span>
<span class="mi">4</span>       <span class="mi">0</span>      <span class="mi">1</span>      <span class="mi">0</span>      <span class="mi">0</span>
</pre></div>
</div>
<p>We next use <code class="docutils literal notranslate"><span class="pre">OLS</span></code> again to run the regression. At the end we make a
prediction based on some values for the independent variables <code class="docutils literal notranslate"><span class="pre">x1</span></code>, <code class="docutils literal notranslate"><span class="pre">x2</span></code>,
etc.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">patsy</span> <span class="kn">import</span> <span class="n">dmatrices</span>

<span class="n">y</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">dmatrices</span><span class="p">(</span><span class="s1">&#39;Height ~ Age + Education + Female + d_Blk + d_Hisp + d_Mex + d_Wht&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;dataframe&#39;</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Show coefficient estimates</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Parameters:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                            <span class="n">OLS</span> <span class="n">Regression</span> <span class="n">Results</span>
<span class="o">==============================================================================</span>
<span class="n">Dep</span><span class="o">.</span> <span class="n">Variable</span><span class="p">:</span>                 <span class="n">Height</span>   <span class="n">R</span><span class="o">-</span><span class="n">squared</span><span class="p">:</span>
<span class="mf">0.944</span>
<span class="n">Model</span><span class="p">:</span>                            <span class="n">OLS</span>   <span class="n">Adj</span><span class="o">.</span> <span class="n">R</span><span class="o">-</span><span class="n">squared</span><span class="p">:</span>
<span class="mf">0.936</span>
<span class="n">Method</span><span class="p">:</span>                 <span class="n">Least</span> <span class="n">Squares</span>   <span class="n">F</span><span class="o">-</span><span class="n">statistic</span><span class="p">:</span>
<span class="mf">124.4</span>
<span class="n">Date</span><span class="p">:</span>                <span class="n">Thu</span><span class="p">,</span> <span class="mi">08</span> <span class="n">Feb</span> <span class="mi">2018</span>   <span class="n">Prob</span> <span class="p">(</span><span class="n">F</span><span class="o">-</span><span class="n">statistic</span><span class="p">):</span>
<span class="mf">3.52e-30</span>
<span class="n">Time</span><span class="p">:</span>                        <span class="mi">16</span><span class="p">:</span><span class="mi">56</span><span class="p">:</span><span class="mi">41</span>   <span class="n">Log</span><span class="o">-</span><span class="n">Likelihood</span><span class="p">:</span>
<span class="o">-</span><span class="mf">74.722</span>
<span class="n">No</span><span class="o">.</span> <span class="n">Observations</span><span class="p">:</span>                  <span class="mi">60</span>   <span class="n">AIC</span><span class="p">:</span>
<span class="mf">165.4</span>
<span class="n">Df</span> <span class="n">Residuals</span><span class="p">:</span>                      <span class="mi">52</span>   <span class="n">BIC</span><span class="p">:</span>
<span class="mf">182.2</span>
<span class="n">Df</span> <span class="n">Model</span><span class="p">:</span>                           <span class="mi">7</span>
<span class="n">Covariance</span> <span class="n">Type</span><span class="p">:</span>            <span class="n">nonrobust</span>
<span class="o">==============================================================================</span>
                 <span class="n">coef</span>    <span class="n">std</span> <span class="n">err</span>          <span class="n">t</span>      <span class="n">P</span><span class="o">&gt;|</span><span class="n">t</span><span class="o">|</span>      <span class="p">[</span><span class="mf">0.025</span>
<span class="mf">0.975</span><span class="p">]</span>
<span class="o">------------------------------------------------------------------------------</span>
<span class="n">Intercept</span>    <span class="o">-</span><span class="mf">35.2714</span>      <span class="mf">2.751</span>    <span class="o">-</span><span class="mf">12.821</span>      <span class="mf">0.000</span>     <span class="o">-</span><span class="mf">40.792</span>
<span class="o">-</span><span class="mf">29.751</span>
<span class="n">Age</span>            <span class="mf">1.8944</span>      <span class="mf">0.124</span>     <span class="mf">15.269</span>      <span class="mf">0.000</span>       <span class="mf">1.645</span>
<span class="mf">2.143</span>
<span class="n">Education</span>     <span class="o">-</span><span class="mf">0.0514</span>      <span class="mf">0.127</span>     <span class="o">-</span><span class="mf">0.406</span>      <span class="mf">0.686</span>      <span class="o">-</span><span class="mf">0.305</span>
<span class="mf">0.203</span>
<span class="n">Female</span>         <span class="mf">8.7359</span>      <span class="mf">0.308</span>     <span class="mf">28.387</span>      <span class="mf">0.000</span>       <span class="mf">8.118</span>
<span class="mf">9.353</span>
<span class="n">d_Blk</span>         <span class="o">-</span><span class="mf">0.3784</span>      <span class="mf">0.686</span>     <span class="o">-</span><span class="mf">0.552</span>      <span class="mf">0.583</span>      <span class="o">-</span><span class="mf">1.754</span>
<span class="mf">0.997</span>
<span class="n">d_Hisp</span>        <span class="o">-</span><span class="mf">1.0267</span>      <span class="mf">0.790</span>     <span class="o">-</span><span class="mf">1.300</span>      <span class="mf">0.199</span>      <span class="o">-</span><span class="mf">2.612</span>
<span class="mf">0.559</span>
<span class="n">d_Mex</span>         <span class="o">-</span><span class="mf">0.5749</span>      <span class="mf">0.686</span>     <span class="o">-</span><span class="mf">0.838</span>      <span class="mf">0.406</span>      <span class="o">-</span><span class="mf">1.952</span>
<span class="mf">0.802</span>
<span class="n">d_Wht</span>          <span class="mf">0.0816</span>      <span class="mf">0.681</span>      <span class="mf">0.120</span>      <span class="mf">0.905</span>      <span class="o">-</span><span class="mf">1.285</span>
<span class="mf">1.448</span>
<span class="o">==============================================================================</span>
<span class="n">Omnibus</span><span class="p">:</span>                        <span class="mf">0.297</span>   <span class="n">Durbin</span><span class="o">-</span><span class="n">Watson</span><span class="p">:</span>
<span class="mf">0.581</span>
<span class="n">Prob</span><span class="p">(</span><span class="n">Omnibus</span><span class="p">):</span>                  <span class="mf">0.862</span>   <span class="n">Jarque</span><span class="o">-</span><span class="n">Bera</span> <span class="p">(</span><span class="n">JB</span><span class="p">):</span>
<span class="mf">0.478</span>
<span class="n">Skew</span><span class="p">:</span>                          <span class="o">-</span><span class="mf">0.097</span>   <span class="n">Prob</span><span class="p">(</span><span class="n">JB</span><span class="p">):</span>
<span class="mf">0.787</span>
<span class="n">Kurtosis</span><span class="p">:</span>                       <span class="mf">2.607</span>   <span class="n">Cond</span><span class="o">.</span> <span class="n">No</span><span class="o">.</span>
<span class="mf">507.</span>
<span class="o">==============================================================================</span>

<span class="n">Warnings</span><span class="p">:</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">Standard</span> <span class="n">Errors</span> <span class="n">assume</span> <span class="n">that</span> <span class="n">the</span> <span class="n">covariance</span> <span class="n">matrix</span> <span class="n">of</span> <span class="n">the</span> <span class="n">errors</span> <span class="ow">is</span>
<span class="n">correctly</span> <span class="n">specified</span><span class="o">.</span>

<span class="n">Parameters</span><span class="p">:</span>
<span class="n">Intercept</span>   <span class="o">-</span><span class="mf">35.271435</span>
<span class="n">Age</span>           <span class="mf">1.894377</span>
<span class="n">Education</span>    <span class="o">-</span><span class="mf">0.051375</span>
<span class="n">Female</span>        <span class="mf">8.735906</span>
<span class="n">d_Blk</span>        <span class="o">-</span><span class="mf">0.378358</span>
<span class="n">d_Hisp</span>       <span class="o">-</span><span class="mf">1.026743</span>
<span class="n">d_Mex</span>        <span class="o">-</span><span class="mf">0.574949</span>
<span class="n">d_Wht</span>         <span class="mf">0.081628</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>Prediction: size of 8.5 will produce a math score of …</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Take out results and define it as numpy-vector</span>
<span class="n">betas</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">values</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Prediction: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span>\
  <span class="nb">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">betas</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mf">2.5</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]))))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Prediction</span><span class="p">:</span> <span class="o">-</span><span class="mf">23.50477885878147</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="measures-of-non-linear-relationship">
<h2><span class="section-number">11.5. </span>Measures of Non-Linear Relationship<a class="headerlink" href="#measures-of-non-linear-relationship" title="Permalink to this headline">¶</a></h2>
<p>We next demonstrate how to run <strong>Probit</strong> and <strong>Logit</strong> regressions. These
type of regression models are used when the dependent variable is a categorical
0/1 variable. If you instead ran a simple linear OLS regression on such a
variable, the possible predictions from this linear probability model could
fall outside of the <code class="docutils literal notranslate"><span class="pre">[0,1]</span></code> range. The <strong>Probit</strong> and <strong>Logit</strong> specifications
ensure that predictions are probabilities that will fall within the <code class="docutils literal notranslate"><span class="pre">[0,1]</span></code>
range.</p>
<p>Make sure that you have already downloaded the Excel data file
<a class="reference download internal" download="" href="_downloads/875f6f90d89cd646995b259ab44a86ae/Lecture_Data_Excel_c.xlsx"><code class="xref download docutils literal notranslate"><span class="pre">Lecture_Data_Excel_c.xlsx</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read entire excel spreadsheet</span>
<span class="n">filepath</span> <span class="o">=</span> <span class="s1">&#39;Lecture_Data/&#39;</span>
<span class="n">xl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="n">filepath</span> <span class="o">+</span> <span class="s2">&quot;Lecture_Data_Excel_c.xlsx&quot;</span><span class="p">)</span>

<span class="c1"># Check how many sheets we have inside the excel file</span>
<span class="n">xl</span><span class="o">.</span><span class="n">sheet_names</span>

<span class="c1"># Pick one sheet and define it as your DataFrame by parsing a sheet</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">xl</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;binary&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># rename the &#39;rank&#39; column because there is also a DataFrame method called &#39;rank&#39;</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;admit&quot;</span><span class="p">,</span> <span class="s2">&quot;gre&quot;</span><span class="p">,</span> <span class="s2">&quot;gpa&quot;</span><span class="p">,</span> <span class="s2">&quot;prestige&quot;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span><span class="n">ModuleNotFoundError</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span><span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span>
<span class="n">packages</span>\<span class="n">pandas</span>\<span class="n">io</span>\<span class="n">excel</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">io</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
    <span class="mi">260</span>         <span class="k">try</span><span class="p">:</span>
<span class="o">--&gt;</span> <span class="mi">261</span>             <span class="kn">import</span> <span class="nn">xlrd</span>
    <span class="mi">262</span>         <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
<span class="n">ModuleNotFoundError</span><span class="p">:</span> <span class="n">No</span> <span class="n">module</span> <span class="n">named</span> <span class="s1">&#39;xlrd&#39;</span>
<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>
<span class="ne">ImportError</span>                               <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span>
<span class="n">last</span><span class="p">)</span><span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">f983a3ac9c00</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
      <span class="mi">1</span> <span class="c1"># Read entire excel spreadsheet</span>
      <span class="mi">2</span> <span class="n">filepath</span> <span class="o">=</span> <span class="s1">&#39;Lecture_Data/&#39;</span>
<span class="o">----&gt;</span> <span class="mi">3</span> <span class="n">xl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="n">filepath</span> <span class="o">+</span> <span class="s2">&quot;Lecture_Data_Excel_c.xlsx&quot;</span><span class="p">)</span>
      <span class="mi">4</span>
      <span class="mi">5</span> <span class="c1"># Check how many sheets we have inside the excel file</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">pandas</span>\<span class="n">io</span>\<span class="n">excel</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span>
<span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">io</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
    <span class="mi">261</span>             <span class="kn">import</span> <span class="nn">xlrd</span>
    <span class="mi">262</span>         <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
<span class="o">--&gt;</span> <span class="mi">263</span>             <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
    <span class="mi">264</span>         <span class="k">else</span><span class="p">:</span>
    <span class="mi">265</span>             <span class="n">ver</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span>
<span class="n">xlrd</span><span class="o">.</span><span class="n">__VERSION__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[:</span><span class="mi">2</span><span class="p">]))</span>
<span class="ne">ImportError</span><span class="p">:</span> <span class="n">Install</span> <span class="n">xlrd</span> <span class="o">&gt;=</span> <span class="mf">0.9</span><span class="o">.</span><span class="mi">0</span> <span class="k">for</span> <span class="n">Excel</span> <span class="n">support</span>
</pre></div>
</div>
<p>We next make dummies out of the rank variable.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># dummify rank</span>
<span class="n">dummy_ranks</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;prestige&#39;</span><span class="p">],</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;d_prest&#39;</span><span class="p">)</span>

<span class="c1"># Join dataframes</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dummy_ranks</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span><span class="ne">KeyError</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span><span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span>
<span class="n">packages</span>\<span class="n">pandas</span>\<span class="n">core</span>\<span class="n">indexes</span>\<span class="n">base</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">get_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span>
<span class="n">tolerance</span><span class="p">)</span>
   <span class="mi">2524</span>             <span class="k">try</span><span class="p">:</span>
<span class="o">-&gt;</span> <span class="mi">2525</span>                 <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
   <span class="mi">2526</span>             <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<span class="n">pandas</span><span class="o">/</span><span class="n">_libs</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">pyx</span> <span class="ow">in</span> <span class="n">pandas</span><span class="o">.</span><span class="n">_libs</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">IndexEngine</span><span class="o">.</span><span class="n">get_loc</span><span class="p">()</span>
<span class="n">pandas</span><span class="o">/</span><span class="n">_libs</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">pyx</span> <span class="ow">in</span> <span class="n">pandas</span><span class="o">.</span><span class="n">_libs</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">IndexEngine</span><span class="o">.</span><span class="n">get_loc</span><span class="p">()</span>
<span class="n">pandas</span><span class="o">/</span><span class="n">_libs</span><span class="o">/</span><span class="n">hashtable_class_helper</span><span class="o">.</span><span class="n">pxi</span> <span class="ow">in</span>
<span class="n">pandas</span><span class="o">.</span><span class="n">_libs</span><span class="o">.</span><span class="n">hashtable</span><span class="o">.</span><span class="n">PyObjectHashTable</span><span class="o">.</span><span class="n">get_item</span><span class="p">()</span>
<span class="n">pandas</span><span class="o">/</span><span class="n">_libs</span><span class="o">/</span><span class="n">hashtable_class_helper</span><span class="o">.</span><span class="n">pxi</span> <span class="ow">in</span>
<span class="n">pandas</span><span class="o">.</span><span class="n">_libs</span><span class="o">.</span><span class="n">hashtable</span><span class="o">.</span><span class="n">PyObjectHashTable</span><span class="o">.</span><span class="n">get_item</span><span class="p">()</span>
<span class="ne">KeyError</span><span class="p">:</span> <span class="s1">&#39;prestige&#39;</span>
<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>
<span class="ne">KeyError</span>                                  <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span>
<span class="n">last</span><span class="p">)</span><span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">43</span><span class="n">b7a7544add</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
      <span class="mi">1</span> <span class="c1"># dummify rank</span>
<span class="o">----&gt;</span> <span class="mi">2</span> <span class="n">dummy_ranks</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;prestige&#39;</span><span class="p">],</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;d_prest&#39;</span><span class="p">)</span>
      <span class="mi">3</span>
      <span class="mi">4</span> <span class="c1"># Join dataframes</span>
      <span class="mi">5</span> <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dummy_ranks</span><span class="p">)</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">pandas</span>\<span class="n">core</span>\<span class="n">frame</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span>
<span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
   <span class="mi">2137</span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem_multilevel</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
   <span class="mi">2138</span>         <span class="k">else</span><span class="p">:</span>
<span class="o">-&gt;</span> <span class="mi">2139</span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem_column</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
   <span class="mi">2140</span>
   <span class="mi">2141</span>     <span class="k">def</span> <span class="nf">_getitem_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">pandas</span>\<span class="n">core</span>\<span class="n">frame</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span>
<span class="n">_getitem_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
   <span class="mi">2144</span>         <span class="c1"># get column</span>
   <span class="mi">2145</span>         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">is_unique</span><span class="p">:</span>
<span class="o">-&gt;</span> <span class="mi">2146</span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_item_cache</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
   <span class="mi">2147</span>
   <span class="mi">2148</span>         <span class="c1"># duplicate columns &amp; possible reduce dimensionality</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">pandas</span>\<span class="n">core</span>\<span class="n">generic</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span>
<span class="n">_get_item_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
   <span class="mi">1840</span>         <span class="n">res</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
   <span class="mi">1841</span>         <span class="k">if</span> <span class="n">res</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="o">-&gt;</span> <span class="mi">1842</span>             <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
   <span class="mi">1843</span>             <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_box_item_values</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
   <span class="mi">1844</span>             <span class="n">cache</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">pandas</span>\<span class="n">core</span>\<span class="n">internals</span><span class="o">.</span><span class="n">py</span>
<span class="ow">in</span> <span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">fastpath</span><span class="p">)</span>
   <span class="mi">3841</span>
   <span class="mi">3842</span>             <span class="k">if</span> <span class="ow">not</span> <span class="n">isna</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
<span class="o">-&gt;</span> <span class="mi">3843</span>                 <span class="n">loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
   <span class="mi">3844</span>             <span class="k">else</span><span class="p">:</span>
   <span class="mi">3845</span>                 <span class="n">indexer</span> <span class="o">=</span>
<span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">))[</span><span class="n">isna</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">)]</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span>
<span class="n">packages</span>\<span class="n">pandas</span>\<span class="n">core</span>\<span class="n">indexes</span>\<span class="n">base</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">get_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span>
<span class="n">tolerance</span><span class="p">)</span>
   <span class="mi">2525</span>                 <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
   <span class="mi">2526</span>             <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<span class="o">-&gt;</span> <span class="mi">2527</span>                 <span class="k">return</span>
<span class="bp">self</span><span class="o">.</span><span class="n">_engine</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_maybe_cast_indexer</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
   <span class="mi">2528</span>
   <span class="mi">2529</span>         <span class="n">indexer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_indexer</span><span class="p">([</span><span class="n">key</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
<span class="n">tolerance</span><span class="o">=</span><span class="n">tolerance</span><span class="p">)</span>
<span class="n">pandas</span><span class="o">/</span><span class="n">_libs</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">pyx</span> <span class="ow">in</span> <span class="n">pandas</span><span class="o">.</span><span class="n">_libs</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">IndexEngine</span><span class="o">.</span><span class="n">get_loc</span><span class="p">()</span>
<span class="n">pandas</span><span class="o">/</span><span class="n">_libs</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">pyx</span> <span class="ow">in</span> <span class="n">pandas</span><span class="o">.</span><span class="n">_libs</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">IndexEngine</span><span class="o">.</span><span class="n">get_loc</span><span class="p">()</span>
<span class="n">pandas</span><span class="o">/</span><span class="n">_libs</span><span class="o">/</span><span class="n">hashtable_class_helper</span><span class="o">.</span><span class="n">pxi</span> <span class="ow">in</span>
<span class="n">pandas</span><span class="o">.</span><span class="n">_libs</span><span class="o">.</span><span class="n">hashtable</span><span class="o">.</span><span class="n">PyObjectHashTable</span><span class="o">.</span><span class="n">get_item</span><span class="p">()</span>
<span class="n">pandas</span><span class="o">/</span><span class="n">_libs</span><span class="o">/</span><span class="n">hashtable_class_helper</span><span class="o">.</span><span class="n">pxi</span> <span class="ow">in</span>
<span class="n">pandas</span><span class="o">.</span><span class="n">_libs</span><span class="o">.</span><span class="n">hashtable</span><span class="o">.</span><span class="n">PyObjectHashTable</span><span class="o">.</span><span class="n">get_item</span><span class="p">()</span>
<span class="ne">KeyError</span><span class="p">:</span> <span class="s1">&#39;prestige&#39;</span>
</pre></div>
</div>
<div class="section" id="logit">
<h3><span class="section-number">11.5.1. </span>Logit<a class="headerlink" href="#logit" title="Permalink to this headline">¶</a></h3>
<p>We now estimate a <strong>Logit</strong> model as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import the correct version of statsmodels</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">patsy</span> <span class="kn">import</span> <span class="n">dmatrices</span>

<span class="n">y</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">dmatrices</span><span class="p">(</span><span class="s1">&#39;admit ~ gre + gpa + d_prest_2 + d_prest_3 + d_prest_4&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;dataframe&#39;</span><span class="p">)</span>

<span class="c1"># Define the model</span>
<span class="n">logit</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Logit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>

<span class="c1"># fit the model</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">logit</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Print results</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span><span class="ne">NameError</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span><span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span>
<span class="n">packages</span>\<span class="n">patsy</span>\<span class="n">compat</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">call_and_wrap_exc</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span>
<span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
     <span class="mi">35</span>     <span class="k">try</span><span class="p">:</span>
<span class="o">---&gt;</span> <span class="mi">36</span>         <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
     <span class="mi">37</span>     <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">patsy</span>\<span class="nb">eval</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span>
<span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="n">source_name</span><span class="p">,</span> <span class="n">inner_namespace</span><span class="p">)</span>
    <span class="mi">165</span>         <span class="k">return</span> <span class="nb">eval</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="p">{},</span> <span class="n">VarLookupDict</span><span class="p">([</span><span class="n">inner_namespace</span><span class="p">]</span>
<span class="o">--&gt;</span> <span class="mi">166</span>                                             <span class="o">+</span>
<span class="bp">self</span><span class="o">.</span><span class="n">_namespaces</span><span class="p">))</span>
    <span class="mi">167</span>
<span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;d_prest_4&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>
<span class="n">PatsyError</span>                                <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span>
<span class="n">last</span><span class="p">)</span><span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">90</span><span class="n">bf6505a036</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
      <span class="mi">3</span> <span class="kn">from</span> <span class="nn">patsy</span> <span class="kn">import</span> <span class="n">dmatrices</span>
      <span class="mi">4</span>
<span class="o">----&gt;</span> <span class="mi">5</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">dmatrices</span><span class="p">(</span><span class="s1">&#39;admit ~ gre + gpa + d_prest_2 + d_prest_3 +</span>
<span class="n">d_prest_4</span><span class="s1">&#39;, data=df, return_type=&#39;</span><span class="n">dataframe</span><span class="s1">&#39;)</span>
      <span class="mi">6</span>
      <span class="mi">7</span> <span class="c1"># Define the model</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">patsy</span>\<span class="n">highlevel</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span>
<span class="n">dmatrices</span><span class="p">(</span><span class="n">formula_like</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">eval_env</span><span class="p">,</span> <span class="n">NA_action</span><span class="p">,</span> <span class="n">return_type</span><span class="p">)</span>
    <span class="mi">308</span>     <span class="n">eval_env</span> <span class="o">=</span> <span class="n">EvalEnvironment</span><span class="o">.</span><span class="n">capture</span><span class="p">(</span><span class="n">eval_env</span><span class="p">,</span> <span class="n">reference</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="mi">309</span>     <span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="o">=</span> <span class="n">_do_highlevel_design</span><span class="p">(</span><span class="n">formula_like</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span>
<span class="n">eval_env</span><span class="p">,</span>
<span class="o">--&gt;</span> <span class="mi">310</span>                                       <span class="n">NA_action</span><span class="p">,</span> <span class="n">return_type</span><span class="p">)</span>
    <span class="mi">311</span>     <span class="k">if</span> <span class="n">lhs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="mi">312</span>         <span class="k">raise</span> <span class="n">PatsyError</span><span class="p">(</span><span class="s2">&quot;model is missing required outcome</span>
<span class="n">variables</span><span class="s2">&quot;)</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">patsy</span>\<span class="n">highlevel</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span>
<span class="n">_do_highlevel_design</span><span class="p">(</span><span class="n">formula_like</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">eval_env</span><span class="p">,</span> <span class="n">NA_action</span><span class="p">,</span>
<span class="n">return_type</span><span class="p">)</span>
    <span class="mi">163</span>         <span class="k">return</span> <span class="nb">iter</span><span class="p">([</span><span class="n">data</span><span class="p">])</span>
    <span class="mi">164</span>     <span class="n">design_infos</span> <span class="o">=</span> <span class="n">_try_incr_builders</span><span class="p">(</span><span class="n">formula_like</span><span class="p">,</span>
<span class="n">data_iter_maker</span><span class="p">,</span> <span class="n">eval_env</span><span class="p">,</span>
<span class="o">--&gt;</span> <span class="mi">165</span>                                       <span class="n">NA_action</span><span class="p">)</span>
    <span class="mi">166</span>     <span class="k">if</span> <span class="n">design_infos</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="mi">167</span>         <span class="k">return</span> <span class="n">build_design_matrices</span><span class="p">(</span><span class="n">design_infos</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">patsy</span>\<span class="n">highlevel</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span>
<span class="n">_try_incr_builders</span><span class="p">(</span><span class="n">formula_like</span><span class="p">,</span> <span class="n">data_iter_maker</span><span class="p">,</span> <span class="n">eval_env</span><span class="p">,</span> <span class="n">NA_action</span><span class="p">)</span>
     <span class="mi">68</span>                                       <span class="n">data_iter_maker</span><span class="p">,</span>
     <span class="mi">69</span>                                       <span class="n">eval_env</span><span class="p">,</span>
<span class="o">---&gt;</span> <span class="mi">70</span>                                       <span class="n">NA_action</span><span class="p">)</span>
     <span class="mi">71</span>     <span class="k">else</span><span class="p">:</span>
     <span class="mi">72</span>         <span class="k">return</span> <span class="kc">None</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">patsy</span>\<span class="n">build</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span>
<span class="n">design_matrix_builders</span><span class="p">(</span><span class="n">termlists</span><span class="p">,</span> <span class="n">data_iter_maker</span><span class="p">,</span> <span class="n">eval_env</span><span class="p">,</span>
<span class="n">NA_action</span><span class="p">)</span>
    <span class="mi">694</span>
<span class="n">factor_states</span><span class="p">,</span>
    <span class="mi">695</span>
<span class="n">data_iter_maker</span><span class="p">,</span>
<span class="o">--&gt;</span> <span class="mi">696</span>                                                    <span class="n">NA_action</span><span class="p">)</span>
    <span class="mi">697</span>     <span class="c1"># Now we need the factor infos, which encapsulate the</span>
<span class="n">knowledge</span> <span class="n">of</span>
    <span class="mi">698</span>     <span class="c1"># how to turn any given factor into a chunk of data:</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">patsy</span>\<span class="n">build</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span>
<span class="n">_examine_factor_types</span><span class="p">(</span><span class="n">factors</span><span class="p">,</span> <span class="n">factor_states</span><span class="p">,</span> <span class="n">data_iter_maker</span><span class="p">,</span>
<span class="n">NA_action</span><span class="p">)</span>
    <span class="mi">441</span>     <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">data_iter_maker</span><span class="p">():</span>
    <span class="mi">442</span>         <span class="k">for</span> <span class="n">factor</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">examine_needed</span><span class="p">):</span>
<span class="o">--&gt;</span> <span class="mi">443</span>             <span class="n">value</span> <span class="o">=</span> <span class="n">factor</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">factor_states</span><span class="p">[</span><span class="n">factor</span><span class="p">],</span> <span class="n">data</span><span class="p">)</span>
    <span class="mi">444</span>             <span class="k">if</span> <span class="n">factor</span> <span class="ow">in</span> <span class="n">cat_sniffers</span> <span class="ow">or</span>
<span class="n">guess_categorical</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="mi">445</span>                 <span class="k">if</span> <span class="n">factor</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cat_sniffers</span><span class="p">:</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">patsy</span>\<span class="nb">eval</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span>
<span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memorize_state</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
    <span class="mi">564</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval</span><span class="p">(</span><span class="n">memorize_state</span><span class="p">[</span><span class="s2">&quot;eval_code&quot;</span><span class="p">],</span>
    <span class="mi">565</span>                           <span class="n">memorize_state</span><span class="p">,</span>
<span class="o">--&gt;</span> <span class="mi">566</span>                           <span class="n">data</span><span class="p">)</span>
    <span class="mi">567</span>
    <span class="mi">568</span>     <span class="n">__getstate__</span> <span class="o">=</span> <span class="n">no_pickling</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">patsy</span>\<span class="nb">eval</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span>
<span class="n">_eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">memorize_state</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
    <span class="mi">549</span>
<span class="n">memorize_state</span><span class="p">[</span><span class="s2">&quot;eval_env&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">eval</span><span class="p">,</span>
    <span class="mi">550</span>                                  <span class="n">code</span><span class="p">,</span>
<span class="o">--&gt;</span> <span class="mi">551</span>
<span class="n">inner_namespace</span><span class="o">=</span><span class="n">inner_namespace</span><span class="p">)</span>
    <span class="mi">552</span>
    <span class="mi">553</span>     <span class="k">def</span> <span class="nf">memorize_chunk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">which_pass</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">patsy</span>\<span class="n">compat</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span>
<span class="n">call_and_wrap_exc</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
     <span class="mi">41</span>                                  <span class="n">origin</span><span class="p">)</span>
     <span class="mi">42</span>             <span class="c1"># Use &#39;exec&#39; to hide this syntax from the Python 2</span>
<span class="n">parser</span><span class="p">:</span>
<span class="o">---&gt;</span> <span class="mi">43</span>             <span class="n">exec</span><span class="p">(</span><span class="s2">&quot;raise new_exc from e&quot;</span><span class="p">)</span>
     <span class="mi">44</span>         <span class="k">else</span><span class="p">:</span>
     <span class="mi">45</span>             <span class="c1"># In python 2, we just let the original exception</span>
<span class="n">escape</span> <span class="o">--</span> <span class="n">better</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">patsy</span>\<span class="n">compat</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span>
<span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="n">PatsyError</span><span class="p">:</span> <span class="n">Error</span> <span class="n">evaluating</span> <span class="n">factor</span><span class="p">:</span> <span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;d_prest_4&#39;</span> <span class="ow">is</span>
<span class="ow">not</span> <span class="n">defined</span>
    <span class="n">admit</span> <span class="o">~</span> <span class="n">gre</span> <span class="o">+</span> <span class="n">gpa</span> <span class="o">+</span> <span class="n">d_prest_2</span> <span class="o">+</span> <span class="n">d_prest_3</span> <span class="o">+</span> <span class="n">d_prest_4</span>
                                                <span class="o">^^^^^^^^^</span>
</pre></div>
</div>
<p>A Slightly different summary</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">summary2</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                 <span class="n">Results</span><span class="p">:</span> <span class="n">Ordinary</span> <span class="n">least</span> <span class="n">squares</span>
<span class="o">=================================================================</span>
<span class="n">Model</span><span class="p">:</span>              <span class="n">OLS</span>              <span class="n">Adj</span><span class="o">.</span> <span class="n">R</span><span class="o">-</span><span class="n">squared</span><span class="p">:</span>     <span class="mf">0.936</span>
<span class="n">Dependent</span> <span class="n">Variable</span><span class="p">:</span> <span class="n">Height</span>           <span class="n">AIC</span><span class="p">:</span>                <span class="mf">165.4447</span>
<span class="n">Date</span><span class="p">:</span>               <span class="mi">2018</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">08</span> <span class="mi">16</span><span class="p">:</span><span class="mi">56</span> <span class="n">BIC</span><span class="p">:</span>                <span class="mf">182.1994</span>
<span class="n">No</span><span class="o">.</span> <span class="n">Observations</span><span class="p">:</span>   <span class="mi">60</span>               <span class="n">Log</span><span class="o">-</span><span class="n">Likelihood</span><span class="p">:</span>     <span class="o">-</span><span class="mf">74.722</span>
<span class="n">Df</span> <span class="n">Model</span><span class="p">:</span>           <span class="mi">7</span>                <span class="n">F</span><span class="o">-</span><span class="n">statistic</span><span class="p">:</span>        <span class="mf">124.4</span>
<span class="n">Df</span> <span class="n">Residuals</span><span class="p">:</span>       <span class="mi">52</span>               <span class="n">Prob</span> <span class="p">(</span><span class="n">F</span><span class="o">-</span><span class="n">statistic</span><span class="p">):</span> <span class="mf">3.52e-30</span>
<span class="n">R</span><span class="o">-</span><span class="n">squared</span><span class="p">:</span>          <span class="mf">0.944</span>            <span class="n">Scale</span><span class="p">:</span>              <span class="mf">0.81544</span>
<span class="o">-----------------------------------------------------------------</span>
               <span class="n">Coef</span><span class="o">.</span>   <span class="n">Std</span><span class="o">.</span><span class="n">Err</span><span class="o">.</span>    <span class="n">t</span>     <span class="n">P</span><span class="o">&gt;|</span><span class="n">t</span><span class="o">|</span>   <span class="p">[</span><span class="mf">0.025</span>   <span class="mf">0.975</span><span class="p">]</span>
<span class="o">-----------------------------------------------------------------</span>
<span class="n">Intercept</span>     <span class="o">-</span><span class="mf">35.2714</span>   <span class="mf">2.7510</span> <span class="o">-</span><span class="mf">12.8212</span> <span class="mf">0.0000</span> <span class="o">-</span><span class="mf">40.7918</span> <span class="o">-</span><span class="mf">29.7511</span>
<span class="n">Age</span>             <span class="mf">1.8944</span>   <span class="mf">0.1241</span>  <span class="mf">15.2691</span> <span class="mf">0.0000</span>   <span class="mf">1.6454</span>   <span class="mf">2.1433</span>
<span class="n">Education</span>      <span class="o">-</span><span class="mf">0.0514</span>   <span class="mf">0.1265</span>  <span class="o">-</span><span class="mf">0.4060</span> <span class="mf">0.6864</span>  <span class="o">-</span><span class="mf">0.3053</span>   <span class="mf">0.2026</span>
<span class="n">Female</span>          <span class="mf">8.7359</span>   <span class="mf">0.3077</span>  <span class="mf">28.3872</span> <span class="mf">0.0000</span>   <span class="mf">8.1184</span>   <span class="mf">9.3534</span>
<span class="n">d_Blk</span>          <span class="o">-</span><span class="mf">0.3784</span>   <span class="mf">0.6855</span>  <span class="o">-</span><span class="mf">0.5519</span> <span class="mf">0.5834</span>  <span class="o">-</span><span class="mf">1.7540</span>   <span class="mf">0.9973</span>
<span class="n">d_Hisp</span>         <span class="o">-</span><span class="mf">1.0267</span>   <span class="mf">0.7901</span>  <span class="o">-</span><span class="mf">1.2996</span> <span class="mf">0.1995</span>  <span class="o">-</span><span class="mf">2.6121</span>   <span class="mf">0.5586</span>
<span class="n">d_Mex</span>          <span class="o">-</span><span class="mf">0.5749</span>   <span class="mf">0.6863</span>  <span class="o">-</span><span class="mf">0.8378</span> <span class="mf">0.4060</span>  <span class="o">-</span><span class="mf">1.9520</span>   <span class="mf">0.8021</span>
<span class="n">d_Wht</span>           <span class="mf">0.0816</span>   <span class="mf">0.6808</span>   <span class="mf">0.1199</span> <span class="mf">0.9050</span>  <span class="o">-</span><span class="mf">1.2846</span>   <span class="mf">1.4479</span>
<span class="o">-----------------------------------------------------------------</span>
<span class="n">Omnibus</span><span class="p">:</span>               <span class="mf">0.297</span>        <span class="n">Durbin</span><span class="o">-</span><span class="n">Watson</span><span class="p">:</span>          <span class="mf">0.581</span>
<span class="n">Prob</span><span class="p">(</span><span class="n">Omnibus</span><span class="p">):</span>         <span class="mf">0.862</span>        <span class="n">Jarque</span><span class="o">-</span><span class="n">Bera</span> <span class="p">(</span><span class="n">JB</span><span class="p">):</span>       <span class="mf">0.478</span>
<span class="n">Skew</span><span class="p">:</span>                  <span class="o">-</span><span class="mf">0.097</span>       <span class="n">Prob</span><span class="p">(</span><span class="n">JB</span><span class="p">):</span>               <span class="mf">0.787</span>
<span class="n">Kurtosis</span><span class="p">:</span>              <span class="mf">2.607</span>        <span class="n">Condition</span> <span class="n">No</span><span class="o">.</span><span class="p">:</span>          <span class="mi">507</span>
<span class="o">=================================================================</span>
</pre></div>
</div>
</div>
<div class="section" id="probit">
<h3><span class="section-number">11.5.2. </span>Probit<a class="headerlink" href="#probit" title="Permalink to this headline">¶</a></h3>
<p>If you want to run a Probit regression, you can do:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">patsy</span> <span class="kn">import</span> <span class="n">dmatrices</span>

<span class="n">y</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">dmatrices</span><span class="p">(</span><span class="s1">&#39;admit ~ gre + gpa + d_prest_2 + d_prest_3 + d_prest_4&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;dataframe&#39;</span><span class="p">)</span>
<span class="c1"># Define the model</span>
<span class="n">probit</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Probit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>

<span class="c1"># Fit the model</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">probit</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Print results</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span><span class="ne">NameError</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span><span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span>
<span class="n">packages</span>\<span class="n">patsy</span>\<span class="n">compat</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">call_and_wrap_exc</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span>
<span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
     <span class="mi">35</span>     <span class="k">try</span><span class="p">:</span>
<span class="o">---&gt;</span> <span class="mi">36</span>         <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
     <span class="mi">37</span>     <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">patsy</span>\<span class="nb">eval</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span>
<span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="n">source_name</span><span class="p">,</span> <span class="n">inner_namespace</span><span class="p">)</span>
    <span class="mi">165</span>         <span class="k">return</span> <span class="nb">eval</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="p">{},</span> <span class="n">VarLookupDict</span><span class="p">([</span><span class="n">inner_namespace</span><span class="p">]</span>
<span class="o">--&gt;</span> <span class="mi">166</span>                                             <span class="o">+</span>
<span class="bp">self</span><span class="o">.</span><span class="n">_namespaces</span><span class="p">))</span>
    <span class="mi">167</span>
<span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;d_prest_4&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>
<span class="n">PatsyError</span>                                <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span>
<span class="n">last</span><span class="p">)</span><span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">272321</span><span class="n">ba1512</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
      <span class="mi">2</span> <span class="kn">from</span> <span class="nn">patsy</span> <span class="kn">import</span> <span class="n">dmatrices</span>
      <span class="mi">3</span>
<span class="o">----&gt;</span> <span class="mi">4</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">dmatrices</span><span class="p">(</span><span class="s1">&#39;admit ~ gre + gpa + d_prest_2 + d_prest_3 +</span>
<span class="n">d_prest_4</span><span class="s1">&#39;, data=df, return_type=&#39;</span><span class="n">dataframe</span><span class="s1">&#39;)</span>
      <span class="mi">5</span> <span class="c1"># Define the model</span>
      <span class="mi">6</span> <span class="n">probit</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Probit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">patsy</span>\<span class="n">highlevel</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span>
<span class="n">dmatrices</span><span class="p">(</span><span class="n">formula_like</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">eval_env</span><span class="p">,</span> <span class="n">NA_action</span><span class="p">,</span> <span class="n">return_type</span><span class="p">)</span>
    <span class="mi">308</span>     <span class="n">eval_env</span> <span class="o">=</span> <span class="n">EvalEnvironment</span><span class="o">.</span><span class="n">capture</span><span class="p">(</span><span class="n">eval_env</span><span class="p">,</span> <span class="n">reference</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="mi">309</span>     <span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span> <span class="o">=</span> <span class="n">_do_highlevel_design</span><span class="p">(</span><span class="n">formula_like</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span>
<span class="n">eval_env</span><span class="p">,</span>
<span class="o">--&gt;</span> <span class="mi">310</span>                                       <span class="n">NA_action</span><span class="p">,</span> <span class="n">return_type</span><span class="p">)</span>
    <span class="mi">311</span>     <span class="k">if</span> <span class="n">lhs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="mi">312</span>         <span class="k">raise</span> <span class="n">PatsyError</span><span class="p">(</span><span class="s2">&quot;model is missing required outcome</span>
<span class="n">variables</span><span class="s2">&quot;)</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">patsy</span>\<span class="n">highlevel</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span>
<span class="n">_do_highlevel_design</span><span class="p">(</span><span class="n">formula_like</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">eval_env</span><span class="p">,</span> <span class="n">NA_action</span><span class="p">,</span>
<span class="n">return_type</span><span class="p">)</span>
    <span class="mi">163</span>         <span class="k">return</span> <span class="nb">iter</span><span class="p">([</span><span class="n">data</span><span class="p">])</span>
    <span class="mi">164</span>     <span class="n">design_infos</span> <span class="o">=</span> <span class="n">_try_incr_builders</span><span class="p">(</span><span class="n">formula_like</span><span class="p">,</span>
<span class="n">data_iter_maker</span><span class="p">,</span> <span class="n">eval_env</span><span class="p">,</span>
<span class="o">--&gt;</span> <span class="mi">165</span>                                       <span class="n">NA_action</span><span class="p">)</span>
    <span class="mi">166</span>     <span class="k">if</span> <span class="n">design_infos</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="mi">167</span>         <span class="k">return</span> <span class="n">build_design_matrices</span><span class="p">(</span><span class="n">design_infos</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">patsy</span>\<span class="n">highlevel</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span>
<span class="n">_try_incr_builders</span><span class="p">(</span><span class="n">formula_like</span><span class="p">,</span> <span class="n">data_iter_maker</span><span class="p">,</span> <span class="n">eval_env</span><span class="p">,</span> <span class="n">NA_action</span><span class="p">)</span>
     <span class="mi">68</span>                                       <span class="n">data_iter_maker</span><span class="p">,</span>
     <span class="mi">69</span>                                       <span class="n">eval_env</span><span class="p">,</span>
<span class="o">---&gt;</span> <span class="mi">70</span>                                       <span class="n">NA_action</span><span class="p">)</span>
     <span class="mi">71</span>     <span class="k">else</span><span class="p">:</span>
     <span class="mi">72</span>         <span class="k">return</span> <span class="kc">None</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">patsy</span>\<span class="n">build</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span>
<span class="n">design_matrix_builders</span><span class="p">(</span><span class="n">termlists</span><span class="p">,</span> <span class="n">data_iter_maker</span><span class="p">,</span> <span class="n">eval_env</span><span class="p">,</span>
<span class="n">NA_action</span><span class="p">)</span>
    <span class="mi">694</span>
<span class="n">factor_states</span><span class="p">,</span>
    <span class="mi">695</span>
<span class="n">data_iter_maker</span><span class="p">,</span>
<span class="o">--&gt;</span> <span class="mi">696</span>                                                    <span class="n">NA_action</span><span class="p">)</span>
    <span class="mi">697</span>     <span class="c1"># Now we need the factor infos, which encapsulate the</span>
<span class="n">knowledge</span> <span class="n">of</span>
    <span class="mi">698</span>     <span class="c1"># how to turn any given factor into a chunk of data:</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">patsy</span>\<span class="n">build</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span>
<span class="n">_examine_factor_types</span><span class="p">(</span><span class="n">factors</span><span class="p">,</span> <span class="n">factor_states</span><span class="p">,</span> <span class="n">data_iter_maker</span><span class="p">,</span>
<span class="n">NA_action</span><span class="p">)</span>
    <span class="mi">441</span>     <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">data_iter_maker</span><span class="p">():</span>
    <span class="mi">442</span>         <span class="k">for</span> <span class="n">factor</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">examine_needed</span><span class="p">):</span>
<span class="o">--&gt;</span> <span class="mi">443</span>             <span class="n">value</span> <span class="o">=</span> <span class="n">factor</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">factor_states</span><span class="p">[</span><span class="n">factor</span><span class="p">],</span> <span class="n">data</span><span class="p">)</span>
    <span class="mi">444</span>             <span class="k">if</span> <span class="n">factor</span> <span class="ow">in</span> <span class="n">cat_sniffers</span> <span class="ow">or</span>
<span class="n">guess_categorical</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="mi">445</span>                 <span class="k">if</span> <span class="n">factor</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cat_sniffers</span><span class="p">:</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">patsy</span>\<span class="nb">eval</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span>
<span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memorize_state</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
    <span class="mi">564</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval</span><span class="p">(</span><span class="n">memorize_state</span><span class="p">[</span><span class="s2">&quot;eval_code&quot;</span><span class="p">],</span>
    <span class="mi">565</span>                           <span class="n">memorize_state</span><span class="p">,</span>
<span class="o">--&gt;</span> <span class="mi">566</span>                           <span class="n">data</span><span class="p">)</span>
    <span class="mi">567</span>
    <span class="mi">568</span>     <span class="n">__getstate__</span> <span class="o">=</span> <span class="n">no_pickling</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">patsy</span>\<span class="nb">eval</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span>
<span class="n">_eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">memorize_state</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
    <span class="mi">549</span>
<span class="n">memorize_state</span><span class="p">[</span><span class="s2">&quot;eval_env&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">eval</span><span class="p">,</span>
    <span class="mi">550</span>                                  <span class="n">code</span><span class="p">,</span>
<span class="o">--&gt;</span> <span class="mi">551</span>
<span class="n">inner_namespace</span><span class="o">=</span><span class="n">inner_namespace</span><span class="p">)</span>
    <span class="mi">552</span>
    <span class="mi">553</span>     <span class="k">def</span> <span class="nf">memorize_chunk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">which_pass</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">patsy</span>\<span class="n">compat</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span>
<span class="n">call_and_wrap_exc</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
     <span class="mi">41</span>                                  <span class="n">origin</span><span class="p">)</span>
     <span class="mi">42</span>             <span class="c1"># Use &#39;exec&#39; to hide this syntax from the Python 2</span>
<span class="n">parser</span><span class="p">:</span>
<span class="o">---&gt;</span> <span class="mi">43</span>             <span class="n">exec</span><span class="p">(</span><span class="s2">&quot;raise new_exc from e&quot;</span><span class="p">)</span>
     <span class="mi">44</span>         <span class="k">else</span><span class="p">:</span>
     <span class="mi">45</span>             <span class="c1"># In python 2, we just let the original exception</span>
<span class="n">escape</span> <span class="o">--</span> <span class="n">better</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">envs</span>\<span class="n">python35</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">patsy</span>\<span class="n">compat</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span>
<span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="n">PatsyError</span><span class="p">:</span> <span class="n">Error</span> <span class="n">evaluating</span> <span class="n">factor</span><span class="p">:</span> <span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;d_prest_4&#39;</span> <span class="ow">is</span>
<span class="ow">not</span> <span class="n">defined</span>
    <span class="n">admit</span> <span class="o">~</span> <span class="n">gre</span> <span class="o">+</span> <span class="n">gpa</span> <span class="o">+</span> <span class="n">d_prest_2</span> <span class="o">+</span> <span class="n">d_prest_3</span> <span class="o">+</span> <span class="n">d_prest_4</span>
                                                <span class="o">^^^^^^^^^</span>
</pre></div>
</div>
<p>A Slightly different summary</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">summary2</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                 <span class="n">Results</span><span class="p">:</span> <span class="n">Ordinary</span> <span class="n">least</span> <span class="n">squares</span>
<span class="o">=================================================================</span>
<span class="n">Model</span><span class="p">:</span>              <span class="n">OLS</span>              <span class="n">Adj</span><span class="o">.</span> <span class="n">R</span><span class="o">-</span><span class="n">squared</span><span class="p">:</span>     <span class="mf">0.936</span>
<span class="n">Dependent</span> <span class="n">Variable</span><span class="p">:</span> <span class="n">Height</span>           <span class="n">AIC</span><span class="p">:</span>                <span class="mf">165.4447</span>
<span class="n">Date</span><span class="p">:</span>               <span class="mi">2018</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">08</span> <span class="mi">16</span><span class="p">:</span><span class="mi">56</span> <span class="n">BIC</span><span class="p">:</span>                <span class="mf">182.1994</span>
<span class="n">No</span><span class="o">.</span> <span class="n">Observations</span><span class="p">:</span>   <span class="mi">60</span>               <span class="n">Log</span><span class="o">-</span><span class="n">Likelihood</span><span class="p">:</span>     <span class="o">-</span><span class="mf">74.722</span>
<span class="n">Df</span> <span class="n">Model</span><span class="p">:</span>           <span class="mi">7</span>                <span class="n">F</span><span class="o">-</span><span class="n">statistic</span><span class="p">:</span>        <span class="mf">124.4</span>
<span class="n">Df</span> <span class="n">Residuals</span><span class="p">:</span>       <span class="mi">52</span>               <span class="n">Prob</span> <span class="p">(</span><span class="n">F</span><span class="o">-</span><span class="n">statistic</span><span class="p">):</span> <span class="mf">3.52e-30</span>
<span class="n">R</span><span class="o">-</span><span class="n">squared</span><span class="p">:</span>          <span class="mf">0.944</span>            <span class="n">Scale</span><span class="p">:</span>              <span class="mf">0.81544</span>
<span class="o">-----------------------------------------------------------------</span>
               <span class="n">Coef</span><span class="o">.</span>   <span class="n">Std</span><span class="o">.</span><span class="n">Err</span><span class="o">.</span>    <span class="n">t</span>     <span class="n">P</span><span class="o">&gt;|</span><span class="n">t</span><span class="o">|</span>   <span class="p">[</span><span class="mf">0.025</span>   <span class="mf">0.975</span><span class="p">]</span>
<span class="o">-----------------------------------------------------------------</span>
<span class="n">Intercept</span>     <span class="o">-</span><span class="mf">35.2714</span>   <span class="mf">2.7510</span> <span class="o">-</span><span class="mf">12.8212</span> <span class="mf">0.0000</span> <span class="o">-</span><span class="mf">40.7918</span> <span class="o">-</span><span class="mf">29.7511</span>
<span class="n">Age</span>             <span class="mf">1.8944</span>   <span class="mf">0.1241</span>  <span class="mf">15.2691</span> <span class="mf">0.0000</span>   <span class="mf">1.6454</span>   <span class="mf">2.1433</span>
<span class="n">Education</span>      <span class="o">-</span><span class="mf">0.0514</span>   <span class="mf">0.1265</span>  <span class="o">-</span><span class="mf">0.4060</span> <span class="mf">0.6864</span>  <span class="o">-</span><span class="mf">0.3053</span>   <span class="mf">0.2026</span>
<span class="n">Female</span>          <span class="mf">8.7359</span>   <span class="mf">0.3077</span>  <span class="mf">28.3872</span> <span class="mf">0.0000</span>   <span class="mf">8.1184</span>   <span class="mf">9.3534</span>
<span class="n">d_Blk</span>          <span class="o">-</span><span class="mf">0.3784</span>   <span class="mf">0.6855</span>  <span class="o">-</span><span class="mf">0.5519</span> <span class="mf">0.5834</span>  <span class="o">-</span><span class="mf">1.7540</span>   <span class="mf">0.9973</span>
<span class="n">d_Hisp</span>         <span class="o">-</span><span class="mf">1.0267</span>   <span class="mf">0.7901</span>  <span class="o">-</span><span class="mf">1.2996</span> <span class="mf">0.1995</span>  <span class="o">-</span><span class="mf">2.6121</span>   <span class="mf">0.5586</span>
<span class="n">d_Mex</span>          <span class="o">-</span><span class="mf">0.5749</span>   <span class="mf">0.6863</span>  <span class="o">-</span><span class="mf">0.8378</span> <span class="mf">0.4060</span>  <span class="o">-</span><span class="mf">1.9520</span>   <span class="mf">0.8021</span>
<span class="n">d_Wht</span>           <span class="mf">0.0816</span>   <span class="mf">0.6808</span>   <span class="mf">0.1199</span> <span class="mf">0.9050</span>  <span class="o">-</span><span class="mf">1.2846</span>   <span class="mf">1.4479</span>
<span class="o">-----------------------------------------------------------------</span>
<span class="n">Omnibus</span><span class="p">:</span>               <span class="mf">0.297</span>        <span class="n">Durbin</span><span class="o">-</span><span class="n">Watson</span><span class="p">:</span>          <span class="mf">0.581</span>
<span class="n">Prob</span><span class="p">(</span><span class="n">Omnibus</span><span class="p">):</span>         <span class="mf">0.862</span>        <span class="n">Jarque</span><span class="o">-</span><span class="n">Bera</span> <span class="p">(</span><span class="n">JB</span><span class="p">):</span>       <span class="mf">0.478</span>
<span class="n">Skew</span><span class="p">:</span>                  <span class="o">-</span><span class="mf">0.097</span>       <span class="n">Prob</span><span class="p">(</span><span class="n">JB</span><span class="p">):</span>               <span class="mf">0.787</span>
<span class="n">Kurtosis</span><span class="p">:</span>              <span class="mf">2.607</span>        <span class="n">Condition</span> <span class="n">No</span><span class="o">.</span><span class="p">:</span>          <span class="mi">507</span>
<span class="o">=================================================================</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="tutorials">
<h2><span class="section-number">11.6. </span>Tutorials<a class="headerlink" href="#tutorials" title="Permalink to this headline">¶</a></h2>
<p>Some of the notes above are summaries of these tutorials:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://blog.yhat.com/posts/logistic-regression-and-python.html">yhat-Blog</a></p></li>
<li><p><a class="reference external" href="http://statsmodels.sourceforge.net/stable/index.html">Statsmodels library</a></p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Slides_WebData.html" class="btn btn-neutral float-right" title="12. Working with Data from the Web I" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Slides_Data_1.html" class="btn btn-neutral float-left" title="10. Working with Data I: Data Cleaning" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Juergen Jung

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>