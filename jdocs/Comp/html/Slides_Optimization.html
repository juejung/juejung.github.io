

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>13. Optimization &mdash; Computational Economics 1.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="Computational Economics 1.0 documentation" href="index.html"/>
        <link rel="next" title="14. The cake eating problem" href="Slides_Cake.html"/>
        <link rel="prev" title="12. Root finding" href="Slides_Root.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> Computational Economics</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Slides_CourseAdministration.html">1. Course Administration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_CourseAdministration.html#installing-python">1.1. Installing Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_CourseAdministration.html#git-and-github">1.2. Git and Github</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_CourseAdministration.html#submitting-homework-midterm-and-the-final-via-github">1.3. Submitting homework, midterm and the final via GitHub</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Basics.html">2. First steps in Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Basics.html#simple-calculations">2.1. Simple calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Basics.html#the-print-function">2.2. The print function</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Basics.html#script-files">2.3. Script files</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Basics.html#ipython-notebook">2.4. iPython Notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Basics.html#lists-tuples-and-dictionaries">2.5. Lists, tuples and dictionaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Basics.html#in-class-exercises">2.6. In class exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Loop.html">3. Basic programming techniques</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Loop.html#branching">3.1. Branching</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Loop.html#for-loops">3.2. For loops</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Loop.html#while-loop">3.3. While loop</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Debugging.html">4. Debugging</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Debugging.html#using-print-statements-to-spot-mistakes">4.1. Using print statements to spot mistakes</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Debugging.html#using-the-debugger">4.2. Using the debugger</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Debugging.html#in-class-exercises">4.3. In class exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Arrays.html">5. Vectors and matrices</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Arrays.html#definitions-of-vectors-and-matrices">5.1. Definitions of vectors and matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Arrays.html#simple-calculations-with-vectors-and-matrices">5.2. Simple calculations with vectors and matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Arrays.html#vector-manipulation">5.3. Vector manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Arrays.html#matrix-manipulation">5.4. Matrix manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Arrays.html#in-class-exercises">5.5. In class exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Plot.html">6. Plotting using <tt class="docutils literal"><span class="pre">matplotlib</span></tt></a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Plot.html#plotting-vectors-and-arrays">6.1. Plotting vectors and arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Plot.html#plotting-functions">6.2. Plotting functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Plot.html#subplots">6.3. Subplots</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Plot.html#d-graphs">6.4. 3D-Graphs</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Plot.html#homework">6.5. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Functions.html">7. Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Functions.html#use-simple-user-defined-functions">7.1. Use simple user defined functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Functions.html#advanced-graphing-using-loops-and-functions">7.2. Advanced Graphing using loops and functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Functions.html#scope-of-variables-in-functions">7.3. Scope of variables in functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Functions.html#functions-with-default-arguments">7.4. Functions with default arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Functions.html#in-class-exercises">7.5. In class exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_OOP.html">8. Object Oriented Programming</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_OOP.html#introduction">8.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OOP.html#inheritance-and-subclasses">8.2. Inheritance and subclasses</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OOP.html#generating-multiple-objects">8.3. Generating multiple objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OOP.html#homework">8.4. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Data.html">9. Working with data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Data.html#read-in-small-data-set-from-a-comma-separated-csv-file">9.1. Read in small data set from a comma separated (.csv) file</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Data.html#making-simple-graphs-from-our-data">9.2. Making simple graphs from our data</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Data.html#summary-statistics">9.3. Summary statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Data.html#measures-of-linear-relationship">9.4. Measures of linear relationship</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_WebData.html">10. Working with data from the web</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_WebData.html#more-tutorials">10.1. More tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_WebData.html#homework">10.2. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Random.html">11. Random numbers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Random.html#uniformly-distributed-random-numbers">11.1. Uniformly distributed random numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Random.html#normally-distributed-random-numbers">11.2. Normally distributed random numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Random.html#t-distributed-random-variable">11.3. T-distributed random variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Random.html#homework">11.4. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Root.html">12. Root finding</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Root.html#first-steps">12.1. First steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Root.html#newton-raphson">12.2. Newton-Raphson</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Root.html#secant-method">12.3. Secant method</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Root.html#bisection">12.4. Bisection</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Root.html#using-built-in-unit-root-function">12.5. Using built in unit-root function</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Root.html#homework">12.6. Homework</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">13. Optimization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#univariate-function-optimization">13.1. Univariate function optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#optimization-methods">13.2. Optimization methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="#multivariate-optimization">13.3. Multivariate optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#finding-the-root-of-a-function-using-minimization">13.4. Finding the root of a function using minimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#homework">13.5. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Cake.html">14. The cake eating problem</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#solution">14.1. Solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#formally">14.2. Formally</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#id1">14.3. Formally</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#analytical-solution">14.4. Analytical solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#euler-equation">14.5. Euler equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#solving-the-problem">14.6. Solving the problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#solving-the-problem-analytics">14.7. Solving the problem: analytics</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#plotting-the-solution">14.8. Plotting the solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#numerical-solution">14.9. Numerical solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#function-definitions">14.10. Function definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#plotting-is-achieved-via">14.11. Plotting is achieved via:</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#numerical-solution-in-python">14.12. Numerical solution in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#optimizer-in-optimize-toolbox">14.13. Optimizer in <tt class="docutils literal"><span class="pre">optimize</span></tt> toolbox</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#homework">14.14. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_OLG_I.html">15. A simple OLG model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#preferences">15.1. Preferences</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#technology">15.2. Technology</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#government">15.3. Government</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#household-problem">15.4. Household problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#equilibrium-definition">15.5. Equilibrium definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#functional-forms-and-solutions">15.6. Functional forms and solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#substitute-the-budget-set-into-preferences">15.7. Substitute the budget set into preferences</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#solve-for-optimal-household-savings">15.8. Solve for optimal household savings: <span class="math">\(s^*\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#solution">15.9. Solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#equation-system">15.10. Equation system</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#method-1-substituting-everything">15.11. Method 1: Substituting everything</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#one-equation-in-k">15.12. One equation in K</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#aggregate-resource-constraint-arc">15.13. Aggregate resource constraint (ARC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#python-program-1">15.14. Python Program 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#method-2">15.15. Method 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#python-program-2">15.16. Python Program 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#homework">15.17. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_OLG_II.html">16. An OLG model with labor-leisure choice</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_II.html#preferences">16.1. Preferences</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_II.html#technology">16.2. Technology</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_II.html#government">16.3. Government</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_II.html#household-problem">16.4. Household problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_II.html#equilibrium-definition">16.5. Equilibrium definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_II.html#functional-forms-and-solutions">16.6. Functional forms and solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_II.html#substitute-in-preferences">16.7. Substitute in preferences</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_II.html#solve-for-optimal-and">16.8. Solve for optimal <span class="math">\(s^*\)</span> and <span class="math">\(l^*\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_II.html#homework">16.9. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Growth.html">17. Growth Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Growth.html#preferences">17.1. Preferences</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Growth.html#technology">17.2. Technology</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Growth.html#government">17.3. Government</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Growth.html#household-problem">17.4. Household problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Growth.html#equilibrium-definition">17.5. Equilibrium definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Growth.html#functional-forms-and-solutions">17.6. Functional forms and solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Growth.html#substitute-in-preferences">17.7. Substitute in preferences</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Growth.html#solve-for-optimal-and">17.8. Solve for optimal <span class="math">\(s^*\)</span> and <span class="math">\(l^*\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Growth.html#homework">17.9. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Homework.html">18. Homework</a></li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Computational Economics</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>13. Optimization</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/Slides_Optimization.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="optimization">
<h1>13. Optimization<a class="headerlink" href="#optimization" title="Permalink to this headline">¶</a></h1>
<div class="section" id="univariate-function-optimization">
<h2>13.1. Univariate function optimization<a class="headerlink" href="#univariate-function-optimization" title="Permalink to this headline">¶</a></h2>
<div class="section" id="example-function-to-be-maximized">
<h3>13.1.1. Example function to be maximized<a class="headerlink" href="#example-function-to-be-maximized" title="Permalink to this headline">¶</a></h3>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">math</span> <span class="kn">as</span> <span class="nn">m</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span> <span class="k">as</span> <span class="n">st</span>
<span class="c">#</span>
<span class="kn">import</span> <span class="nn">time</span>  <span class="c"># Imports system time module to time your script</span>

<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s">&#39;all&#39;</span><span class="p">)</span>  <span class="c"># close all open figures</span>
</pre></div>
</div>
<p>Here we want to optimize a univariate function: <tt class="docutils literal"><span class="pre">f1</span></tt></p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">f1simple</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="c"># gamma(2,3) density</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>Next we define the same function but return <span class="math">\(f(x)\)</span>, <span class="math">\(f'(x)\)</span>, and
<span class="math">\(f''(x)\)</span>.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="c"># gamma(2,3) density</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">y</span><span class="p">,</span> <span class="mf">8.0</span> <span class="o">*</span> <span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="mf">8.0</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span>
<span class="mf">2.0</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="p">])</span>
</pre></div>
</div>
<p>Some algorithms that we&#8217;ll encounter later will minimize a function. So if we
want to maximize our function we have to define it as a negate function, that
is: <span class="math">\(g(x) = -f(x)\)</span> then <span class="math">\(min(g(x))\)</span> is the same as
<span class="math">\(max(f(x))\)</span>.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">f1simpleNeg</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="c"># gamma(2,3) density</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y</span><span class="p">))</span>
</pre></div>
</div>
<p>Plotting the function is always a good idea!</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">xmin</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="mf">6.0</span>
<span class="n">xv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="p">(</span><span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span><span class="p">)</span><span class="o">/</span><span class="mf">200.0</span><span class="p">)</span>
<span class="n">fx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xv</span><span class="p">),</span><span class="nb">float</span><span class="p">)</span> <span class="c"># define column vector</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xv</span><span class="p">)):</span>
    <span class="n">fx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">f1</span><span class="p">(</span><span class="n">xv</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;fx[0:10]= &quot;</span><span class="p">,</span> <span class="n">fx</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">fx</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xv</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="code highlight-python"><div class="highlight"><pre>fx[0:10]=  [ 0.    0.    0.01  0.03  0.05  0.07  0.09  0.12  0.14
0.17]
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/Slides_Optimization_figure5_1.png"><img alt="_images/Slides_Optimization_figure5_1.png" src="_images/Slides_Optimization_figure5_1.png" style="width: 15cm;" /></a>
</div>
</div>
<div class="section" id="optimization-methods">
<h2>13.2. Optimization methods<a class="headerlink" href="#optimization-methods" title="Permalink to this headline">¶</a></h2>
<div class="section" id="newton-s-method">
<h3>13.2.1. Newton&#8217;s method<a class="headerlink" href="#newton-s-method" title="Permalink to this headline">¶</a></h3>
<p>In order to implement the Newton method we basically look for the root of a
first derivative so that <span class="math">\(f'(x) = 0\)</span>. We then use the root finding
algorithm from the previous section to find this point, or: <span class="math">\(x(n+1) =
x(n) - \frac{f'(x(x))}{f''(x(n))}\)</span></p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">newton</span><span class="p">(</span><span class="n">f3</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="n">nmax</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
    <span class="c"># Newton&#39;s method for optimization, starting at x0</span>
    <span class="c"># f3 is a function that given x returns the vector</span>
    <span class="c"># (f(x), f&#39;(x), f&#39;&#39;(x)), for some f</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span>
    <span class="n">f3x</span> <span class="o">=</span> <span class="n">f3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">f3x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="n">nmax</span><span class="p">)):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">f3x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">f3x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">f3x</span> <span class="o">=</span> <span class="n">f3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="n">nmax</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;newton failed to converge&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="golden-section-method">
<h3>13.2.2. Golden section method<a class="headerlink" href="#golden-section-method" title="Permalink to this headline">¶</a></h3>
<p>The golden-section method works in one dimension only, but does not need the derivatives of the function.
This method is very similar to the bisection method (root bracketing) from the previous section.
The algorithm proceeds in the following way:
Start with <span class="math">\(x_l&lt;x_m&lt;x_r\)</span> such that <span class="math">\(f(x_l) \le (x_m)\)</span> and <span class="math">\(f(x_r) \le f(x_m)\)</span> and <span class="math">\(\rho = \frac{1+\sqrt{5}}{2}\)</span>.</p>
<ol class="arabic simple">
<li>if <span class="math">\(x_r - x_l \le \epsilon\)</span> then stop</li>
<li>if <span class="math">\(x_r-x_m &gt; x_m-x_l\)</span> then do <span class="math">\((a)\)</span> otherwise do <span class="math">\((b)\)</span></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><ol class="first loweralpha">
<li>let <span class="math">\(y=x_m+(x_r-x_m)/(1+\rho)\)</span> if <span class="math">\(f(y) \ge  f(x_m)\)</span> then put <span class="math">\(x_l=x_m\)</span> and <span class="math">\(x_m=y\)</span> otherwise put <span class="math">\(x_r=y\)</span></li>
</ol>
</li>
<li><ol class="first loweralpha" start="2">
<li>let <span class="math">\(y=x_m+(x_m-x_l)/(1+\rho)\)</span> if <span class="math">\(f(y) \ge  f(x_m)\)</span> then put <span class="math">\(x_r=x_m\)</span> and <span class="math">\(x_m=y\)</span> otherwise put <span class="math">\(x_l=y\)</span></li>
</ol>
</li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="3">
<li>go back to step 1</li>
</ol>
<div class="code python highlight-python"><div class="highlight"><pre>def gsection(ftn, xl, xr, xm, tol = 1e-9):
    # applies the golden-section algorithm to maximise ftn
    # we assume that ftn is a function of a single variable
    # and that x.l &lt; x.m &lt; x.r and ftn(x.l), ftn(x.r) &lt;= ftn(x.m)
    #
    # the algorithm iteratively refines x.l, x.r, and x.m and
terminates
    # when x.r - x.l &lt;= tol, then returns x.m
    # golden ratio plus one
    gr1 = 1 + (1 + np.sqrt(5))/2
    #
    # successively refine x.l, x.r, and x.m
    fl = ftn(xl)
    fr = ftn(xr)
    fm = ftn(xm)
    while ((xr - xl) &gt; tol):
        if ((xr - xm) &gt; (xm - xl)):
            y = xm + (xr - xm)/gr1
            fy = ftn(y)
            if (fy &gt;= fm):
                xl = xm
                fl = fm
                xm = y
                fm = fy
            else:
                xr = y
                fr = fy
        else:
            y = xm - (xm - xl)/gr1
            fy = ftn(y)
            if (fy &gt;= fm):
                xr = xm
                fr = fm
                xm = y
                fm = fy
            else:
                xl = y
                fl = fy
    return(xm)
</pre></div>
</div>
<div class="section" id="built-in-fmin-function">
<h4>13.2.2.1. Built in &#8216;fmin&#8217; function<a class="headerlink" href="#built-in-fmin-function" title="Permalink to this headline">¶</a></h4>
<p>The function &#8216;fmin&#8217; is in the scipy.optimize library.</p>
</div>
</div>
<div class="section" id="maximize-function-f1">
<h3>13.2.3. Maximize function: f1<a class="headerlink" href="#maximize-function-f1" title="Permalink to this headline">¶</a></h3>
<div class="section" id="maximizing-using-the-newton-method">
<h4>13.2.3.1. Maximizing using the Newton method<a class="headerlink" href="#maximizing-using-the-newton-method" title="Permalink to this headline">¶</a></h4>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">print</span><span class="p">(</span><span class="s">&quot; -----------------------------------&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot; Newton results &quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot; -----------------------------------&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">newton</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">newton</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">newton</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">newton</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="mf">1.75</span><span class="p">))</span>
</pre></div>
</div>
<div class="code highlight-python"><div class="highlight"><pre> -----------------------------------
 Newton results
 -----------------------------------
1.97865578347e-12
0.0
1.00000000001
1.0
</pre></div>
</div>
</div>
<div class="section" id="maximizing-using-the-secant-method">
<h4>13.2.3.2. Maximizing using the Secant method<a class="headerlink" href="#maximizing-using-the-secant-method" title="Permalink to this headline">¶</a></h4>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">print</span><span class="p">(</span><span class="s">&quot; -----------------------------------&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot; Golden section results &quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot; -----------------------------------&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">gsection</span><span class="p">(</span><span class="n">f1simple</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">gsection</span><span class="p">(</span><span class="n">f1simple</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">gsection</span><span class="p">(</span><span class="n">f1simple</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">gsection</span><span class="p">(</span><span class="n">f1simple</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.75</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">))</span>
</pre></div>
</div>
<div class="code highlight-python"><div class="highlight"><pre> -----------------------------------
 Golden section results
 -----------------------------------
0.99999999879
0.999999992411
0.999999997487
0.999999999283
</pre></div>
</div>
</div>
<div class="section" id="maximizing-using-the-built-in-optimize-library">
<h4>13.2.3.3. Maximizing using the built in optimize library<a class="headerlink" href="#maximizing-using-the-built-in-optimize-library" title="Permalink to this headline">¶</a></h4>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fmin</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot; -----------------------------------&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot; fmin &quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot; -----------------------------------&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">fmin</span><span class="p">(</span><span class="n">f1simpleNeg</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">fmin</span><span class="p">(</span><span class="n">f1simpleNeg</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">fmin</span><span class="p">(</span><span class="n">f1simpleNeg</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">fmin</span><span class="p">(</span><span class="n">f1simpleNeg</span><span class="p">,</span> <span class="mf">1.75</span><span class="p">))</span>
</pre></div>
</div>
<div class="code highlight-python"><div class="highlight"><pre> -----------------------------------
 fmin
 -----------------------------------
Optimization terminated successfully.
         Current function value: -0.541341
         Iterations: 18
         Function evaluations: 36
[ 1.]
Optimization terminated successfully.
         Current function value: -0.541341
         Iterations: 16
         Function evaluations: 32
[ 1.]
Optimization terminated successfully.
         Current function value: -0.541341
         Iterations: 14
         Function evaluations: 28
[ 1.]
Optimization terminated successfully.
         Current function value: -0.541341
         Iterations: 16
         Function evaluations: 32
[ 1.]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="multivariate-optimization">
<h2>13.3. Multivariate optimization<a class="headerlink" href="#multivariate-optimization" title="Permalink to this headline">¶</a></h2>
<div class="section" id="define-multivariate-i-e-bivariate-example-functions">
<h3>13.3.1. Define multivariate (i.e. bivariate) example functions<a class="headerlink" href="#define-multivariate-i-e-bivariate-example-functions" title="Permalink to this headline">¶</a></h3>
<p>Here we want to optimize the following functions: f3, f4</p>
<p><strong>Function f3</strong></p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">f3simple</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">4.0</span>
    <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
<p>Its negative version:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">f3simpleNeg</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">4.0</span>
    <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">f</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
<p>And the version that returns <span class="math">\(f(x)\)</span>, <span class="math">\(f'(x)\)</span> (i.e. the gradient),
and <span class="math">\(f''(x)\)</span> (i.e. the Hessian):</p>
<div class="code python highlight-python"><div class="highlight"><pre>def f3(x):
    a = x[0]**2/2.0 - x[1]**2/4.0
    b = 2*x[0] - np.exp(x[1])
    f = np.sin(a)*np.cos(b)
    f1 = np.cos(a)*np.cos(b)*x[0] - np.sin(a)*np.sin(b)*2
    f2 = -np.cos(a)*np.cos(b)*x[1]/2 +
np.sin(a)*np.sin(b)*np.exp(x[1])
    f11 = -np.sin(a)*np.cos(b)*(4 + x[0]**2) + np.cos(a)*np.cos(b) \
        - np.cos(a)*np.sin(b)*4*x[0]
    f12 = np.sin(a)*np.cos(b)*(x[0]*x[1]/2.0 + 2*np.exp(x[1])) \
        + np.cos(a)*np.sin(b)*(x[0]*np.exp(x[1]) + x[1])
    f22 = -np.sin(a)*np.cos(b)*(x[1]**2/4.0 + np.exp(2*x[1])) \
        - np.cos(a)*np.cos(b)/2.0 -
np.cos(a)*np.sin(b)*x[1]*np.exp(x[1]) \
        + np.sin(a)*np.sin(b)*np.exp(x[1])
    # Function f3 returns: f(x), f&#39;(x), and f&#39;&#39;(x)
    return (f, np.array([f1, f2]), np.array([[f11, f12], [f12, f22]]))
</pre></div>
</div>
<p>Plot function f3:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s">&#39;3d&#39;</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>

<span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)),</span><span class="nb">float</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)):</span>
        <span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">f3simple</span><span class="p">([</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]])</span>

<span class="n">surf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">,</span>
\
       <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">antialiased</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/Slides_Optimization_Fig_Surface_1.png"><img alt="_images/Slides_Optimization_Fig_Surface_1.png" src="_images/Slides_Optimization_Fig_Surface_1.png" style="width: 12cm;" /></a>
<p><strong>Function f4</strong></p>
<p>This is the same function, so we won&#8217;t repeat it here.</p>
</div>
<div class="section" id="multivariate-optimization-methods">
<h3>13.3.2. Multivariate optimization methods<a class="headerlink" href="#multivariate-optimization-methods" title="Permalink to this headline">¶</a></h3>
<div class="section" id="newton">
<h4>13.3.2.1. Newton<a class="headerlink" href="#newton" title="Permalink to this headline">¶</a></h4>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">newtonMult</span><span class="p">(</span><span class="n">f3</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="n">nmax</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
    <span class="c"># Newton&#39;s method for optimisation, starting at x0</span>
    <span class="c"># f3 is a function that given x returns the list</span>
    <span class="c"># {f(x), grad f(x), Hessian f(x)}, for some f</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span>
    <span class="n">f3x</span> <span class="o">=</span> <span class="n">f3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="p">((</span><span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">f3x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="n">nmax</span><span class="p">)):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">f3x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">f3x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">f3x</span> <span class="o">=</span> <span class="n">f3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="n">nmax</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;newton failed to converge&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="built-in-fmin-tnc-in-scipy-optimize-tnc">
<h4>13.3.2.2. Built in &#8216;fmin_tnc&#8217; in scipy.optimize.tnc<a class="headerlink" href="#built-in-fmin-tnc-in-scipy-optimize-tnc" title="Permalink to this headline">¶</a></h4>
</div>
</div>
<div class="section" id="maximize-multivariate-function">
<h3>13.3.3. Maximize multivariate function<a class="headerlink" href="#maximize-multivariate-function" title="Permalink to this headline">¶</a></h3>
<p>We use various starting values to see whether we can find more than one optimum.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fmin</span>

<span class="k">for</span> <span class="n">x0</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">y0</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">):</span>
        <span class="c"># This algorithm requires f(x), f&#39;(x), and f&#39;&#39;(x)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;Newton: f3  &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">])</span> <span class="o">+</span> <span class="s">&#39; --&gt; &#39;</span> <span class="o">+</span>
<span class="nb">str</span><span class="p">(</span><span class="n">newtonMult</span><span class="p">(</span><span class="n">f3</span><span class="p">,</span> \
            <span class="n">np</span><span class="o">.</span> <span class="n">array</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">]))))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;fmin: f3 &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">])</span> <span class="o">+</span> <span class="s">&#39; --&gt; &#39;</span> \
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fmin</span><span class="p">(</span><span class="n">f3simpleNeg</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">]))))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot; ----------------------------------------- &quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code highlight-python"><div class="highlight"><pre>Newton: f3  [1.3999999999999999, 0.40000000000000002] --&gt; [ 0.04
-2.51]
Optimization terminated successfully.
         Current function value: -1.000000
         Iterations: 47
         Function evaluations: 89
fmin: f3 [1.3999999999999999, 0.40000000000000002] --&gt; [ 2.03  1.4 ]
 -----------------------------------------
Newton: f3  [1.3999999999999999, 0.5] --&gt; [ 0.12  3.34]
Optimization terminated successfully.
         Current function value: -1.000000
         Iterations: 50
         Function evaluations: 93
fmin: f3 [1.3999999999999999, 0.5] --&gt; [ 2.03  1.4 ]
 -----------------------------------------
Newton: f3  [1.3999999999999999, 0.59999999999999998] --&gt; [-1.55
6.02]
Optimization terminated successfully.
         Current function value: -1.000000
         Iterations: 43
         Function evaluations: 82
fmin: f3 [1.3999999999999999, 0.59999999999999998] --&gt; [ 2.03  1.4 ]
 -----------------------------------------
Newton: f3  [1.5, 0.40000000000000002] --&gt; [ 2.84  5.35]
Optimization terminated successfully.
         Current function value: -1.000000
         Iterations: 48
         Function evaluations: 90
fmin: f3 [1.5, 0.40000000000000002] --&gt; [ 2.03  1.4 ]
 -----------------------------------------
Newton: f3  [1.5, 0.5] --&gt; [ 0.04 -2.51]
Optimization terminated successfully.
         Current function value: -1.000000
         Iterations: 42
         Function evaluations: 82
fmin: f3 [1.5, 0.5] --&gt; [ 2.03  1.4 ]
 -----------------------------------------
Newton: f3  [1.5, 0.59999999999999998] --&gt; [  9.90e-10   1.37e-09]
Optimization terminated successfully.
         Current function value: -1.000000
         Iterations: 43
         Function evaluations: 82
fmin: f3 [1.5, 0.59999999999999998] --&gt; [ 2.03  1.4 ]
 -----------------------------------------
Newton: f3  [1.6000000000000001, 0.40000000000000002] --&gt; [-0.56
-0.79]
Optimization terminated successfully.
         Current function value: -1.000000
         Iterations: 47
         Function evaluations: 88
fmin: f3 [1.6000000000000001, 0.40000000000000002] --&gt; [ 2.03  1.4 ]
 -----------------------------------------
Newton: f3  [1.6000000000000001, 0.5] --&gt; [-0.29 -0.23]
Optimization terminated successfully.
         Current function value: -1.000000
         Iterations: 44
         Function evaluations: 80
fmin: f3 [1.6000000000000001, 0.5] --&gt; [ 2.03  1.4 ]
 -----------------------------------------
Newton: f3  [1.6000000000000001, 0.59999999999999998] --&gt; [-1.55
-3.33]
Optimization terminated successfully.
         Current function value: -1.000000
         Iterations: 42
         Function evaluations: 80
fmin: f3 [1.6000000000000001, 0.59999999999999998] --&gt; [ 2.03  1.4 ]
 -----------------------------------------
</pre></div>
</div>
</div>
</div>
<div class="section" id="finding-the-root-of-a-function-using-minimization">
<h2>13.4. Finding the root of a function using minimization<a class="headerlink" href="#finding-the-root-of-a-function-using-minimization" title="Permalink to this headline">¶</a></h2>
<p>In a previous chapter on root searching of a function we used various methods
like the built in <strong>fsolve</strong> or <strong>root</strong> functions from the
<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize">scipy.optimize</a>
library.  Here&#8217;s the example from the Root finding chapter again:</p>
<p>The example function for which we calculate the root, i.e., find <span class="math">\(x\)</span>
so that <span class="math">\(f(x) = 0\)</span> is defined as:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>  <span class="c"># function: f(x)</span>
    <span class="k">return</span> <span class="n">s</span>
</pre></div>
</div>
<p>We can solve for the zero (root) position with:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">root</span>
<span class="n">guess</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">root</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">guess</span><span class="p">)</span> <span class="c"># starting from x = 2</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot; -------------- Root ------------&quot;</span><span class="p">)</span>
<span class="n">myroot</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span>  <span class="c"># Grab number from result dictionary</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;The root of func is at {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myroot</span><span class="p">))</span>
</pre></div>
</div>
<div class="code highlight-python"><div class="highlight"><pre> -------------- Root ------------
The root of func is at [ 1.31]
</pre></div>
</div>
<p>In this section we set up the root finding problem as an optimization problem.
In order to do this we change the return value of the function slightly to
<span class="math">\(residual-error = (f(x) - 0)^2\)</span>. So we are trying to find the value of
<tt class="docutils literal"><span class="pre">x</span></tt> so that the residual error between <span class="math">\(f(x)\)</span> and its target value of
<span class="math">\(0\)</span> is as small as possible. The new function is defined as:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">func_root_min</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>  <span class="c"># function: f(x)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>We now invoke a minimizing algorithm to find this value of <span class="math">\(x\)</span></p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize</span>
<span class="n">guess</span> <span class="o">=</span> <span class="mi">2</span> <span class="c"># starting guess x = 2</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">func_root_min</span><span class="p">,</span> <span class="n">guess</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;Nelder-Mead&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;-------------- Root ------------&quot;</span><span class="p">)</span>
<span class="n">myroot</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span>  <span class="c"># Grab number from result dictionary</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;The root of func is at {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myroot</span><span class="p">))</span>
</pre></div>
</div>
<div class="code highlight-python"><div class="highlight"><pre>-------------- Root ------------
The root of func is at [ 1.31]
</pre></div>
</div>
</div>
<div class="section" id="homework">
<h2>13.5. Homework<a class="headerlink" href="#homework" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="Lecture_Optimization/Homework/Homework_Optimization.html"><em>## Exercise 1</em></a></p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Slides_Cake.html" class="btn btn-neutral float-right" title="14. The cake eating problem"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Slides_Root.html" class="btn btn-neutral" title="12. Root finding"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Juergen Jung.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>