

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>19. Optimization &mdash; Computational Economics 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="20. Constrained Optimization" href="Slides_Optimization_2_Cake.html" />
    <link rel="prev" title="18. Root Finding" href="Slides_Root.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Computational Economics
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Slides_CourseAdministration.html">1. Course Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Basics.html">2. First Steps in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_DataStructures.html">3. Python Data Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Loop.html">4. Basic Programming Techniques</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Debugging.html">5. Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Arrays.html">6. Vectors and Matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Plot.html">7. Plotting using <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Functions.html">8. Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_OOP.html">9. Object Oriented Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Data_1.html">10. Working with Data I: Data Cleaning</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Data_2.html">11. Working with Data II: Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Data_3.html">12. Working with Data III: Case Study</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_WebData.html">13. Working with Data from the Web I</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_WebData_2.html">14. Working with Data from the Web II</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_RegularExpressions.html">15. Regular Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Random.html">16. Random Numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Random2.html">17. Random Numbers II: An Infectious Disease Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Root.html">18. Root Finding</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">19. Optimization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#univariate-function-optimization">19.1. Univariate Function Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#optimization-methods">19.2. Optimization Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#newton-s-method">19.2.1. Newton’s Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="#golden-section-method">19.2.2. Golden Section Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="#use-built-in-method-to-maximize-function">19.2.3. Use Built-In Method to Maximize Function</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#finding-the-root-of-a-function-using-minimization">19.3. Finding the Root of a Function using Minimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#multivariate-optimization">19.4. Multivariate Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#function">19.4.1. Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multivariate-newton-method">19.4.2. Multivariate Newton Method</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Optimization_2_Cake.html">20. Constrained Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_MachineLearning_1.html">21. Machine Learning I: Introduction to Machine Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_MachineLearning_2.html">22. Machine Learning II: Categorization Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_OLG_I.html">23. A Simple OLG Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_OLG_II.html">24. An OLG Model with Labor-Leisure Choice</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Growth.html">25. Growth Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Assignments.html">26. Assignments</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Computational Economics</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li><span class="section-number">19. </span>Optimization</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Slides_Optimization_1.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="optimization">
<h1><span class="section-number">19. </span>Optimization<a class="headerlink" href="#optimization" title="Permalink to this headline">¶</a></h1>
<div class="sidebar" id="regex">
<p class="sidebar-title">Section Learning Objectives</p>
<blockquote>
<div><ul class="simple">
<li><p>Univariate Function Optimization</p></li>
<li><p>Optimization Methods</p></li>
<li><p>Finding Root using Function Minimization</p></li>
<li><p>Multivariate Optimization</p></li>
</ul>
</div></blockquote>
</div>
<p>In this section I introduce algorithms that can find the minimum or maximum of
a function. I will rely heavily on the previous chapter on root-finding. Many
optimization problem can be recast as root-finding problems of the first
derivative of the function that needs to be optimized.</p>
<p>As you have already noticed this book teaches by example. I will therefore
first introduce the function that we will try “to optimize.”</p>
<div class="section" id="univariate-function-optimization">
<h2><span class="section-number">19.1. </span>Univariate Function Optimization<a class="headerlink" href="#univariate-function-optimization" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">math</span> <span class="k">as</span> <span class="nn">m</span>
<span class="kn">import</span> <span class="nn">time</span>  <span class="c1"># Imports system time module to time your script</span>

<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>  <span class="c1"># close all open figures</span>
</pre></div>
</div>
<p>Here we want to optimize a univariate function:</p>
<div class="math notranslate nohighlight">
\[f(x) = 4x^2e^{-2x}\]</div>
<p>Think of it as a profit function of a company, where the argument of the
function, the <span class="math notranslate nohighlight">\(x\)</span>, is the amount of goods produced and subsequently sold.
The more you produce and sell i.e., the larger the <span class="math notranslate nohighlight">\(x\)</span> gets, the more
profit you will make. But only up to a point. If you overdo it and start to
produce too much, inefficiencies in production start to creep in possibly due
to congestion in the production process or not enough demand so that production
becomes wasteful and costlier the more you keep on producing. In other words,
there is a sweet spot that you should not cross and if you do your profits will
actually go down.</p>
<p>In Python we first define the function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_profit</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>Notice that I put a check into the function that returns zero for negative
<span class="math notranslate nohighlight">\(x\)</span> values. You cannot produce negative amounts, so we need to take care
of this here.</p>
<p>Second I put a check in for zero value. Since you have a negative exponent, and
x of zero would lead to a division by zero which usually breaks the code and
returns a “division-by-zero” error. Mathematically a division by zero result in
infinity. Infinity is not a problem for mathematical theory but it is a problem
for numerical computation. We want to avoid it.</p>
<p>Plotting the function is always a good idea!</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xmin</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="mf">6.0</span>
<span class="n">xv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="p">(</span><span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span><span class="p">)</span><span class="o">/</span><span class="mf">200.0</span><span class="p">)</span>
<span class="n">fx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xv</span><span class="p">),</span><span class="nb">float</span><span class="p">)</span> <span class="c1"># define column vector</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xv</span><span class="p">)):</span>
    <span class="n">fx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">f_profit</span><span class="p">(</span><span class="n">xv</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">fx</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xv</span><span class="p">)))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;f(x)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Profit Function&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/Slides_Optimization_1_figure3_1.png"><img alt="_images/Slides_Optimization_1_figure3_1.png" src="_images/Slides_Optimization_1_figure3_1.png" style="width: 15cm;" /></a>
<p>From the plot we see that this function seems to have a maximum around when
<span class="math notranslate nohighlight">\(x \approx 1.0\)</span>. It also seems to be the only maximum which would make it
a global maximum.</p>
</div>
<div class="section" id="optimization-methods">
<h2><span class="section-number">19.2. </span>Optimization Methods<a class="headerlink" href="#optimization-methods" title="Permalink to this headline">¶</a></h2>
<div class="section" id="newton-s-method">
<h3><span class="section-number">19.2.1. </span>Newton’s Method<a class="headerlink" href="#newton-s-method" title="Permalink to this headline">¶</a></h3>
<p>What do we know is true at the maximum? If you draw tangent lines along the
function, we know that the tangent line at the maximum (or peak) of the
function is a flat line. Like so:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xmin</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="mf">6.0</span>
<span class="n">xv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">fx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xv</span><span class="p">),</span><span class="nb">float</span><span class="p">)</span> <span class="c1"># define column vector</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xv</span><span class="p">)):</span>
    <span class="n">fx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">f_profit</span><span class="p">(</span><span class="n">xv</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">fx</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">f_profit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xv</span><span class="p">)))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;f(x)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Profit Function&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/Slides_Optimization_1_figure4_1.png"><img alt="_images/Slides_Optimization_1_figure4_1.png" src="_images/Slides_Optimization_1_figure4_1.png" style="width: 15cm;" /></a>
<p>Is there a mathematical expression for a tangent line? Yes there is, it is
called the first derivative. This means that at the peak (i.e., maximum) of the
function, the slope of the derivative is zero, right?</p>
<p>In other words, if we can find the <span class="math notranslate nohighlight">\(x\)</span> value where the derivate of the
function evaluates to zero, or <span class="math notranslate nohighlight">\(f'(x) = 0\)</span>, then we would have found the
<span class="math notranslate nohighlight">\(x\)</span> value where the function is at its maximum value.</p>
<p>Let’s plot the derivative then and see where its value is zero.
Calculus first. Derive the function and you will have:</p>
<div class="math notranslate nohighlight">
\[f'(x) = 4(2 \times x \times e^{-2x} +(-2)x^2e^{-2x}) = 8e^{-2x}x(1 - x)\]</div>
<p>Derive it again (you will see shortly why) and you will get the second
derivative:</p>
<div class="math notranslate nohighlight">
\[f''(x) = 8e^{-2x}(1-4x+2x^2)\]</div>
<p>Next we define another Python function that returns all three, the function
value <span class="math notranslate nohighlight">\(f(x)\)</span>,  the value of the derivative <span class="math notranslate nohighlight">\(f'(x)\)</span>, and the value
of the second derivative <span class="math notranslate nohighlight">\(f''(x)\)</span>. Those are required by
some of the algorithms that you are going to see shortly.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_profit_plus_deriv</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="c1"># gamma(2,3) density</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> \
      <span class="mf">8.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">x</span><span class="p">),</span> \
      <span class="mf">8.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xmin</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="mf">6.0</span>
<span class="n">xv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">dfx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xv</span><span class="p">),</span><span class="nb">float</span><span class="p">)</span> <span class="c1"># define column vector</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xv</span><span class="p">)):</span>

    <span class="c1"># The derivate value is in the second position</span>
    <span class="n">dfx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">f_profit_plus_deriv</span><span class="p">(</span><span class="n">xv</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">dfx</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="mi">0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xv</span><span class="p">)))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;f</span><span class="se">\&#39;</span><span class="s1">(x)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Derivative of Profit Function&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/Slides_Optimization_1_figure6_1.png"><img alt="_images/Slides_Optimization_1_figure6_1.png" src="_images/Slides_Optimization_1_figure6_1.png" style="width: 15cm;" /></a>
<p>From this plot we see that the derivate function crosses the horizontal axis at
and <span class="math notranslate nohighlight">\(x\)</span> value of, well, one. So I gave it away, the maximum of the
function is at <span class="math notranslate nohighlight">\(x=1\)</span>.</p>
<p>Let us pretend for a minute that we do not know that or are not entirely sure
whether this is really our maximum value and let us therefore use the Newton
algorithm from the previous chapter to make sure that the root of the
derivative function is really at one. In order to implement the Newton method
we basically look for the root of a first derivative so that <span class="math notranslate nohighlight">\(f'(x) = 0\)</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">myOpt</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">fmaxval</span> <span class="o">=</span> <span class="n">f_profit</span><span class="p">(</span><span class="n">myOpt</span><span class="p">)</span>

<span class="n">xmin</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="mf">6.0</span>
<span class="n">xv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">fx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xv</span><span class="p">),</span><span class="nb">float</span><span class="p">)</span> <span class="c1"># define column vector</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xv</span><span class="p">)):</span>
    <span class="n">fx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">f_profit_plus_deriv</span><span class="p">(</span><span class="n">xv</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">fx</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">fmaxval</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xv</span><span class="p">)))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">myOpt</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/Slides_Optimization_1_figure7_1.png"><img alt="_images/Slides_Optimization_1_figure7_1.png" src="_images/Slides_Optimization_1_figure7_1.png" style="width: 15cm;" /></a>
<p>We then use the root finding algorithm from the previous chapter to find this point, or:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Newthon-Raphson Root Finding Algorithm</p>
<div class="math notranslate nohighlight">
\[x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)}\]</div>
</div>
<p>We have to adjust this of course because the function we search the foot for is
already the first derivative of a function, so that we have:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[x_{n+1} = x_n - \frac{f'(x_n)}{f''(x_n)}\]</div>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">newton</span><span class="p">(</span><span class="n">f3</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="n">nmax</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
    <span class="c1"># Newton&#39;s method for optimization, starting at x0</span>
    <span class="c1"># f3 is a function that given x returns the vector</span>
    <span class="c1"># (f(x), f&#39;(x), f&#39;&#39;(x)), for some f</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span>
    <span class="n">f3v</span> <span class="o">=</span> <span class="n">f3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">f3v</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="n">nmax</span><span class="p">)):</span>
        <span class="c1"># 1st derivative value is the second return value</span>
        <span class="c1"># 2nd derivative value is the third return value</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">f3v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">f3v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">f3v</span> <span class="o">=</span> <span class="n">f3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="n">nmax</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;newton failed to converge&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>We next use these algorithms to find the maximum point of our function <code class="docutils literal notranslate"><span class="pre">f_profit_plus_deriv</span></code>
and <code class="docutils literal notranslate"><span class="pre">f_profit</span></code>. Note that if we use the Newton algorithm we will need the
first and second derivatives of the functions. This is why we use function
<code class="docutils literal notranslate"><span class="pre">f_profit_plus_deriv</span></code> that returns <code class="docutils literal notranslate"><span class="pre">f,</span> <span class="pre">f'</span> <span class="pre">and</span> <span class="pre">f''</span></code> via an array/vector as return value.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot; -----------------------------------&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Newton results &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; -----------------------------------&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">newton</span><span class="p">(</span><span class="n">f_profit_plus_deriv</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">newton</span><span class="p">(</span><span class="n">f_profit_plus_deriv</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">newton</span><span class="p">(</span><span class="n">f_profit_plus_deriv</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">newton</span><span class="p">(</span><span class="n">f_profit_plus_deriv</span><span class="p">,</span> <span class="mf">1.75</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="o">-----------------------------------</span>
 <span class="n">Newton</span> <span class="n">results</span>
 <span class="o">-----------------------------------</span>
<span class="o">-</span><span class="mf">1.25</span>
<span class="mf">1.0</span>
<span class="mf">0.9999999999980214</span>
<span class="mf">14.42367881581733</span>
</pre></div>
</div>
</div>
<div class="section" id="golden-section-method">
<h3><span class="section-number">19.2.2. </span>Golden Section Method<a class="headerlink" href="#golden-section-method" title="Permalink to this headline">¶</a></h3>
<p>The golden-section method works in one dimension only, but does not need the derivatives of the function.
However, the function still needs to be continuous.
In order to determine whether there is a local maximum we need three points.
Then we can use the following:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <span class="math notranslate nohighlight">\(x_l&lt;x_m&lt;x_r\)</span> and</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(f(x_l) \leq f(x_m)\)</span> and</p></li>
<li><p><span class="math notranslate nohighlight">\(f(x_r) \leq f(x_m)\)</span> then there</p></li>
</ol>
</div></blockquote>
<p>must be a local maximum in the interval between <span class="math notranslate nohighlight">\([x_l,x_r].\)</span></p>
</div>
<p>This method is very similar to the bisection method (root bracketing) from the
previous section.</p>
<p>The method starts with three starting values and operates by successively
narrowing the range of values on the specified interval, which makes it
relatively slow, but very robust. The
technique derives its name from the fact that the algorithm maintains the
function values for four points whose three interval widths are in the ratio</p>
<div class="math notranslate nohighlight">
\[2-\rho : 2 \times \rho-3 : 2- \rho,\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho\)</span> is the golden ratio.</p>
<p>In mathematics, two quantities <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are in the <strong>golden ratio</strong> if their ratio is the
same as the ratio of their sum to the larger of the two quantities. Assume
<span class="math notranslate nohighlight">\(a&gt;b\)</span> then the ratio:</p>
<div class="math notranslate nohighlight">
\[\frac{a}{b} = \frac{a+b}{a} = \rho\]</div>
<p><a class="reference internal" href="#fig-goldenratioline"><span class="std std-numref">Fig. 19.1</span></a> illustrates this geometric relationship.</p>
<div class="figure align-center" id="fig-goldenratioline">
<a class="reference internal image-reference" href="_images/Golden_ratio_line.png"><img alt="_images/Golden_ratio_line.png" src="_images/Golden_ratio_line.png" style="width: 472.0px; height: 245.0px;" /></a>
<p class="caption"><span class="caption-number">Fig. 19.1 </span><span class="caption-text">Line segments in the golden ratio</span><a class="headerlink" href="#fig-goldenratioline" title="Permalink to this image">¶</a></p>
</div>
<p>The golden ratio is the solution to:</p>
<div class="math notranslate nohighlight">
\[\left(\frac{a}{b}\right)^2 - \left(\frac{a}{b}\right) -1 = 0,\]</div>
<p>so that</p>
<div class="math notranslate nohighlight">
\[\left(\frac{a}{b}\right) = \rho = \frac{1+\sqrt{5}}{2}.\]</div>
<p>The algorithm proceeds in the following way:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Start with <span class="math notranslate nohighlight">\(x_l&lt;x_m&lt;x_r\)</span> such that</p>
<div class="math notranslate nohighlight">
\[f(x_l) \le (x_m)\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[f(x_r) \le f(x_m)\]</div>
<p>and the <strong>golden ratio</strong></p>
<div class="math notranslate nohighlight">
\[\rho = \frac{1+\sqrt{5}}{2}.\]</div>
<p>In the algorithm we then check the following:</p>
<blockquote>
<div><ol class="arabic">
<li><p>If <span class="math notranslate nohighlight">\(x_r - x_l \le \epsilon\)</span> then stop</p></li>
<li><p>If <span class="math notranslate nohighlight">\(x_r-x_m &gt; x_m-x_l\)</span> then do <span class="math notranslate nohighlight">\((a)\)</span> otherwise do <span class="math notranslate nohighlight">\((b)\)</span></p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>Let <span class="math notranslate nohighlight">\(y=x_m+(x_r-x_m)/(1+\rho)\)</span> if <span class="math notranslate nohighlight">\(f(y) \ge  f(x_m)\)</span> then put <span class="math notranslate nohighlight">\(x_l=x_m\)</span> and <span class="math notranslate nohighlight">\(x_m=y\)</span> otherwise put <span class="math notranslate nohighlight">\(x_r=y\)</span></p></li>
<li><p>Let <span class="math notranslate nohighlight">\(y=x_m+(x_m-x_l)/(1+\rho)\)</span> if <span class="math notranslate nohighlight">\(f(y) \ge  f(x_m)\)</span> then put <span class="math notranslate nohighlight">\(x_r=x_m\)</span> and <span class="math notranslate nohighlight">\(x_m=y\)</span> otherwise put <span class="math notranslate nohighlight">\(x_l=y\)</span></p></li>
</ol>
</div></blockquote>
</li>
<li><p>Go back to step 1</p></li>
</ol>
</div></blockquote>
</div>
<p><a class="reference internal" href="#fig-goldenratiomaximization"><span class="std std-numref">Fig. 19.2</span></a> illustrates a maximization problem set up
according to the golden ratio algorithm.</p>
<div class="figure align-center" id="fig-goldenratiomaximization">
<a class="reference internal image-reference" href="_images/Golden_ratio_maximization.png"><img alt="_images/Golden_ratio_maximization.png" src="_images/Golden_ratio_maximization.png" style="width: 541.0px; height: 543.0px;" /></a>
<p class="caption"><span class="caption-number">Fig. 19.2 </span><span class="caption-text">Maximization using the Golden Ratio Algorithm</span><a class="headerlink" href="#fig-goldenratiomaximization" title="Permalink to this image">¶</a></p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">gsection</span><span class="p">(</span><span class="n">ftn</span><span class="p">,</span> <span class="n">xl</span><span class="p">,</span> <span class="n">xm</span><span class="p">,</span> <span class="n">xr</span><span class="p">,</span> <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-9</span><span class="p">):</span>
    <span class="c1"># applies the golden-section algorithm to maximise ftn</span>
    <span class="c1"># we assume that ftn is a function of a single variable</span>
    <span class="c1"># and that x.l &lt; x.m &lt; x.r and ftn(x.l), ftn(x.r) &lt;= ftn(x.m)</span>
    <span class="c1">#</span>
    <span class="c1"># the algorithm iteratively refines x.l, x.r, and x.m and</span>
    <span class="c1"># terminates when x.r - x.l &lt;= tol, then returns x.m</span>
    <span class="c1"># golden ratio plus one</span>
    <span class="n">gr1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>
    <span class="c1">#</span>
    <span class="c1"># successively refine x.l, x.r, and x.m</span>
    <span class="n">fl</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">xl</span><span class="p">)</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">xr</span><span class="p">)</span>
    <span class="n">fm</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">xm</span><span class="p">)</span>
    <span class="k">while</span> <span class="p">((</span><span class="n">xr</span> <span class="o">-</span> <span class="n">xl</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">xr</span> <span class="o">-</span> <span class="n">xm</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">xm</span> <span class="o">-</span> <span class="n">xl</span><span class="p">)):</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">xm</span> <span class="o">+</span> <span class="p">(</span><span class="n">xr</span> <span class="o">-</span> <span class="n">xm</span><span class="p">)</span><span class="o">/</span><span class="n">gr1</span>
            <span class="n">fy</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">fy</span> <span class="o">&gt;=</span> <span class="n">fm</span><span class="p">):</span>
                <span class="n">xl</span> <span class="o">=</span> <span class="n">xm</span>
                <span class="n">fl</span> <span class="o">=</span> <span class="n">fm</span>
                <span class="n">xm</span> <span class="o">=</span> <span class="n">y</span>
                <span class="n">fm</span> <span class="o">=</span> <span class="n">fy</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">xr</span> <span class="o">=</span> <span class="n">y</span>
                <span class="n">fr</span> <span class="o">=</span> <span class="n">fy</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">xm</span> <span class="o">-</span> <span class="p">(</span><span class="n">xm</span> <span class="o">-</span> <span class="n">xl</span><span class="p">)</span><span class="o">/</span><span class="n">gr1</span>
            <span class="n">fy</span> <span class="o">=</span> <span class="n">ftn</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">fy</span> <span class="o">&gt;=</span> <span class="n">fm</span><span class="p">):</span>
                <span class="n">xr</span> <span class="o">=</span> <span class="n">xm</span>
                <span class="n">fr</span> <span class="o">=</span> <span class="n">fm</span>
                <span class="n">xm</span> <span class="o">=</span> <span class="n">y</span>
                <span class="n">fm</span> <span class="o">=</span> <span class="n">fy</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">xl</span> <span class="o">=</span> <span class="n">y</span>
                <span class="n">fl</span> <span class="o">=</span> <span class="n">fy</span>
    <span class="k">return</span><span class="p">(</span><span class="n">xm</span><span class="p">)</span>
</pre></div>
</div>
<p>The Golden section algorithm does not require the derivates of the function, so
we just call the <code class="docutils literal notranslate"><span class="pre">f_profit</span></code> function that only returns the functional value.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot; -----------------------------------&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Golden section results &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; -----------------------------------&quot;</span><span class="p">)</span>
<span class="n">myOpt</span> <span class="o">=</span> <span class="n">gsection</span><span class="p">(</span><span class="n">f_profit</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gsection</span><span class="p">(</span><span class="n">f_profit</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gsection</span><span class="p">(</span><span class="n">f_profit</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gsection</span><span class="p">(</span><span class="n">f_profit</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gsection</span><span class="p">(</span><span class="n">f_profit</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.75</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="o">-----------------------------------</span>
 <span class="n">Golden</span> <span class="n">section</span> <span class="n">results</span>
 <span class="o">-----------------------------------</span>
<span class="mf">1.0000000117853984</span>
<span class="mf">1.0000000107340477</span>
<span class="mf">0.9999999921384167</span>
<span class="mf">1.0000000052246139</span>
</pre></div>
</div>
</div>
<div class="section" id="use-built-in-method-to-maximize-function">
<h3><span class="section-number">19.2.3. </span>Use Built-In Method to Maximize Function<a class="headerlink" href="#use-built-in-method-to-maximize-function" title="Permalink to this headline">¶</a></h3>
<p>Finally, we can also use a built in function minimizer.
The built in function <code class="docutils literal notranslate"><span class="pre">fmin</span></code> is in the <code class="docutils literal notranslate"><span class="pre">scipy.optimize</span></code> library. We need to
import it first.  So if we want to maximize our function we have to define it
as a negated function, that is:</p>
<div class="math notranslate nohighlight">
\[g(x) = -f(x)\]</div>
<p>then</p>
<div class="math notranslate nohighlight">
\[min \ g(x)\]</div>
<p>is the same as</p>
<div class="math notranslate nohighlight">
\[max \ f(x).\]</div>
<p>Since we want to find the maximum of the function, we need to “trick” the
minimization algorithm. We therefore need to redefine the function as</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_profitNeg</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="c1"># gamma(2,3) density</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y</span><span class="p">))</span>
</pre></div>
</div>
<p>Here we simply return negative values of this function. If we now minimize this
function, we actually maximize the original function</p>
<div class="math notranslate nohighlight">
\[f(x) = 4x^2e^{-2x}\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fmin</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; -----------------------------------&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; fmin results &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; -----------------------------------&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fmin</span><span class="p">(</span><span class="n">f_profitNeg</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fmin</span><span class="p">(</span><span class="n">f_profitNeg</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fmin</span><span class="p">(</span><span class="n">f_profitNeg</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fmin</span><span class="p">(</span><span class="n">f_profitNeg</span><span class="p">,</span> <span class="mf">1.75</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="o">-----------------------------------</span>
 <span class="n">fmin</span> <span class="n">results</span>
 <span class="o">-----------------------------------</span>
<span class="n">Optimization</span> <span class="n">terminated</span> <span class="n">successfully</span><span class="o">.</span>
         <span class="n">Current</span> <span class="n">function</span> <span class="n">value</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.541341</span>
         <span class="n">Iterations</span><span class="p">:</span> <span class="mi">18</span>
         <span class="n">Function</span> <span class="n">evaluations</span><span class="p">:</span> <span class="mi">36</span>
<span class="p">[</span><span class="mf">1.</span><span class="p">]</span>
<span class="n">Optimization</span> <span class="n">terminated</span> <span class="n">successfully</span><span class="o">.</span>
         <span class="n">Current</span> <span class="n">function</span> <span class="n">value</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.541341</span>
         <span class="n">Iterations</span><span class="p">:</span> <span class="mi">16</span>
         <span class="n">Function</span> <span class="n">evaluations</span><span class="p">:</span> <span class="mi">32</span>
<span class="p">[</span><span class="mf">1.</span><span class="p">]</span>
<span class="n">Optimization</span> <span class="n">terminated</span> <span class="n">successfully</span><span class="o">.</span>
         <span class="n">Current</span> <span class="n">function</span> <span class="n">value</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.541341</span>
         <span class="n">Iterations</span><span class="p">:</span> <span class="mi">14</span>
         <span class="n">Function</span> <span class="n">evaluations</span><span class="p">:</span> <span class="mi">28</span>
<span class="p">[</span><span class="mf">0.99997559</span><span class="p">]</span>
<span class="n">Optimization</span> <span class="n">terminated</span> <span class="n">successfully</span><span class="o">.</span>
         <span class="n">Current</span> <span class="n">function</span> <span class="n">value</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.541341</span>
         <span class="n">Iterations</span><span class="p">:</span> <span class="mi">16</span>
         <span class="n">Function</span> <span class="n">evaluations</span><span class="p">:</span> <span class="mi">32</span>
<span class="p">[</span><span class="mf">1.00001221</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="finding-the-root-of-a-function-using-minimization">
<h2><span class="section-number">19.3. </span>Finding the Root of a Function using Minimization<a class="headerlink" href="#finding-the-root-of-a-function-using-minimization" title="Permalink to this headline">¶</a></h2>
<p>In a previous chapter on root searching of a function we used various methods
like the built in <strong>fsolve</strong> or <strong>root</strong> functions from the
<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize">scipy.optimize</a>
library.  Here’s the example from the Root finding chapter again:</p>
<p>The example function for which we calculate the root, i.e., find <span class="math notranslate nohighlight">\(x\)</span>
so that <span class="math notranslate nohighlight">\(f(x) = 0\)</span> is defined as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># function: f(x)</span>
    <span class="k">return</span> <span class="n">s</span>
</pre></div>
</div>
<p>We can solve for the zero (root) position with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">root</span>

<span class="n">guess</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">root</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">guess</span><span class="p">)</span> <span class="c1"># starting from x = 2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; -------------- Root ------------&quot;</span><span class="p">)</span>
<span class="n">myroot</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span>  <span class="c1"># Grab number from result dictionary</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The root of d_func is at </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myroot</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The max value of the function is </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myOpt</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="o">--------------</span> <span class="n">Root</span> <span class="o">------------</span>
<span class="n">The</span> <span class="n">root</span> <span class="n">of</span> <span class="n">d_func</span> <span class="ow">is</span> <span class="n">at</span> <span class="p">[</span><span class="mf">1.30979959</span><span class="p">]</span>
<span class="n">The</span> <span class="nb">max</span> <span class="n">value</span> <span class="n">of</span> <span class="n">the</span> <span class="n">function</span> <span class="ow">is</span> <span class="mf">1.0000000117853984</span>
</pre></div>
</div>
<p>In this section we set up the root finding problem as an optimization problem.
In order to do this we change the return value of the function slightly to</p>
<div class="math notranslate nohighlight">
\[\text{residual-error} = (f(x) - 0)^2.\]</div>
<p>So we are trying to find the value of
<code class="docutils literal notranslate"><span class="pre">x</span></code> so that the residual error between <span class="math notranslate nohighlight">\(f(x)\)</span> and its target value of
<span class="math notranslate nohighlight">\(0\)</span> is as small as possible. The new function is defined as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">func_root_min</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># function: f(x)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>We now invoke a minimizing algorithm to find this value of <span class="math notranslate nohighlight">\(x\)</span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize</span>

<span class="n">guess</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># starting guess x = 2</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">func_root_min</span><span class="p">,</span> <span class="n">guess</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;Nelder-Mead&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-------------- Root ------------&quot;</span><span class="p">)</span>
<span class="n">myroot</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span>  <span class="c1"># Grab number from result dictionary</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The root of func is at </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myroot</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--------------</span> <span class="n">Root</span> <span class="o">------------</span>
<span class="n">The</span> <span class="n">root</span> <span class="n">of</span> <span class="n">func</span> <span class="ow">is</span> <span class="n">at</span> <span class="p">[</span><span class="mf">1.30976562</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="multivariate-optimization">
<h2><span class="section-number">19.4. </span>Multivariate Optimization<a class="headerlink" href="#multivariate-optimization" title="Permalink to this headline">¶</a></h2>
<div class="section" id="function">
<h3><span class="section-number">19.4.1. </span>Function<a class="headerlink" href="#function" title="Permalink to this headline">¶</a></h3>
<p>Here we want to optimize the following function <strong>f3</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f3simple</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">4.0</span>
    <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
<p>Its negative version:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f3simpleNeg</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">4.0</span>
    <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">f</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
<p>And the version that returns <span class="math notranslate nohighlight">\(f(x)\)</span>, <span class="math notranslate nohighlight">\(f'(x)\)</span> (i.e., the gradient),
and <span class="math notranslate nohighlight">\(f''(x)\)</span> (i.e., the Hessian matrix):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f3</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">4.0</span>
    <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span>
    <span class="n">f2</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">f11</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> \
        <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">f12</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> \
        <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">f22</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">4.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> \
        <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> \
        <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1"># Function f3 returns: f(x), f&#39;(x), and f&#39;&#39;(x)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">f11</span><span class="p">,</span> <span class="n">f12</span><span class="p">],</span> <span class="p">[</span><span class="n">f12</span><span class="p">,</span> <span class="n">f22</span><span class="p">]]))</span>
</pre></div>
</div>
<p>We next plot the function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">.1</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">.1</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>

<span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)),</span><span class="nb">float</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)):</span>
        <span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">f3simple</span><span class="p">([</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]])</span>

<span class="n">surf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> \
    <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">antialiased</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ipykernel_40767</span><span class="o">/</span><span class="mf">2176093652.</span><span class="n">py</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span> <span class="n">MatplotlibDeprecationWarning</span><span class="p">:</span>
<span class="n">Calling</span> <span class="n">gca</span><span class="p">()</span> <span class="k">with</span> <span class="n">keyword</span> <span class="n">arguments</span> <span class="n">was</span> <span class="n">deprecated</span> <span class="ow">in</span> <span class="n">Matplotlib</span> <span class="mf">3.4</span><span class="o">.</span>
<span class="n">Starting</span> <span class="n">two</span> <span class="n">minor</span> <span class="n">releases</span> <span class="n">later</span><span class="p">,</span> <span class="n">gca</span><span class="p">()</span> <span class="n">will</span> <span class="n">take</span> <span class="n">no</span> <span class="n">keyword</span>
<span class="n">arguments</span><span class="o">.</span> <span class="n">The</span> <span class="n">gca</span><span class="p">()</span> <span class="n">function</span> <span class="n">should</span> <span class="n">only</span> <span class="n">be</span> <span class="n">used</span> <span class="n">to</span> <span class="n">get</span> <span class="n">the</span> <span class="n">current</span>
<span class="n">axes</span><span class="p">,</span> <span class="ow">or</span> <span class="k">if</span> <span class="n">no</span> <span class="n">axes</span> <span class="n">exist</span><span class="p">,</span> <span class="n">create</span> <span class="n">new</span> <span class="n">axes</span> <span class="k">with</span> <span class="n">default</span> <span class="n">keyword</span>
<span class="n">arguments</span><span class="o">.</span> <span class="n">To</span> <span class="n">create</span> <span class="n">a</span> <span class="n">new</span> <span class="n">axes</span> <span class="k">with</span> <span class="n">non</span><span class="o">-</span><span class="n">default</span> <span class="n">arguments</span><span class="p">,</span> <span class="n">use</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span> <span class="ow">or</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">()</span><span class="o">.</span>
  <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/Slides_Optimization_1_Fig_Surface_1.png"><img alt="_images/Slides_Optimization_1_Fig_Surface_1.png" src="_images/Slides_Optimization_1_Fig_Surface_1.png" style="width: 12cm;" /></a>
</div>
<div class="section" id="multivariate-newton-method">
<h3><span class="section-number">19.4.2. </span>Multivariate Newton Method<a class="headerlink" href="#multivariate-newton-method" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">newtonMult</span><span class="p">(</span><span class="n">f3</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="n">nmax</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
    <span class="c1"># Newton&#39;s method for optimization, starting at x0</span>
    <span class="c1"># f3 is a function that given x returns the list</span>
    <span class="c1"># {f(x), grad f(x), Hessian f(x)}, for some f</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span>
    <span class="n">f3x</span> <span class="o">=</span> <span class="n">f3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="p">((</span><span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">f3x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="n">nmax</span><span class="p">)):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">f3x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">f3x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">f3x</span> <span class="o">=</span> <span class="n">f3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="n">nmax</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;newton failed to converge&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>Compare the Newton method with the built in <code class="docutils literal notranslate"><span class="pre">fmin</span></code> method in
<code class="docutils literal notranslate"><span class="pre">scipy.optimize</span></code>.  We use various starting values to see whether we can find
more than one optimum.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fmin</span>

<span class="k">for</span> <span class="n">x0</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">y0</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">):</span>
        <span class="c1"># This algorithm requires f(x), f&#39;(x), and f&#39;&#39;(x)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Newton: f3  &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; --&gt; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">newtonMult</span><span class="p">(</span><span class="n">f3</span><span class="p">,</span> \
            <span class="n">np</span><span class="o">.</span> <span class="n">array</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">]))))</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;fmin: f3 &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; --&gt; &#39;</span> \
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fmin</span><span class="p">(</span><span class="n">f3simpleNeg</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">]))))</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; ----------------------------------------- &quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Newton</span><span class="p">:</span> <span class="n">f3</span>  <span class="p">[</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]</span> <span class="o">--&gt;</span> <span class="p">[</span> <span class="mf">0.04074437</span> <span class="o">-</span><span class="mf">2.50729047</span><span class="p">]</span>
<span class="n">Optimization</span> <span class="n">terminated</span> <span class="n">successfully</span><span class="o">.</span>
         <span class="n">Current</span> <span class="n">function</span> <span class="n">value</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.000000</span>
         <span class="n">Iterations</span><span class="p">:</span> <span class="mi">47</span>
         <span class="n">Function</span> <span class="n">evaluations</span><span class="p">:</span> <span class="mi">89</span>
<span class="n">fmin</span><span class="p">:</span> <span class="n">f3</span> <span class="p">[</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]</span> <span class="o">--&gt;</span> <span class="p">[</span><span class="mf">2.0307334</span>  <span class="mf">1.40155445</span><span class="p">]</span>
 <span class="o">-----------------------------------------</span>
<span class="n">Newton</span><span class="p">:</span> <span class="n">f3</span>  <span class="p">[</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span> <span class="o">--&gt;</span> <span class="p">[</span><span class="mf">0.11797341</span> <span class="mf">3.34466147</span><span class="p">]</span>
<span class="n">Optimization</span> <span class="n">terminated</span> <span class="n">successfully</span><span class="o">.</span>
         <span class="n">Current</span> <span class="n">function</span> <span class="n">value</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.000000</span>
         <span class="n">Iterations</span><span class="p">:</span> <span class="mi">50</span>
         <span class="n">Function</span> <span class="n">evaluations</span><span class="p">:</span> <span class="mi">93</span>
<span class="n">fmin</span><span class="p">:</span> <span class="n">f3</span> <span class="p">[</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span> <span class="o">--&gt;</span> <span class="p">[</span><span class="mf">2.03072555</span> <span class="mf">1.40154756</span><span class="p">]</span>
 <span class="o">-----------------------------------------</span>
<span class="n">Newton</span><span class="p">:</span> <span class="n">f3</span>  <span class="p">[</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]</span> <span class="o">--&gt;</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.5531627</span>  <span class="mf">6.0200129</span><span class="p">]</span>
<span class="n">Optimization</span> <span class="n">terminated</span> <span class="n">successfully</span><span class="o">.</span>
         <span class="n">Current</span> <span class="n">function</span> <span class="n">value</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.000000</span>
         <span class="n">Iterations</span><span class="p">:</span> <span class="mi">43</span>
         <span class="n">Function</span> <span class="n">evaluations</span><span class="p">:</span> <span class="mi">82</span>
<span class="n">fmin</span><span class="p">:</span> <span class="n">f3</span> <span class="p">[</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]</span> <span class="o">--&gt;</span> <span class="p">[</span><span class="mf">2.03068816</span> <span class="mf">1.40151998</span><span class="p">]</span>
 <span class="o">-----------------------------------------</span>
<span class="n">Newton</span><span class="p">:</span> <span class="n">f3</span>  <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]</span> <span class="o">--&gt;</span> <span class="p">[</span><span class="mf">2.83714224</span> <span class="mf">5.35398196</span><span class="p">]</span>
<span class="n">Optimization</span> <span class="n">terminated</span> <span class="n">successfully</span><span class="o">.</span>
         <span class="n">Current</span> <span class="n">function</span> <span class="n">value</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.000000</span>
         <span class="n">Iterations</span><span class="p">:</span> <span class="mi">48</span>
         <span class="n">Function</span> <span class="n">evaluations</span><span class="p">:</span> <span class="mi">90</span>
<span class="n">fmin</span><span class="p">:</span> <span class="n">f3</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]</span> <span class="o">--&gt;</span> <span class="p">[</span><span class="mf">2.03067611</span> <span class="mf">1.40149298</span><span class="p">]</span>
 <span class="o">-----------------------------------------</span>
<span class="n">Newton</span><span class="p">:</span> <span class="n">f3</span>  <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span> <span class="o">--&gt;</span> <span class="p">[</span> <span class="mf">0.04074437</span> <span class="o">-</span><span class="mf">2.50729047</span><span class="p">]</span>
<span class="n">Optimization</span> <span class="n">terminated</span> <span class="n">successfully</span><span class="o">.</span>
         <span class="n">Current</span> <span class="n">function</span> <span class="n">value</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.000000</span>
         <span class="n">Iterations</span><span class="p">:</span> <span class="mi">42</span>
         <span class="n">Function</span> <span class="n">evaluations</span><span class="p">:</span> <span class="mi">82</span>
<span class="n">fmin</span><span class="p">:</span> <span class="n">f3</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span> <span class="o">--&gt;</span> <span class="p">[</span><span class="mf">2.03071509</span> <span class="mf">1.40155165</span><span class="p">]</span>
 <span class="o">-----------------------------------------</span>
<span class="n">Newton</span><span class="p">:</span> <span class="n">f3</span>  <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]</span> <span class="o">--&gt;</span> <span class="p">[</span><span class="mf">9.89908350e-10</span> <span class="mf">1.36639196e-09</span><span class="p">]</span>
<span class="n">Optimization</span> <span class="n">terminated</span> <span class="n">successfully</span><span class="o">.</span>
         <span class="n">Current</span> <span class="n">function</span> <span class="n">value</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.000000</span>
         <span class="n">Iterations</span><span class="p">:</span> <span class="mi">43</span>
         <span class="n">Function</span> <span class="n">evaluations</span><span class="p">:</span> <span class="mi">82</span>
<span class="n">fmin</span><span class="p">:</span> <span class="n">f3</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]</span> <span class="o">--&gt;</span> <span class="p">[</span><span class="mf">2.0307244</span>  <span class="mf">1.40153761</span><span class="p">]</span>
 <span class="o">-----------------------------------------</span>
<span class="n">Newton</span><span class="p">:</span> <span class="n">f3</span>  <span class="p">[</span><span class="mf">1.6</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]</span> <span class="o">--&gt;</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.55841026</span> <span class="o">-</span><span class="mf">0.78971136</span><span class="p">]</span>
<span class="n">Optimization</span> <span class="n">terminated</span> <span class="n">successfully</span><span class="o">.</span>
         <span class="n">Current</span> <span class="n">function</span> <span class="n">value</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.000000</span>
         <span class="n">Iterations</span><span class="p">:</span> <span class="mi">47</span>
         <span class="n">Function</span> <span class="n">evaluations</span><span class="p">:</span> <span class="mi">88</span>
<span class="n">fmin</span><span class="p">:</span> <span class="n">f3</span> <span class="p">[</span><span class="mf">1.6</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]</span> <span class="o">--&gt;</span> <span class="p">[</span><span class="mf">2.0307159</span>  <span class="mf">1.40150964</span><span class="p">]</span>
 <span class="o">-----------------------------------------</span>
<span class="n">Newton</span><span class="p">:</span> <span class="n">f3</span>  <span class="p">[</span><span class="mf">1.6</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span> <span class="o">--&gt;</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.29022131</span> <span class="o">-</span><span class="mf">0.23047994</span><span class="p">]</span>
<span class="n">Optimization</span> <span class="n">terminated</span> <span class="n">successfully</span><span class="o">.</span>
         <span class="n">Current</span> <span class="n">function</span> <span class="n">value</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.000000</span>
         <span class="n">Iterations</span><span class="p">:</span> <span class="mi">44</span>
         <span class="n">Function</span> <span class="n">evaluations</span><span class="p">:</span> <span class="mi">80</span>
<span class="n">fmin</span><span class="p">:</span> <span class="n">f3</span> <span class="p">[</span><span class="mf">1.6</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span> <span class="o">--&gt;</span> <span class="p">[</span><span class="mf">2.03074135</span> <span class="mf">1.40151521</span><span class="p">]</span>
 <span class="o">-----------------------------------------</span>
<span class="n">Newton</span><span class="p">:</span> <span class="n">f3</span>  <span class="p">[</span><span class="mf">1.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]</span> <span class="o">--&gt;</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.55294692</span> <span class="o">-</span><span class="mf">3.33263763</span><span class="p">]</span>
<span class="n">Optimization</span> <span class="n">terminated</span> <span class="n">successfully</span><span class="o">.</span>
         <span class="n">Current</span> <span class="n">function</span> <span class="n">value</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.000000</span>
         <span class="n">Iterations</span><span class="p">:</span> <span class="mi">42</span>
         <span class="n">Function</span> <span class="n">evaluations</span><span class="p">:</span> <span class="mi">80</span>
<span class="n">fmin</span><span class="p">:</span> <span class="n">f3</span> <span class="p">[</span><span class="mf">1.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]</span> <span class="o">--&gt;</span> <span class="p">[</span><span class="mf">2.03069759</span> <span class="mf">1.40155333</span><span class="p">]</span>
 <span class="o">-----------------------------------------</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Slides_Optimization_2_Cake.html" class="btn btn-neutral float-right" title="20. Constrained Optimization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Slides_Root.html" class="btn btn-neutral float-left" title="18. Root Finding" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Juergen Jung

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>