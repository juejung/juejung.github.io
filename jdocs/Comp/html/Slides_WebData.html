

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>8. Working with data from the web &mdash; ComputationalEconomicsLectures 1.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="ComputationalEconomicsLectures 1.0 documentation" href="index.html"/>
        <link rel="next" title="9. Random numbers" href="Slides_Random.html"/>
        <link rel="prev" title="7. Working with data" href="Slides_Data.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> ComputationalEconomicsLectures</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Slides_Basics.html">1. A brief introduction to Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Basics.html#installing-python">1.1. Installing Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Basics.html#git-and-github">1.2. Git and Github</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Basics.html#simple-calculations">1.3. Simple calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Basics.html#the-print-function">1.4. The print function</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Basics.html#script-files">1.5. Script files</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Basics.html#ipython-notebook">1.6. iPython Notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Basics.html#lists-tuples-and-dictionaries">1.7. Lists, tuples and dictionaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Basics.html#in-class-exercises">1.8. In class exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Basics.html#homework">1.9. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Loop.html">2. Basic programming techniques</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Loop.html#branching">2.1. Branching</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Loop.html#for-loops">2.2. For loops</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Loop.html#while-loop">2.3. While loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Loop.html#homework">2.4. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Arrays.html">3. Vectors and matrices</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Arrays.html#definitions-of-vectors-and-matrices">3.1. Definitions of vectors and matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Arrays.html#simple-calculations-with-vectors-and-matrices">3.2. Simple calculations with vectors and matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Arrays.html#vector-manipulation">3.3. Vector manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Arrays.html#matrix-manipulation">3.4. Matrix manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Arrays.html#in-class-exercises">3.5. In class exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Arrays.html#homework">3.6. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Plot.html">4. Plotting using <tt class="docutils literal"><span class="pre">matplotlib</span></tt></a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Plot.html#plotting-vectors-and-arrays">4.1. Plotting vectors and arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Plot.html#plotting-functions">4.2. Plotting functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Plot.html#subplots">4.3. Subplots</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Plot.html#dgraphing">4.4. 3DGraphing</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Plot.html#homework">4.5. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Functions.html">5. Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Functions.html#use-simple-user-defined-functions">5.1. Use simple user defined functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Functions.html#advanced-graphing-using-loops-and-functions">5.2. Advanced Graphing using loops and functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Functions.html#in-class-exercises">5.3. In class exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Functions.html#homework">5.4. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_OOP.html">6. Object Oriented Programming</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_OOP.html#introduction">6.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OOP.html#inheritance-and-subclasses">6.2. Inheritance and subclasses</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OOP.html#generating-multiple-objects">6.3. Generating multiple objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OOP.html#homework">6.4. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Data.html">7. Working with data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Data.html#read-in-small-data-set-from-a-comma-separated-csv-file">7.1. Read in small data set from a comma separated (.csv) file</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Data.html#making-simple-graphs-from-our-data">7.2. Making simple graphs from our data</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Data.html#summary-statistics">7.3. Summary statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Data.html#measures-of-linear-relationship">7.4. Measures of linear relationship</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Data.html#homework">7.5. Homework</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">8. Working with data from the web</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#more-tutorials">8.1. More tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="#homework">8.2. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Random.html">9. Random numbers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Random.html#uniformly-distributed-random-numbers">9.1. Uniformly distributed random numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Random.html#normally-distributed-random-numbers">9.2. Normally distributed random numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Random.html#t-distributed-random-variable">9.3. T-distributed random variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Random.html#homework">9.4. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Root.html">10. Root finding</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Root.html#first-steps">10.1. First steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Root.html#newton-raphson">10.2. Newton-Raphson</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Root.html#secant-method">10.3. Secant method</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Root.html#bisection">10.4. Bisection</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Root.html#using-built-in-unit-root-function">10.5. Using built in unit-root function</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Root.html#homework">10.6. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Optimization.html">11. Optimization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Optimization.html#univariate-function-optimization">11.1. Univariate function optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Optimization.html#optimization-methods">11.2. Optimization methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Optimization.html#multivariate-optimization">11.3. Multivariate optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Optimization.html#homework">11.4. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Cake.html">12. The cake eating problem</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#solution">12.1. Solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#formally">12.2. Formally</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#id1">12.3. Formally</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#analytical-solution">12.4. Analytical solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#euler-equation">12.5. Euler equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#solving-the-problem">12.6. Solving the problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#solving-the-problem-analytics">12.7. Solving the problem: analytics</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#plotting-the-solution">12.8. Plotting the solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#numerical-solution">12.9. Numerical solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#function-definitions">12.10. Function definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#plotting-is-achieved-via">12.11. Plotting is achieved via:</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#numerical-solution-in-python">12.12. Numerical solution in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#optimizer-in-optimize-toolbox">12.13. Optimizer in <tt class="docutils literal"><span class="pre">optimize</span></tt> toolbox</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Cake.html#homework">12.14. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_OLG_I.html">13. A simple OLG model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#preferences">13.1. Preferences</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#technology">13.2. Technology</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#government">13.3. Government</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#household-problem">13.4. Household problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#equilibrium-definition">13.5. Equilibrium definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#functional-forms-and-solutions">13.6. Functional forms and solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#substitute-the-budget-set-into-preferences">13.7. Substitute the budget set into preferences</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#solve-for-optimal-household-savings">13.8. Solve for optimal household savings: <span class="math">\(s^*\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#solution">13.9. Solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#equation-system">13.10. Equation system</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#method-1-substituting-everything">13.11. Method 1: Substituting everything</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#one-equation-in-k">13.12. One equation in K</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#aggregate-resource-constraint-arc">13.13. Aggregate resource constraint (ARC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#python-program-1">13.14. Python Program 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#method-2">13.15. Method 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#python-program-2">13.16. Python Program 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_I.html#homework">13.17. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_OLG_II.html">14. An OLG model with labor-leisure choice</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_II.html#preferences">14.1. Preferences</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_II.html#technology">14.2. Technology</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_II.html#government">14.3. Government</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_II.html#household-problem">14.4. Household problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_II.html#equilibrium-definition">14.5. Equilibrium definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_II.html#functional-forms-and-solutions">14.6. Functional forms and solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_II.html#substitute-in-preferences">14.7. Substitute in preferences</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_II.html#solve-for-optimal-and">14.8. Solve for optimal <span class="math">\(s^*\)</span> and <span class="math">\(l^*\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_OLG_II.html#homework">14.9. Homework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Growth.html">15. Growth Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Slides_Growth.html#preferences">15.1. Preferences</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Growth.html#technology">15.2. Technology</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Growth.html#government">15.3. Government</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Growth.html#household-problem">15.4. Household problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Growth.html#equilibrium-definition">15.5. Equilibrium definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Growth.html#functional-forms-and-solutions">15.6. Functional forms and solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Growth.html#substitute-in-preferences">15.7. Substitute in preferences</a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Growth.html#solve-for-optimal-and">15.8. Solve for optimal <span class="math">\(s^*\)</span> and <span class="math">\(l^*\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="Slides_Growth.html#homework">15.9. Homework</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">ComputationalEconomicsLectures</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>8. Working with data from the web</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/Slides_WebData.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="working-with-data-from-the-web">
<h1>8. Working with data from the web<a class="headerlink" href="#working-with-data-from-the-web" title="Permalink to this headline">¶</a></h1>
<p>When you try to scrape or harvest data from the internet it is useful to know
the basics of <a class="reference external" href="http://www.google.com/search?q=what+is+html">html</a> which is
the markup language that is used to create websites. You can look at the source
code of a website in your browser. Simply right click (if on Windows) and click
on view frame source. When we download information from the web, we usually
download this source code and then run
a <a class="reference external" href="http://www.google.com/search?q=what+is+a_parser">parser</a>
over the html source code to extract information.</p>
<p>The Python library <tt class="docutils literal"><span class="pre">BeautifulSoup</span></tt> helps us parsing out the information from
the html-data that we get after downloading the web page. The additional
library <tt class="docutils literal"><span class="pre">request</span></tt> allows us to download source codes from websites. We
therefore first need to import these two libraries.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">re</span>
</pre></div>
</div>
<p>The first package allows us to open web pages and the second, <tt class="docutils literal"><span class="pre">BeautifulSoup</span></tt>
parses the html code and stores it in an easily accessible database format, or
object. This object has methods that are tailor made to extract information
from the html code of the website that we scrape from.
The other two packages are Pandas and
<a class="reference external" href="http://www.google.com/search?q=what+are+regular+expressions">Regular Expressions</a>.
The latter is useful for pattern matching as you will see below.</p>
<p>In this exercise we will download all video links from the
<a class="reference external" href="https://www.youtube.com/">YouTube</a> starting page. We will extract the title
for each video, its number of views, likes and dislikes. We then store
everything in a Pandas dataframe for further statistical analysis.</p>
<p>We first define the YouTube URL and assign it to a variable.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Define url to Youtube</span>
<span class="n">jurl</span> <span class="o">=</span> <span class="s">&#39;https://www.youtube.com/&#39;</span>
</pre></div>
</div>
<p>We next open the Youtube site and read the page&#8217;s html code and assign it to
the variable html.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">html</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">jurl</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
<p>We then assign the html code to the BeautifulSoup data format which allows us
to sort through the html code more systematically.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">,</span> <span class="s">&#39;ignore&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>We next run a loop and extract all featured video links. First check
the source code of the YouTube page and convince yourself that
the links to the videos are all part of the
<a class="reference external" href="http://www.google.com/search?q=what+is+a+CSS+class">CSS class</a>:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;div class=&quot;yt-lockup-content&quot;&gt;
</pre></div>
</div>
<p>Also not that the actual links to the video all start with the html tag:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;a href=&quot;/watch
</pre></div>
</div>
<p>We next define an empty list so we can store all the links to the videos and
then run a loop through the html source code and extract all links that start
with <tt class="docutils literal"><span class="pre">&lt;a</span> <span class="pre">href=&quot;/watch</span></tt>. We append all these links to the <tt class="docutils literal"><span class="pre">link_list</span></tt> list.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">link_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s">&#39;div.yt-lockup-content a[href^=/watch]&#39;</span><span class="p">):</span>
    <span class="c"># Store all links in a list</span>
    <span class="n">newLink</span> <span class="o">=</span> <span class="n">link</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;href&#39;</span><span class="p">)</span>
    <span class="n">link_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newLink</span><span class="p">)</span>
</pre></div>
</div>
<p>Let&#8217;s print the first 5 entries of the list</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">print</span><span class="p">(</span><span class="n">newLink</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>/watch
</pre></div>
</div>
<p>We then create an empty data frame that has the same number of rows as our
list. In addition we add empty columns so that we can store the title, view,
like and dislike information later on.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">index</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">link_list</span><span class="p">))</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Links&#39;</span><span class="p">,</span> <span class="s">&#39;Title&#39;</span><span class="p">,</span> <span class="s">&#39;Views&#39;</span><span class="p">,</span> <span class="s">&#39;Likes&#39;</span><span class="p">,</span> <span class="s">&#39;Dislikes&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
<p>We next assign the <tt class="docutils literal"><span class="pre">link_list</span></tt> with all the video links to the dataframe.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">df</span><span class="p">[</span><span class="s">&#39;Links&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">link_list</span>
<span class="n">df</span><span class="p">[</span><span class="s">&#39;Links&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">jurl</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s">&#39;Links&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>We then start the loop that runs through our list of video links and opens each
one separately in a webpage. We than grab the title, number of views, number of
likes and number of dislikes and store these data in the current row of our
dataframe.
We use <strong>regular expressions</strong> to find the numbers of views, likes and dislikes
in the text string that is generated by the <tt class="docutils literal"><span class="pre">soup.select()</span></tt> and
<tt class="docutils literal"><span class="pre">soup.find_all()</span></tt> functions.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">link_list</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span> <span class="ow">or</span> <span class="n">i</span><span class="o">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">link_list</span><span class="p">)</span><span class="o">-</span><span class="mi">5</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;{} out of {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">link_list</span><span class="p">)))</span>

    <span class="c"># Open first youtube video link</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">&#39;Links&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="c"># Assign it to Soup object</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">,</span> <span class="s">&#39;ignore&#39;</span><span class="p">))</span>

    <span class="c"># Extract info and store in dataframe</span>
    <span class="n">df</span><span class="p">[</span><span class="s">&#39;Title&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>
    <span class="n">df</span><span class="p">[</span><span class="s">&#39;Views&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">&#39;[^0-9]&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">,</span> \
      <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s">&#39;.watch-view-count&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>

    <span class="c"># Extracting number of likes</span>
    <span class="n">a</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">&#39;button&#39;</span><span class="p">,</span> \
      <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;title&#39;</span><span class="p">:</span> <span class="s">&#39;I like this&#39;</span><span class="p">}))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;,&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s">&#39;Likes&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">r&#39;\d+&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c"># Extracting number of dislikes</span>
    <span class="n">a</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">&#39;button&#39;</span><span class="p">,</span> \
      <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;title&#39;</span><span class="p">:</span> <span class="s">&#39;I dislike this&#39;</span><span class="p">}))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;,&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s">&#39;Dislikes&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>  <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">r&#39;\d+&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>0 out of 204
1 out of 204
2 out of 204
3 out of 204
4 out of 204
200 out of 204
201 out of 204
202 out of 204
203 out of 204
</pre></div>
</div>
<p>We finally sort the data according to number of views, starting with the most
viewed video and print the first couple of entries:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s">&#39;Views&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>                                            Links  \
26   https://www.youtube.com//watch?v=nfWlot6h_JM
186  https://www.youtube.com//watch?v=nfWlot6h_JM
181  https://www.youtube.com//watch?v=e-ORhEE9VVg
45   https://www.youtube.com//watch?v=p1JPKLa-Ofc
49   https://www.youtube.com//watch?v=VBmMU_iwe6U

                                                 Title      Views
Likes  \
26               Taylor Swift - Shake It Off - YouTube  443341262
2192969
186              Taylor Swift - Shake It Off - YouTube  443341262
2192975
181               Taylor Swift - Blank Space - YouTube  298494329
1975711
45   Beyoncé - Drunk in Love (Explicit) ft. JAY Z -...  244913910
969099
49           Beyoncé - Run the World (Girls) - YouTube  243250692
705776

    Dislikes
26    269992
186   269993
181   121129
45     99443
49    128237
</pre></div>
</div>
<div class="section" id="more-tutorials">
<h2>8.1. More tutorials<a class="headerlink" href="#more-tutorials" title="Permalink to this headline">¶</a></h2>
<p>Here are additional web tutorials about Python web scraping that you can check
out:</p>
<blockquote>
<div><ul class="simple">
<li>Scraping URLs from the Pycon 2014 Conference by
<a class="reference external" href="http://blog.miguelgrinberg.com/post/easy-web-scraping-with-python">Miguel Grinberg</a>.</li>
<li>A <a class="reference external" href="https://www.youtube.com/watch?v=3xQTJi2tqgk">youtube tutorial</a> for web scraping with Python.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="homework">
<h2>8.2. Homework<a class="headerlink" href="#homework" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="Lecture_WebData/Homework/Homework_WebData.html"><em>Homework</em></a></p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Slides_Random.html" class="btn btn-neutral float-right" title="9. Random numbers"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Slides_Data.html" class="btn btn-neutral" title="7. Working with data"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Juergen Jung.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>