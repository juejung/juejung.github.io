

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>13. Working with Data from the Web I &mdash; Computational Economics 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="14. Working with Data from the Web II" href="Slides_WebData_2.html" />
    <link rel="prev" title="12. Working with Data III: Case Study" href="Slides_Data_3.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Computational Economics
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Slides_CourseAdministration.html">1. Course Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Basics.html">2. First Steps in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_DataStructures.html">3. Python Data Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Loop.html">4. Basic Programming Techniques</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Debugging.html">5. Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Arrays.html">6. Vectors and Matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Plot.html">7. Plotting using <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Functions.html">8. Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_OOP.html">9. Object Oriented Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Data_1.html">10. Working with Data I: Data Cleaning</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Data_2.html">11. Working with Data II: Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Data_3.html">12. Working with Data III: Case Study</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">13. Working with Data from the Web I</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#beautiful-soup-library">13.1. Beautiful Soup Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="#scraping-youtube">13.2. Scraping YouTube</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">13.2.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#extracting-information-from-html-code">13.2.2. Extracting Information from html Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#storing-information-in-a-dataframe">13.2.3. Storing Information in a DataFrame</a></li>
<li class="toctree-l3"><a class="reference internal" href="#extract-the-view-count-for-the-first-video">13.2.4. Extract the View Count for the First Video</a></li>
<li class="toctree-l3"><a class="reference internal" href="#extract-the-likes-and-dislikes-for-the-first-video">13.2.5. Extract the Likes and Dislikes for the First Video</a></li>
<li class="toctree-l3"><a class="reference internal" href="#extract-remaining-video-info-using-loop">13.2.6. Extract Remaining Video Info Using Loop</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-deal-with-errors">13.3. How to Deal with Errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#more-tutorials">13.4. More Tutorials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Slides_WebData_2.html">14. Working with Data from the Web II</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_RegularExpressions.html">15. Regular Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Random.html">16. Random Numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Random2.html">17. Random Numbers II: An Infectious Disease Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Root.html">18. Root Finding</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Optimization_1.html">19. Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Optimization_2_Cake.html">20. Constrained Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_MachineLearning_1.html">21. Machine Learning I: Introduction to Machine Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_MachineLearning_2.html">22. Machine Learning II: Categorization Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_OLG_I.html">23. A Simple OLG Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_OLG_II.html">24. An OLG Model with Labor-Leisure Choice</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Growth.html">25. Growth Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="Slides_Assignments.html">26. Assignments</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Computational Economics</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li><span class="section-number">13. </span>Working with Data from the Web I</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Slides_WebData.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="working-with-data-from-the-web-i">
<h1><span class="section-number">13. </span>Working with Data from the Web I<a class="headerlink" href="#working-with-data-from-the-web-i" title="Permalink to this headline">¶</a></h1>
<div class="sidebar" id="web-i">
<p class="sidebar-title">Section Learning Objectives</p>
<blockquote>
<div><ul class="simple">
<li><p>BeautifulSoup Library</p></li>
<li><p>Scraping Youtube</p></li>
<li><p>Dealing with Errors</p></li>
</ul>
</div></blockquote>
</div>
<p>When you try to scrape or “harvest” data from the web it is useful to know
the basics of <a class="reference external" href="http://www.google.com/search?q=what+is+html">html</a> which is
the markup language that is used to create websites. A browser interprets the
html code and shows you the formatted website.</p>
<p>When we download information from the web, we usually
download this source code and then run
a <a class="reference external" href="http://www.google.com/search?q=what+is+a_parser">parser</a>
over the html source code to extract information.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can look at the source
code with all the html-tags of a website in your browser. Simply right click (if on Windows) and click
on view frame source or view page source, depending on your browser.</p>
</div>
<span class="target" id="index-0"></span><div class="section" id="beautiful-soup-library">
<h2><span class="section-number">13.1. </span>Beautiful Soup Library<a class="headerlink" href="#beautiful-soup-library" title="Permalink to this headline">¶</a></h2>
<p>The Python library <code class="docutils literal notranslate"><span class="pre">BeautifulSoup</span></code> helps us parsing out the information from
the html-data that we get after downloading the web page. The additional
library <code class="docutils literal notranslate"><span class="pre">request</span></code> allows us to download source codes from websites. We
therefore first need to import these two libraries.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">re</span>
</pre></div>
</div>
<p>The first package allows us to open web pages and the second, <code class="docutils literal notranslate"><span class="pre">BeautifulSoup</span></code>
parses the html code and stores it in an easily accessible database format, or
object. This object has methods that are tailor made to extract information
from the html code of the website that we scrape from.
The other two packages are Pandas and
<a class="reference external" href="http://www.google.com/search?q=what+are+regular+expressions">Regular Expressions</a>.
The latter is useful for pattern matching as you will see below. See also the
chapter on Regular Expressions in these lecture notes.</p>
</div>
<div class="section" id="scraping-youtube">
<h2><span class="section-number">13.2. </span>Scraping YouTube<a class="headerlink" href="#scraping-youtube" title="Permalink to this headline">¶</a></h2>
<div class="section" id="introduction">
<h3><span class="section-number">13.2.1. </span>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h3>
<p>In this exercise we will download all video links from the
<a class="reference external" href="https://www.youtube.com/">YouTube</a> starting page. We will extract the title
for each video, its number of views, likes and dislikes. We then store
everything in a Pandas dataframe for further statistical analysis.</p>
<p>We first define the YouTube URL and assign it to a variable.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define url to Youtube</span>
<span class="n">jurl</span> <span class="o">=</span> <span class="s1">&#39;https://www.youtube.com/&#39;</span>
</pre></div>
</div>
<p>We next open the Youtube site and read the page’s html code and assign it to
the variable html.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">html</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">jurl</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
<p>We then assign the html code to the BeautifulSoup data format which allows us
to sort through the html code more systematically.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="s1">&#39;ignore&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You may see a warning message about a file parser extension. On
Windows you could try:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="s1">&#39;ignore&#39;</span><span class="p">),</span> <span class="s2">&quot;lxml&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>or alternatively:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="s1">&#39;ignore&#39;</span><span class="p">),</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>or also:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="s1">&#39;ignore&#39;</span><span class="p">),</span> <span class="n">features</span><span class="o">=</span><span class="s2">&quot;lxml&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="extracting-information-from-html-code">
<h3><span class="section-number">13.2.2. </span>Extracting Information from html Code<a class="headerlink" href="#extracting-information-from-html-code" title="Permalink to this headline">¶</a></h3>
<p>Next  look at the source code of the YouTube webpage (right click on the webpage
and select <code class="docutils literal notranslate"><span class="pre">View</span> <span class="pre">page</span> <span class="pre">source</span></code>) and convince yourself that
the links to the videos are all part of the
<a class="reference external" href="http://www.google.com/search?q=what+is+a+CSS+class">CSS class</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">a</span> <span class="n">aria</span><span class="o">-</span><span class="n">hidden</span><span class="o">=</span><span class="s2">&quot;true&quot;</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;yt-uix-sessionlink spf-link&quot;</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>If you inspect this <strong>soup</strong> object it is a bit easier to see that all videos are part of a
link class that starts with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">a</span> <span class="n">aria</span><span class="o">-</span><span class="n">hidden</span><span class="o">=</span><span class="s2">&quot;true&quot;</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;yt-uix-sessionlink spf-link&quot;</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Where <strong>&lt;a&gt;</strong> is the ancor element that starts a section that contains a link.
A typical html code with a link would look something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;http://example.com/&quot;</span><span class="o">&gt;</span><span class="n">Link</span> <span class="n">to</span> <span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">href</span></code> stands for hyper reference (or link) and the <strong>&lt;/a&gt;</strong> at the end
of the line closes the link section. That is <strong>&lt;a …&gt;</strong> is the opening tag and
<strong>/a&gt;</strong> is the closing tag.</p>
</div>
<p>Also not that the actual links to the video all start with the html tag:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">href</span><span class="o">=</span><span class="s2">&quot;/watch?v= ... &quot;</span>
</pre></div>
</div>
<p>where instead of the “…” you will see a code for a particular video such as
<code class="docutils literal notranslate"><span class="pre">-6BvA4U1dLI</span></code>.</p>
<p>We next extract all these <code class="docutils literal notranslate"><span class="pre">a</span></code> sections from the <code class="docutils literal notranslate"><span class="pre">soup</span></code> object. We limit the
extraction of link sections to particular <code class="docutils literal notranslate"><span class="pre">a</span></code> sections that contain the
actual links to videos as opposed to other links that are also part of the html
code of YouTube’s starting site. Since we observed above, that the links are
actually part of a specific <code class="docutils literal notranslate"><span class="pre">a</span></code> class that has the attributes ‘aria-hidden’
as ‘true’ and ‘class’ as ‘yt-uix-sessionlink spf-link’ we will filter for these
particular <cite>a</cite> sections next.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">linkSections</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;aria-hidden&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span> <span class="s1">&#39;class&#39;</span><span class="p">:</span><span class="s1">&#39;yt-uix-sessionlink spf-link&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>We can now  define an empty list so we can store all the links to the videos and
then run a loop through the html source code and extract all links that start
with <code class="docutils literal notranslate"><span class="pre">href=&quot;/watch?v=&gt;</span></code>. We append all these links to the <code class="docutils literal notranslate"><span class="pre">link_list</span></code> list.</p>
<p>Let us test this first before we run a loop. Let’s have a look at the first
element of our extracted list.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">linkSections</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">a</span> <span class="n">aria</span><span class="o">-</span><span class="n">hidden</span><span class="o">=</span><span class="s2">&quot;true&quot;</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;yt-uix-sessionlink spf-link&quot;</span> <span class="n">data</span><span class="o">-</span>
<span class="n">sessionlink</span><span class="o">=</span><span class="s2">&quot;itct=CE8QlDUYDCITCLnPhtOJw-</span>
<span class="n">gCFQq8wQodiykNfzIKZy1oaWdoLXRydloPRkV3aGF0X3RvX3dhdGNo</span><span class="s2">&quot;</span>
<span class="n">href</span><span class="o">=</span><span class="s2">&quot;/watch?v=BqbfT5r-DzA&quot;</span><span class="o">&gt;&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;yt-thumb video-thumb&quot;</span><span class="o">&gt;&lt;</span><span class="n">span</span>
<span class="n">class</span><span class="o">=</span><span class="s2">&quot;yt-thumb-simple&quot;</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">img</span> <span class="n">alt</span><span class="o">=</span><span class="s2">&quot;&quot;</span> <span class="n">data</span><span class="o">-</span>
<span class="n">thumb</span><span class="o">=</span><span class="s2">&quot;https://i.ytimg.com/vi/BqbfT5r-DzA/hqdefault.jpg?sqp=-oaymwEiCMQBEG5IWvKriqkDFQgBFQAAAAAYASUAAMhCPQCAokN4AQ==&amp;amp;rs=AOn4CLCXRKXynrkq7kA90QUE7SIWtRpaBw&quot;</span>
<span class="n">data</span><span class="o">-</span><span class="n">ytimg</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="n">height</span><span class="o">=</span><span class="s2">&quot;110&quot;</span> <span class="n">onload</span><span class="o">=</span><span class="s2">&quot;;window.__ytRIL &amp;amp;&amp;amp;</span>
<span class="n">__ytRIL</span><span class="p">(</span><span class="n">this</span><span class="p">)</span><span class="s2">&quot; src=&quot;</span><span class="o">/</span><span class="n">yts</span><span class="o">/</span><span class="n">img</span><span class="o">/</span><span class="n">pixel</span><span class="o">-</span><span class="n">vfl3z5WfW</span><span class="o">.</span><span class="n">gif</span><span class="s2">&quot; width=&quot;</span><span class="mi">196</span><span class="s2">&quot;/&gt;</span>
<span class="o">&lt;</span><span class="n">span</span> <span class="n">aria</span><span class="o">-</span><span class="n">hidden</span><span class="o">=</span><span class="s2">&quot;true&quot;</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;video-</span>
<span class="n">time</span><span class="s2">&quot;&gt;2:10&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;/a&gt;</span>
</pre></div>
</div>
<p>Next let us have a look at the link to the video in that section.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">linkSections</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;href&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>/watch?v=BqbfT5r-DzA
</pre></div>
</div>
<p>If we combine this with <code class="docutils literal notranslate"><span class="pre">https://www.youtube.com/</span></code> that we have already
stored in variable <code class="docutils literal notranslate"><span class="pre">jurl</span></code> we have the complete html link to the video that we
can copy/paste into a browser.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">link_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">linkSections</span><span class="p">:</span>
    <span class="c1"># Store all links in a list</span>
    <span class="n">newLink</span> <span class="o">=</span> <span class="n">link</span><span class="p">[</span><span class="s1">&#39;href&#39;</span><span class="p">]</span>
    <span class="n">link_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newLink</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s print the first 5 entries of the list</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">link_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;/watch?v=BqbfT5r-DzA&#39;</span><span class="p">,</span> <span class="s1">&#39;/watch?v=4wS4PYnWSrw&#39;</span><span class="p">,</span>
<span class="s1">&#39;/watch?v=l3Rm8avK6kM&#39;</span><span class="p">,</span> <span class="s1">&#39;/watch?v=EoLQUdt8xsk&#39;</span><span class="p">,</span>
<span class="s1">&#39;/watch?v=2AdUsBwuJSk&#39;</span><span class="p">,</span> <span class="s1">&#39;/watch?v=BWb8YqAVTgw&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="storing-information-in-a-dataframe">
<h3><span class="section-number">13.2.3. </span>Storing Information in a DataFrame<a class="headerlink" href="#storing-information-in-a-dataframe" title="Permalink to this headline">¶</a></h3>
<p>We then create an empty data frame that has the same number of rows as our
list. In addition we add empty columns so that we can store the title, view,
like and dislike information later on.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">link_list</span><span class="p">))</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Links&#39;</span><span class="p">,</span> <span class="s1">&#39;Title&#39;</span><span class="p">,</span> <span class="s1">&#39;Views&#39;</span><span class="p">,</span> <span class="s1">&#39;Likes&#39;</span><span class="p">,</span> <span class="s1">&#39;Dislikes&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
<p>We next assign the <code class="docutils literal notranslate"><span class="pre">link_list</span></code> with all the video links to the dataframe.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Links&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">link_list</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Links&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">jurl</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Links&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>We then start the loop that runs through our list of video links and opens each
one separately in a webpage. We then grab the title, number of views, number of
likes and number of dislikes and store these data in the current row of our
dataframe.</p>
<p>We use <strong>regular expressions</strong> to find the numbers of views, likes and dislikes
in the text string that is generated by the <code class="docutils literal notranslate"><span class="pre">soup.select()</span></code> and
<code class="docutils literal notranslate"><span class="pre">soup.find_all()</span></code> functions.</p>
<p>The term <code class="docutils literal notranslate"><span class="pre">r'\d+'</span></code> is a <strong>regular expression</strong> syntax. Think of it as a
pattern, that we search for in the html-code of the website.
The letter <code class="docutils literal notranslate"><span class="pre">d</span></code> stands for digit. The plus sign that follows it indicates that
the numbers we are looking for can be comprised of one or more digits. Have a
look at the textbook chapter on regular expressions.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The following code might not run all the way through. The reason is that
sometimes when you try to open a website with a crawler script, you may run
into a server side issue where the website cannot be accessed for a split
second in which case the line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">html</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Links&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
<p>in the script below will return an empty object. The script then tries to
read from this object which then ends up in errors such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">IndexError</span><span class="p">:</span> <span class="nb">list</span> <span class="n">index</span> <span class="n">out</span> <span class="n">of</span> <span class="nb">range</span>
</pre></div>
</div>
<p>We learn how to deal with such issues in the next section.</p>
</div>
</div>
<div class="section" id="extract-the-view-count-for-the-first-video">
<h3><span class="section-number">13.2.4. </span>Extract the View Count for the First Video<a class="headerlink" href="#extract-the-view-count-for-the-first-video" title="Permalink to this headline">¶</a></h3>
<p>Let us now start with the link to the first video. We again read in the html
code and decode it as a soup object.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># Open first youtube video link</span>
<span class="n">html</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Links&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="c1"># Assign it to Soup object</span>
<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="s1">&#39;ignore&#39;</span><span class="p">))</span>
<span class="c1"># To suppress error specify the filter explicitly.</span>
<span class="c1">#soup = BeautifulSoup(html.decode(&#39;utf-8&#39;, &#39;ignore&#39;), features=&quot;lxml&quot;)</span>
</pre></div>
</div>
<p>We first extract the title. This is such a common thing that it is
pre-programmed as a function in of the Beautiful Soup library.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract info and store in dataframe</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Title&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>
</pre></div>
</div>
<p>We are next looking for the information about the view counts. This requires a
bit of detective works. After staring at the html code for a bit we find that
the number of views is embedded in an html block with the keywork
<code class="docutils literal notranslate"><span class="pre">.watch-view-count'</span></code>. We use this info and select the block of text where
this occurs.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;.watch-view-count&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;watch-view-count&quot;</span><span class="o">&gt;</span><span class="mi">448</span><span class="p">,</span><span class="mi">950</span> <span class="n">views</span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span><span class="p">]</span>
</pre></div>
</div>
<p>This returns a list, so let us just grab the content (first entry) of this
list.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;.watch-view-count&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;watch-view-count&quot;</span><span class="o">&gt;</span><span class="mi">448</span><span class="p">,</span><span class="mi">950</span> <span class="n">views</span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Now let us just get the text between the html tags using the <code class="docutils literal notranslate"><span class="pre">get_text()</span></code>
function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;.watch-view-count&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_text</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">448</span><span class="p">,</span><span class="mi">950</span> <span class="n">views</span>
</pre></div>
</div>
<p>Ok, our number is in there. Let us now split this string into separate strings
so that we can grab our number more easily.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;.watch-view-count&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;448,950&#39;</span><span class="p">,</span> <span class="s1">&#39;views&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Almost there, grab the first element of this list.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;.watch-view-count&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">448</span><span class="p">,</span><span class="mi">950</span>
</pre></div>
</div>
<p>Now we use Regular Expressions and search for everything that is not a number
and replace that with nothing. In other words you delete everything that is not
a number or digit.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;[^0-9]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;.watch-view-count&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">448950</span>
</pre></div>
</div>
<p>This is still a string, so let us retype it as an integer number so we can
assign it into our dataframe and do math with it.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;[^0-9]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;.watch-view-count&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">])))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">448950</span>
</pre></div>
</div>
<p>And finally stick it into our dataframe in the <code class="docutils literal notranslate"><span class="pre">Views</span></code> column at row zero,
which is the first row.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Views&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;[^0-9]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> \
            <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;.watch-view-count&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
<p>Let us have a quick look at the dataframe to see whether it has been stored in
the correct position.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                                          Links  \
0  https://www.youtube.com//watch?v=BqbfT5r-DzA
1  https://www.youtube.com//watch?v=4wS4PYnWSrw
2  https://www.youtube.com//watch?v=l3Rm8avK6kM
3  https://www.youtube.com//watch?v=EoLQUdt8xsk
4  https://www.youtube.com//watch?v=2AdUsBwuJSk

                                               Title   Views Likes
Dislikes
0  Trump extends coronavirus guidelines until Apr...  448950   NaN
NaN
1                                                NaN     NaN   NaN
NaN
2                                                NaN     NaN   NaN
NaN
3                                                NaN     NaN   NaN
NaN
4                                                NaN     NaN   NaN
NaN
</pre></div>
</div>
</div>
<div class="section" id="extract-the-likes-and-dislikes-for-the-first-video">
<h3><span class="section-number">13.2.5. </span>Extract the Likes and Dislikes for the First Video<a class="headerlink" href="#extract-the-likes-and-dislikes-for-the-first-video" title="Permalink to this headline">¶</a></h3>
<p>Next we do a similar procedure extracting the “likes” information. After some
digging in the html code of the web page we find that the “likes” information
is in a text block with the <code class="docutils literal notranslate"><span class="pre">button</span></code> tag and the button title “I like this”.
We use this in the <code class="docutils literal notranslate"><span class="pre">find_all()</span></code> method of the <code class="docutils literal notranslate"><span class="pre">soup</span></code> object we have created
above.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extracting number of likes</span>
<span class="nb">print</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;button&#39;</span><span class="p">,</span> \
  <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;I like this&#39;</span><span class="p">}))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">&lt;</span><span class="n">button</span> <span class="n">aria</span><span class="o">-</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;like this video along with 4,457 other people&quot;</span>
<span class="n">class</span><span class="o">=</span><span class="s2">&quot;yt-uix-button yt-uix-button-size-default yt-uix-button-opacity</span>
<span class="n">yt</span><span class="o">-</span><span class="n">uix</span><span class="o">-</span><span class="n">button</span><span class="o">-</span><span class="n">has</span><span class="o">-</span><span class="n">icon</span> <span class="n">no</span><span class="o">-</span><span class="n">icon</span><span class="o">-</span><span class="n">markup</span> <span class="n">like</span><span class="o">-</span><span class="n">button</span><span class="o">-</span><span class="n">renderer</span><span class="o">-</span><span class="n">like</span><span class="o">-</span><span class="n">button</span>
<span class="n">like</span><span class="o">-</span><span class="n">button</span><span class="o">-</span><span class="n">renderer</span><span class="o">-</span><span class="n">like</span><span class="o">-</span><span class="n">button</span><span class="o">-</span><span class="n">unclicked</span> <span class="n">yt</span><span class="o">-</span><span class="n">uix</span><span class="o">-</span><span class="n">clickcard</span><span class="o">-</span><span class="n">target</span> <span class="n">yt</span><span class="o">-</span>
<span class="n">uix</span><span class="o">-</span><span class="n">tooltip</span><span class="s2">&quot; data-force-position=&quot;</span><span class="n">true</span><span class="s2">&quot; data-orientation=&quot;</span><span class="n">vertical</span><span class="s2">&quot;</span>
<span class="n">data</span><span class="o">-</span><span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottomright&quot;</span> <span class="n">onclick</span><span class="o">=</span><span class="s2">&quot;;return false;&quot;</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;I like</span>
<span class="n">this</span><span class="s2">&quot; type=&quot;</span><span class="n">button</span><span class="s2">&quot;&gt;&lt;span class=&quot;</span><span class="n">yt</span><span class="o">-</span><span class="n">uix</span><span class="o">-</span><span class="n">button</span><span class="o">-</span>
<span class="n">content</span><span class="s2">&quot;&gt;4,457&lt;/span&gt;&lt;/button&gt;]</span>
</pre></div>
</div>
<p>We almost have it. Let us get rid of the comma using the <code class="docutils literal notranslate"><span class="pre">replace()</span></code>
function. This function only works on strings, so we need to re-type the number
we just had as a string using the <code class="docutils literal notranslate"><span class="pre">str()</span></code> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;button&#39;</span><span class="p">,</span> \
  <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;I like this&#39;</span><span class="p">}))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">&lt;</span><span class="n">button</span> <span class="n">aria</span><span class="o">-</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;like this video along with 4457 other people&quot;</span>
<span class="n">class</span><span class="o">=</span><span class="s2">&quot;yt-uix-button yt-uix-button-size-default yt-uix-button-opacity</span>
<span class="n">yt</span><span class="o">-</span><span class="n">uix</span><span class="o">-</span><span class="n">button</span><span class="o">-</span><span class="n">has</span><span class="o">-</span><span class="n">icon</span> <span class="n">no</span><span class="o">-</span><span class="n">icon</span><span class="o">-</span><span class="n">markup</span> <span class="n">like</span><span class="o">-</span><span class="n">button</span><span class="o">-</span><span class="n">renderer</span><span class="o">-</span><span class="n">like</span><span class="o">-</span><span class="n">button</span>
<span class="n">like</span><span class="o">-</span><span class="n">button</span><span class="o">-</span><span class="n">renderer</span><span class="o">-</span><span class="n">like</span><span class="o">-</span><span class="n">button</span><span class="o">-</span><span class="n">unclicked</span> <span class="n">yt</span><span class="o">-</span><span class="n">uix</span><span class="o">-</span><span class="n">clickcard</span><span class="o">-</span><span class="n">target</span> <span class="n">yt</span><span class="o">-</span>
<span class="n">uix</span><span class="o">-</span><span class="n">tooltip</span><span class="s2">&quot; data-force-position=&quot;</span><span class="n">true</span><span class="s2">&quot; data-orientation=&quot;</span><span class="n">vertical</span><span class="s2">&quot;</span>
<span class="n">data</span><span class="o">-</span><span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottomright&quot;</span> <span class="n">onclick</span><span class="o">=</span><span class="s2">&quot;;return false;&quot;</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;I like</span>
<span class="n">this</span><span class="s2">&quot; type=&quot;</span><span class="n">button</span><span class="s2">&quot;&gt;&lt;span class=&quot;</span><span class="n">yt</span><span class="o">-</span><span class="n">uix</span><span class="o">-</span><span class="n">button</span><span class="o">-</span>
<span class="n">content</span><span class="s2">&quot;&gt;4457&lt;/span&gt;&lt;/button&gt;]</span>
</pre></div>
</div>
<p>Let us store this whole thing as variable <code class="docutils literal notranslate"><span class="pre">a</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;button&#39;</span><span class="p">,</span> \
  <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;I like this&#39;</span><span class="p">}))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now let us just get the digits so that we can build our number again. Remember
right now it is a string (i.e., a “word”) that we cannot do math with. So let’s
look for all the digits of the number using Regular Expressions and then change
or re-type it into a floating point number (i.e., a decimal number) using the
<code class="docutils literal notranslate"><span class="pre">float()</span></code> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d+&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d+&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;4457&#39;</span><span class="p">,</span> <span class="s1">&#39;4457&#39;</span><span class="p">]</span>
<span class="mf">4457.0</span>
</pre></div>
</div>
<p>Here is the entire thing for “likes” and “dislikes” which works in an identical
way.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extracting number of likes</span>
<span class="n">a</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;button&#39;</span><span class="p">,</span> \
  <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;I like this&#39;</span><span class="p">}))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Likes&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d+&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Extracting number of dislikes</span>
<span class="n">a</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;button&#39;</span><span class="p">,</span> \
  <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;I dislike this&#39;</span><span class="p">}))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Dislikes&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>  <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d+&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>Let us have a look at the dataframe again.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                                          Links  \
0  https://www.youtube.com//watch?v=BqbfT5r-DzA
1  https://www.youtube.com//watch?v=4wS4PYnWSrw
2  https://www.youtube.com//watch?v=l3Rm8avK6kM
3  https://www.youtube.com//watch?v=EoLQUdt8xsk
4  https://www.youtube.com//watch?v=2AdUsBwuJSk

                                               Title   Views Likes
Dislikes
0  Trump extends coronavirus guidelines until Apr...  448950  4457
794
1                                                NaN     NaN   NaN
NaN
2                                                NaN     NaN   NaN
NaN
3                                                NaN     NaN   NaN
NaN
4                                                NaN     NaN   NaN
NaN
</pre></div>
</div>
<p>Finally, here is  the entire code that extracts all the information for the
first video:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># First video i.e., first element of the Links column in dataframe</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Open first youtube video link</span>
<span class="n">html</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Links&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="c1"># Assign it to Soup object</span>
<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="s1">&#39;ignore&#39;</span><span class="p">),</span> <span class="n">features</span><span class="o">=</span><span class="s2">&quot;lxml&quot;</span><span class="p">)</span>

<span class="c1"># Extract info and store in dataframe</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Title&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>

<span class="c1"># Extract number of views</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Views&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;[^0-9]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> \
    <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;.watch-view-count&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>

<span class="c1"># Extracting number of likes</span>
<span class="n">a</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;button&#39;</span><span class="p">,</span> \
    <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;I like this&#39;</span><span class="p">}))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Likes&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d+&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Extracting number of dislikes</span>
<span class="n">a</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;button&#39;</span><span class="p">,</span> \
    <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;I dislike this&#39;</span><span class="p">}))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Dislikes&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>  <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d+&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="extract-remaining-video-info-using-loop">
<h3><span class="section-number">13.2.6. </span>Extract Remaining Video Info Using Loop<a class="headerlink" href="#extract-remaining-video-info-using-loop" title="Permalink to this headline">¶</a></h3>
<p>We finally scrape all the other videos in the same way. In order to make this a
bit nicer we simply put it into a loop.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">link_list</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span> <span class="ow">or</span> <span class="n">i</span><span class="o">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">link_list</span><span class="p">)</span><span class="o">-</span><span class="mi">5</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> out of </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">link_list</span><span class="p">)))</span>

    <span class="c1"># Open first youtube video link</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Links&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="c1"># Assign it to Soup object</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="s1">&#39;ignore&#39;</span><span class="p">))</span>

    <span class="c1"># Extract info and store in dataframe</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Title&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Views&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;[^0-9]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> \
      <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;.watch-view-count&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>

    <span class="c1"># Extracting number of likes</span>
    <span class="n">a</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;button&#39;</span><span class="p">,</span> \
      <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;I like this&#39;</span><span class="p">}))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Likes&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d+&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Extracting number of dislikes</span>
    <span class="n">a</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;button&#39;</span><span class="p">,</span> \
      <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;I dislike this&#39;</span><span class="p">}))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Dislikes&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>  <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d+&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span><span class="ne">TypeError</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span><span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">003</span><span class="n">d55c96af3</span><span class="o">&gt;</span> <span class="ow">in</span>
<span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">link_list</span><span class="p">)):</span>
      <span class="mi">2</span>     <span class="k">if</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span> <span class="ow">or</span> <span class="n">i</span><span class="o">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">link_list</span><span class="p">)</span><span class="o">-</span><span class="mi">5</span><span class="p">:</span>
      <span class="mi">3</span>         <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> out of </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">link_list</span><span class="p">)))</span>
      <span class="mi">4</span>
      <span class="mi">5</span>     <span class="c1"># Open first youtube video link</span>
<span class="ne">TypeError</span><span class="p">:</span> <span class="nb">len</span><span class="p">()</span> <span class="n">takes</span> <span class="n">exactly</span> <span class="n">one</span> <span class="n">argument</span> <span class="p">(</span><span class="mi">2</span> <span class="n">given</span><span class="p">)</span>
</pre></div>
</div>
<p>This may have resulted in an error if there was a server issues for one of the
many videos we tried to scrape. Do not worry. We will fix this now.</p>
</div>
</div>
<div class="section" id="how-to-deal-with-errors">
<h2><span class="section-number">13.3. </span>How to Deal with Errors<a class="headerlink" href="#how-to-deal-with-errors" title="Permalink to this headline">¶</a></h2>
<p>Sometimes a website is down or cannot be read for some reason.
In this case the line in the above script that opens or loads the webpage,
<code class="docutils literal notranslate"><span class="pre">html</span> <span class="pre">=</span> <span class="pre">urlopen(df['Links'][i]).read()</span></code>, may result in an empty object so
that <code class="docutils literal notranslate"><span class="pre">html</span></code> would not be defined. The next line in the script above that uses
the <code class="docutils literal notranslate"><span class="pre">html</span></code> object would then break the code and throw an error.</p>
<p>In order to circumvent that we could put the entire code-block into a
<code class="docutils literal notranslate"><span class="pre">try-except</span></code> statement. In this case the Python interpreter will try to load
the content of the website and extract all the info from the website. However,
if the interpreter is not able to load the website then, instead of breaking
the code, it will simply jump into an alternate branch (the <code class="docutils literal notranslate"><span class="pre">Except</span></code> part)
and continue running the commands that are there.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">link_list</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span> <span class="ow">or</span> <span class="n">i</span><span class="o">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">link_list</span><span class="p">)</span><span class="o">-</span><span class="mi">5</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> out of </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">link_list</span><span class="p">)))</span>

    <span class="c1"># Sometimes a website is down or cannot be read for some reason</span>
    <span class="c1"># The</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Open first youtube video link</span>
        <span class="n">html</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Links&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

        <span class="c1"># Assign it to Soup object</span>
        <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="s1">&#39;ignore&#39;</span><span class="p">))</span>

        <span class="c1"># Extract info and store in dataframe</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Title&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Views&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;[^0-9]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> \
          <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;.watch-view-count&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>

        <span class="c1"># Extracting number of likes</span>
        <span class="n">a</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;button&#39;</span><span class="p">,</span> \
          <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;I like this&#39;</span><span class="p">}))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Likes&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d+&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># Extracting number of dislikes</span>
        <span class="n">a</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;button&#39;</span><span class="p">,</span> \
          <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;I dislike this&#39;</span><span class="p">}))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Dislikes&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>  <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d+&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Something is wrong with link </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Probably a server side issue!&#39;</span><span class="p">)</span>
        <span class="c1"># The next line prints the error message</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>0 out of 37
1 out of 37
Something is wrong with link 1
Probably a server side issue!
list index out of range
2 out of 37
3 out of 37
4 out of 37
Something is wrong with link 4
Probably a server side issue!
list index out of range
Something is wrong with link 10
Probably a server side issue!
list index out of range
Something is wrong with link 24
Probably a server side issue!
list index out of range
33 out of 37
Something is wrong with link 33
Probably a server side issue!
list index out of range
34 out of 37
35 out of 37
36 out of 37
</pre></div>
</div>
<p>If you write your code in this way, your program will never break in case you hit a bad
link. It will simply print the exception message and then continue with the next
link from the <code class="docutils literal notranslate"><span class="pre">link_list</span></code>.</p>
<p>We finally sort the data according to number of views, starting with the most
viewed video and print the first couple of entries:</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In Pandas there was a change from <code class="docutils literal notranslate"><span class="pre">df.sort()</span></code> to
<code class="docutils literal notranslate"><span class="pre">df.sort_values()</span></code>. Make sure you use the latter command.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Views&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                                           Links  \
7   https://www.youtube.com//watch?v=OPdbdjctx2I
9   https://www.youtube.com//watch?v=NaY91YjVbEM
8   https://www.youtube.com//watch?v=cLmCJKT5ssw
23  https://www.youtube.com//watch?v=sX8GgDgjq00
11  https://www.youtube.com//watch?v=GYMF5mhuBUE

                                                Title      Views
Likes  \
7   Jimmy and Kevin Hart Ride a Roller Coaster - Y...  106701515
824491
9   Musical Genre Challenge with Ariana Grande - Y...   68500194
1.2407e+06
8   Jack Black Performs His Legendary Sax-A-Boom w...   47298301
1.099e+06
23  Tiniest Puppy Loves To Race Around On His Whee...   37824437
593040
11  Whisper Challenge Veterans Day Reunion Surpris...   34100237
728669

   Dislikes
7     14032
9     21610
8     17020
23    14018
11    10213
</pre></div>
</div>
</div>
<div class="section" id="more-tutorials">
<h2><span class="section-number">13.4. </span>More Tutorials<a class="headerlink" href="#more-tutorials" title="Permalink to this headline">¶</a></h2>
<p>Here are additional web tutorials about Python web scraping that you can check
out:</p>
<blockquote>
<div><ul class="simple">
<li><p>Scraping URLs from the Pycon 2014 Conference by
<a class="reference external" href="http://blog.miguelgrinberg.com/post/easy-web-scraping-with-python">Miguel Grinberg</a></p></li>
<li><p>A <a class="reference external" href="https://www.youtube.com/watch?v=3xQTJi2tqgk">youtube tutorial</a> for web scraping with Python</p></li>
<li><p><a class="reference external" href="http://blog.danwin.com/examples-of-web-scraping-in-python-3-x-for-data-journalists/">Dan Nguyens blog entry for scraping public data</a></p></li>
</ul>
</div></blockquote>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Slides_WebData_2.html" class="btn btn-neutral float-right" title="14. Working with Data from the Web II" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Slides_Data_3.html" class="btn btn-neutral float-left" title="12. Working with Data III: Case Study" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Juergen Jung

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>